<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Challenges | Fluent Graphics</title>
  <meta name="description" content="4 Challenges | Fluent Graphics" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Challenges | Fluent Graphics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Challenges | Fluent Graphics" />
  
  
  

<meta name="author" content="Adam Bartonicek" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="litreview.html"/>
<link rel="next" href="goals.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Abstract</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="litreview.html"><a href="litreview.html"><i class="fa fa-check"></i><b>3</b> Background</a>
<ul>
<li class="chapter" data-level="3.1" data-path="litreview.html"><a href="litreview.html#brief-history"><i class="fa fa-check"></i><b>3.1</b> Brief history of interactive data visualization</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="litreview.html"><a href="litreview.html#static-data-visualization-from-ancient-times-to-the-space-age"><i class="fa fa-check"></i><b>3.1.1</b> Static data visualization: From ancient times to the space age</a></li>
<li class="chapter" data-level="3.1.2" data-path="litreview.html"><a href="litreview.html#early-interactive"><i class="fa fa-check"></i><b>3.1.2</b> Early interactive data visualization: By statisticians for statisticians</a></li>
<li class="chapter" data-level="3.1.3" data-path="litreview.html"><a href="litreview.html#interactive-data-visualization-and-the-internet-web-based-interactivity"><i class="fa fa-check"></i><b>3.1.3</b> Interactive data visualization and the internet: Web-based interactivity</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="litreview.html"><a href="litreview.html#what-is-interactive-visualization"><i class="fa fa-check"></i><b>3.2</b> What even is interactive data visualization?</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="litreview.html"><a href="litreview.html#interactive-interacting"><i class="fa fa-check"></i><b>3.2.1</b> Interactive vs. interacting with</a></li>
<li class="chapter" data-level="3.2.2" data-path="litreview.html"><a href="litreview.html#interactive-enough"><i class="fa fa-check"></i><b>3.2.2</b> Interactive <em>enough</em>?</a></li>
<li class="chapter" data-level="3.2.3" data-path="litreview.html"><a href="litreview.html#complexity-of-interactive-features"><i class="fa fa-check"></i><b>3.2.3</b> Complexity of interactive features</a></li>
<li class="chapter" data-level="3.2.4" data-path="litreview.html"><a href="litreview.html#working-definition"><i class="fa fa-check"></i><b>3.2.4</b> Working definition</a></li>
<li class="chapter" data-level="3.2.5" data-path="litreview.html"><a href="litreview.html#common-features"><i class="fa fa-check"></i><b>3.2.5</b> Common interactive features</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="litreview.html"><a href="litreview.html#general-data-visualization-theory"><i class="fa fa-check"></i><b>3.3</b> General data visualization theory</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="litreview.html"><a href="litreview.html#visualization-goals"><i class="fa fa-check"></i><b>3.3.1</b> Visualization goals</a></li>
<li class="chapter" data-level="3.3.2" data-path="litreview.html"><a href="litreview.html#visual-perception"><i class="fa fa-check"></i><b>3.3.2</b> Visual perception</a></li>
<li class="chapter" data-level="3.3.3" data-path="litreview.html"><a href="litreview.html#scales-measurement"><i class="fa fa-check"></i><b>3.3.3</b> Scales and measurement</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="problems.html"><a href="problems.html"><i class="fa fa-check"></i><b>4</b> Challenges</a>
<ul>
<li class="chapter" data-level="4.1" data-path="problems.html"><a href="problems.html#the-structure-of-this-chapter-data-visualization-pipeline"><i class="fa fa-check"></i><b>4.1</b> The structure of this chapter: Data visualization pipeline</a></li>
<li class="chapter" data-level="4.2" data-path="problems.html"><a href="problems.html#partitioning"><i class="fa fa-check"></i><b>4.2</b> Partitioning</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="problems.html"><a href="problems.html#show-all-data"><i class="fa fa-check"></i><b>4.2.1</b> Showing the full data</a></li>
<li class="chapter" data-level="4.2.2" data-path="problems.html"><a href="problems.html#disjointness-and-comparison"><i class="fa fa-check"></i><b>4.2.2</b> Disjointness and comparison</a></li>
<li class="chapter" data-level="4.2.3" data-path="problems.html"><a href="problems.html#plots-as-partitions"><i class="fa fa-check"></i><b>4.2.3</b> Plots as partitions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="problems.html"><a href="problems.html#aggregation"><i class="fa fa-check"></i><b>4.3</b> Aggregation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="problems.html"><a href="problems.html#the-relationship-between-graphics-and-statistics"><i class="fa fa-check"></i><b>4.3.1</b> The relationship between graphics and statistics</a></li>
<li class="chapter" data-level="4.3.2" data-path="problems.html"><a href="problems.html#stackable-summaries-a-brief-journey-into-category-theory"><i class="fa fa-check"></i><b>4.3.2</b> Stackable summaries: A brief journey into Category Theory</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="problems.html"><a href="problems.html#scaling"><i class="fa fa-check"></i><b>4.4</b> Scaling</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="goals.html"><a href="goals.html"><i class="fa fa-check"></i><b>5</b> Goals</a>
<ul>
<li class="chapter" data-level="5.1" data-path="goals.html"><a href="goals.html#user-profile"><i class="fa fa-check"></i><b>5.1</b> User profile</a></li>
<li class="chapter" data-level="5.2" data-path="goals.html"><a href="goals.html#programming-interface"><i class="fa fa-check"></i><b>5.2</b> Programming interface</a></li>
<li class="chapter" data-level="5.3" data-path="goals.html"><a href="goals.html#user-interface"><i class="fa fa-check"></i><b>5.3</b> User interface</a></li>
<li class="chapter" data-level="5.4" data-path="goals.html"><a href="goals.html#interactive-features"><i class="fa fa-check"></i><b>5.4</b> Interactive features</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="high-level-design.html"><a href="high-level-design.html"><i class="fa fa-check"></i><b>6</b> High-level design</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="high-level-design.html"><a href="high-level-design.html#user-profile-1"><i class="fa fa-check"></i><b>6.0.1</b> User profile</a></li>
<li class="chapter" data-level="6.1" data-path="high-level-design.html"><a href="high-level-design.html#programming-paradigm"><i class="fa fa-check"></i><b>6.1</b> Programming paradigm</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="high-level-design.html"><a href="high-level-design.html#imperative-programming"><i class="fa fa-check"></i><b>6.1.1</b> Imperative programming</a></li>
<li class="chapter" data-level="6.1.2" data-path="high-level-design.html"><a href="high-level-design.html#functional-programming"><i class="fa fa-check"></i><b>6.1.2</b> Functional programming</a></li>
<li class="chapter" data-level="6.1.3" data-path="high-level-design.html"><a href="high-level-design.html#object-oriented-programming"><i class="fa fa-check"></i><b>6.1.3</b> Object oriented programming</a></li>
<li class="chapter" data-level="6.1.4" data-path="high-level-design.html"><a href="high-level-design.html#data-oriented-programming"><i class="fa fa-check"></i><b>6.1.4</b> Data oriented programming</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="high-level-design.html"><a href="high-level-design.html#reactivity"><i class="fa fa-check"></i><b>6.2</b> Reactivity</a></li>
<li class="chapter" data-level="6.3" data-path="high-level-design.html"><a href="high-level-design.html#data-representation"><i class="fa fa-check"></i><b>6.3</b> Data representation</a></li>
<li class="chapter" data-level="6.4" data-path="high-level-design.html"><a href="high-level-design.html#rendering-engine"><i class="fa fa-check"></i><b>6.4</b> Rendering engine</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="system.html"><a href="system.html"><i class="fa fa-check"></i><b>7</b> System description</a>
<ul>
<li class="chapter" data-level="7.1" data-path="system.html"><a href="system.html#core-requirements"><i class="fa fa-check"></i><b>7.1</b> Core requirements</a></li>
<li class="chapter" data-level="7.2" data-path="system.html"><a href="system.html#application-programming-interface-plotscaper"><i class="fa fa-check"></i><b>7.2</b> Application Programming Interface (<code>plotscaper</code>)</a></li>
<li class="chapter" data-level="7.3" data-path="system.html"><a href="system.html#components"><i class="fa fa-check"></i><b>7.3</b> Components</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="system.html"><a href="system.html#Indexable"><i class="fa fa-check"></i><b>7.3.1</b> Indexable</a></li>
<li class="chapter" data-level="7.3.2" data-path="system.html"><a href="system.html#Getter"><i class="fa fa-check"></i><b>7.3.2</b> Getter</a></li>
<li class="chapter" data-level="7.3.3" data-path="system.html"><a href="system.html#dataframe"><i class="fa fa-check"></i><b>7.3.3</b> Dataframe</a></li>
<li class="chapter" data-level="7.3.4" data-path="system.html"><a href="system.html#reactive"><i class="fa fa-check"></i><b>7.3.4</b> Reactive</a></li>
<li class="chapter" data-level="7.3.5" data-path="system.html"><a href="system.html#factors"><i class="fa fa-check"></i><b>7.3.5</b> Factors</a></li>
<li class="chapter" data-level="7.3.6" data-path="system.html"><a href="system.html#reducers"><i class="fa fa-check"></i><b>7.3.6</b> Reducers</a></li>
<li class="chapter" data-level="7.3.7" data-path="system.html"><a href="system.html#scales"><i class="fa fa-check"></i><b>7.3.7</b> Scales</a></li>
<li class="chapter" data-level="7.3.8" data-path="system.html"><a href="system.html#expanses"><i class="fa fa-check"></i><b>7.3.8</b> Expanses</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="applied-example.html"><a href="applied-example.html"><i class="fa fa-check"></i><b>8</b> Applied example</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="applied-example.html"><a href="applied-example.html#about-the-data-set"><i class="fa fa-check"></i><b>8.0.1</b> About the data set</a></li>
<li class="chapter" data-level="8.0.2" data-path="applied-example.html"><a href="applied-example.html#interactive-exploration"><i class="fa fa-check"></i><b>8.0.2</b> Interactive exploration</a></li>
<li class="chapter" data-level="8.1" data-path="applied-example.html"><a href="applied-example.html#summary"><i class="fa fa-check"></i><b>8.1</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>9</b> Discussion</a></li>
<li class="chapter" data-level="10" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i><b>10</b> Glossary</a></li>
<li class="chapter" data-level="11" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>11</b> Appendix</a></li>
<li class="chapter" data-level="12" data-path="mathematical-theory.html"><a href="mathematical-theory.html"><i class="fa fa-check"></i><b>12</b> Mathematical theory</a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="mathematical-theory.html"><a href="mathematical-theory.html#relations"><i class="fa fa-check"></i><b>12.0.1</b> Relations</a></li>
<li class="chapter" data-level="12.0.2" data-path="mathematical-theory.html"><a href="mathematical-theory.html#functions"><i class="fa fa-check"></i><b>12.0.2</b> Functions</a></li>
<li class="chapter" data-level="12.0.3" data-path="mathematical-theory.html"><a href="mathematical-theory.html#partitions"><i class="fa fa-check"></i><b>12.0.3</b> Partitions</a></li>
<li class="chapter" data-level="12.0.4" data-path="mathematical-theory.html"><a href="mathematical-theory.html#preorders"><i class="fa fa-check"></i><b>12.0.4</b> Preorders</a></li>
<li class="chapter" data-level="12.0.5" data-path="mathematical-theory.html"><a href="mathematical-theory.html#monoids"><i class="fa fa-check"></i><b>12.0.5</b> Monoids</a></li>
<li class="chapter" data-level="12.0.6" data-path="mathematical-theory.html"><a href="mathematical-theory.html#groups"><i class="fa fa-check"></i><b>12.0.6</b> Groups</a></li>
<li class="chapter" data-level="12.0.7" data-path="mathematical-theory.html"><a href="mathematical-theory.html#categories"><i class="fa fa-check"></i><b>12.0.7</b> Categories</a></li>
<li class="chapter" data-level="12.0.8" data-path="mathematical-theory.html"><a href="mathematical-theory.html#functors"><i class="fa fa-check"></i><b>12.0.8</b> Functors</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fluent Graphics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="problems" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Challenges<a href="problems.html#problems" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Designing an interactive data visualization system presents a unique set of challenges. Some of these have been already touched on in the Section <a href="litreview.html#litreview">3</a>. This section homes in on these inherent challenges, discusses them in greater depth, and begins exploring avenues for possible solutions.</p>
<div id="the-structure-of-this-chapter-data-visualization-pipeline" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> The structure of this chapter: Data visualization pipeline<a href="problems.html#the-structure-of-this-chapter-data-visualization-pipeline" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When creating visualizations, it is rarely the case that we can plot the raw data directly, as is. Instead, before it can be rendered, the data often has to pass through several distinct transformation stages. Together, these stages form a data visualization pipeline <span class="citation">(see e.g. <a href="#ref-chi2000">Chi 2000</a>; <a href="#ref-wickham2009">Wickham et al. 2009</a>; <a href="#ref-wu2024">Wu and Chang 2024</a>)</span>.</p>
<p>Take, for instance, the typical barplot. There are several steps to drawing a barplot. First, we have to divide the data into parts, based on the levels of some categorical variable. Second, we need to summarize or aggregate each part by some metric, usually either sum or count. Third, we need to take these summaries and map them to visual encodings, such as x-axis position, y-axis position, and length. Finally, we use these encodings to render the individual bars as rectangles on a computer screen <span class="citation">(see e.g. <a href="#ref-franconeri2021">Franconeri et al. 2021</a>)</span>.</p>
<p>These four steps - partitioning, aggregation, encoding, and rendering - are common to all data visualization systems, be they static or interactive. However, interactivity does present some unique challenges, since user interaction may affect any of the four stages. As a result, the changes may need to be propagated throughout the entire pipeline. Finding a general and efficient way to implement this propagation remains an open research topic <span class="citation">(<a href="#ref-wickham2009">Wickham et al. 2009</a>; <a href="#ref-franconeri2021">Franconeri et al. 2021</a>)</span>. Consequently, discussions of interaction within the context of the data visualization pipeline are often fairly vague <span class="citation">(see <a href="#ref-dimara2019">Dimara and Perin 2019</a>; <a href="#ref-wu2024">Wu and Chang 2024</a>)</span>.</p>
<p>In the next few sections, I will try to address this conceptual ambiguity by discussing the four fundamental steps of the data visualization pipeline in depth, and exploring challenges related to their implementation in interactive systems. Ultimately, my goal is to demonstrate that integrating interaction into certain parts of the pipeline, particularly the aggregation step, is more complex than commonly acknowledged. Further, if the goal is to build truly generic and robust interactive data visualization systems, this complexity must be addressed <span class="citation">(see also <a href="#ref-wu2024">Wu and Chang 2024</a>)</span>.</p>
</div>
<div id="partitioning" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Partitioning<a href="problems.html#partitioning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first step of any data visualization pipeline is to divide the data into parts or subsets. The reason for this initial step lies in our ultimate goal: to draw one or (usually) more geometric objects, representing some aspects of our data. Before we can do that, we need to define the set of data points each object represents. For typical, two-dimensional tables or data frames, this amounts to slicing the table’s rows into smaller sub-tables.</p>
<p>This partitioning operation fairly intuitive for aggregate plots (e.g. typical barplots and histograms), where each object represents multiple rows of the data. However, even one-to-one representations of the data (e.g. scatter plots and parallel coordinate plots), can be viewed this way, specifically, as slicing the table of <span class="math inline">\(n\)</span> rows into <span class="math inline">\(n\)</span> smaller tables of one row each. Similarly, plots with a single geometric object (e.g., a radar plot) can be considered as taking the entire data set as the one and only subset.</p>
<p>Thus, the process of splitting our data into subsets may appear straightforward. However, it does raise two fundamental questions:</p>
<ul>
<li>How much of the original data should the subsets contain?</li>
<li>What should be the relationship between the subsets?</li>
</ul>
<p>While common data visualization practices provide implicit solutions to these questions, in the data visualization literature, explicit answers are rarely given. This is unfortunate because choosing how to partition our data is a highly consequential decision: it involves making assumptions about both the data itself and the visualization’s goals. Especially in interactive data visualization, the relationships between the parts of our data become of crucial importance. Therefore, discussing these two questions is essential.</p>
<div id="show-all-data" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Showing the full data<a href="problems.html#show-all-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>“If someone hides data from you, it’s probably because he has something to hide.” <span class="citation">(<a href="#ref-cairo2016">Cairo 2016, 47</a>)</span></p>
</blockquote>
<p>A common recommendation that many data visualization experts provide is that faithful visual representations should show the full data and leave nothing out. The moral behind this recommendation is fairly intuitive. A visualization which hides or obscures information, be it by intent or negligence, cannot be considered a truthful representation of the underlying information <span class="citation">(<a href="#ref-cairo2016">Cairo 2016</a>, <a href="#ref-cairo2019">2019</a>)</span>.</p>
<p>However, data hiding can occur in many different ways. First, the data itself can be cherry-picked or massaged <span class="citation">(see e.g. <a href="#ref-lisnic2024">Lisnic et al. 2024</a>)</span>. This is arguably the most egregious case, and can in some cases amount to malicious statistical practices such as HARKing or p-hacking <span class="citation">(see e.g. <a href="#ref-kerr1998">Kerr 1998</a>; <a href="#ref-lisnic2024">Lisnic et al. 2024</a>; <a href="#ref-head2015">Head et al. 2015</a>)</span>. However, even when showing the full data, some visualizations can obscure or downplay certain data features via poor design or incorrect use of visual encodings <span class="citation">(<a href="#ref-cairo2016">Cairo 2016</a>, <a href="#ref-cairo2019">2019</a>; <a href="#ref-cleveland1985">Cleveland 1985</a>; <a href="#ref-ziemkiewicz2009">Ziemkiewicz and Kosara 2009</a>)</span>. Finally, there is the issue of missing or incomplete data, where some data cannot be easily represented because it is simply not there.</p>
<p>An infamous example of data hiding leading to disastrous real-world consequences was the 1986 crash of the Space Shuttle Challenger <span class="citation">(see <a href="#ref-dalal1989">Dalal, Fowlkes, and Hoadley 1989</a>)</span>. During a pre-launch teleconference, engineers debated the effect of temperature on the performance of O-ring gaskets, as the forecasted temperature was significantly lower than during previous launches. Plot in the left panel of Figure <a href="problems.html#fig:challenger">4.1</a> was used to argue that there was no correlation between temperature and O-ring failures. However, this plot had one significant flaw: it excluded launches where no failures occurred. After the disaster, when the data including the zero-failure launches was plotted, it revealed a clear trend of increasing number of failures as temperature decreased <span class="citation">(see right panel of Figure <a href="problems.html#fig:challenger">4.1</a>, see also <a href="#ref-dalal1989">Dalal, Fowlkes, and Hoadley 1989</a>)</span>.</p>
<div class="figure"><span style="display:block;" id="fig:challenger"></span>
<img src="figures/challenger.png" alt="Relationship between temperature and the number of O-ring failures within the 1986 Challenger data. Left: the original plot as presented during the pre-launch teleconference. Right: a reproduced plot of the same data, including the original data points (black), the excluded data points with zero failures (grey), and an estimated logistic regression fit (red). The source of right-panel data is @dalal1989." width="750" />
<p class="caption">
Figure 4.1: Relationship between temperature and the number of O-ring failures within the 1986 Challenger data. Left: the original plot as presented during the pre-launch teleconference. Right: a reproduced plot of the same data, including the original data points (black), the excluded data points with zero failures (grey), and an estimated logistic regression fit (red). The source of right-panel data is <span class="citation">Dalal, Fowlkes, and Hoadley (<a href="#ref-dalal1989">1989</a>)</span>.
</p>
</div>
<p>However, data hiding can also occur in more subtle ways, such as the above-mentioned poor design choices. Consider, for example, axis limits. <span class="citation">Cleveland (<a href="#ref-cleveland1985">1985</a>)</span> argues that axis limits should generally be expanded to avoid inadvertently obscuring data near these limits <span class="citation">(see also e.g. <a href="#ref-chen2008">Chen, Härdle, and Unwin 2008, 64</a>)</span>. Take the following two scatterplots:</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="figures/expand-scatterplot.png" alt="Without expanding axis limits, objects at or near the limits become less salient. Left: axis limits match the data limits exactly, and so the points in the top-left and bottom-right corner of the plot are represented by smaller area and the overall trend is distorted. Right: by expanding axis limits, we can ensure that trend is represented faithfully." width="750" />
<p class="caption">
Figure 4.2: Without expanding axis limits, objects at or near the limits become less salient. Left: axis limits match the data limits exactly, and so the points in the top-left and bottom-right corner of the plot are represented by smaller area and the overall trend is distorted. Right: by expanding axis limits, we can ensure that trend is represented faithfully.
</p>
</div>
<p>In the left scatterplot, the axis limits match the data limits exactly, whereas in the right plot, they are expanded by a small fraction <span class="citation">(5%, <code>ggplot2</code> default, <a href="#ref-wickham2016">Wickham 2016</a>)</span>. The left scatterplot provides a misleading representation of the underlying trend, as data points near or at the axis limits (top-left and bottom-right corners) are represented by a smaller area, compared to points near the centre of the plot. For instance, the point in the bottom-right corner of the plot lies simultaneously at the limits of the x- and y-axis, and is thus represented by one-quarter of the area of the points in the center.</p>
<p>Finally, there is the issue of data hiding due to missing or incomplete data, which is a bit more complicated. While techniques of visualizing data with missing values do exist <span class="citation">(see e.g. <a href="#ref-unwin1996">Unwin et al. 1996</a>; <a href="#ref-tierney2023">Tierney and Cook 2023</a>)</span>, they are often tied to specific visualization types and styles, and few general solutions are available. Properly analyzing the patterns of missingness in the data often calls for a full-fledged separate visualization workflow <span class="citation">(<a href="#ref-tierney2023">Tierney and Cook 2023</a>)</span>.</p>
<p>Either way, data hiding is something we should be mindful of. Unless there is a clear and justifiable reason, no data should be arbitrarily removed or discarded, and we should pick good visual representations to represent all of our data faithfully. In the ideal case, the visualization should present a clear and unambiguous mapping between the graphics and the data <span class="citation">(<a href="#ref-ziemkiewicz2009">Ziemkiewicz and Kosara 2009</a>)</span>.</p>
</div>
<div id="disjointness-and-comparison" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Disjointness and comparison<a href="problems.html#disjointness-and-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>“To be truthful and revealing, data graphics must bear on the question at the heart of quantitative thinking: ‘compared to what’?” <span class="citation">(<a href="#ref-tufte2001">Tufte 2001, 74</a>)</span>.</p>
</blockquote>
<blockquote>
<p>“Graphics are for comparison - comparison of one kind or another - not for access to individual amounts.” <span class="citation">(<a href="#ref-tukey1993">Tukey 1993</a>)</span></p>
</blockquote>
<p>An interesting yet underappreciated fact is that in many common visualization types, geometric objects tend to represent disjoint subsets of the data. That is, in most plots, each point, bar, line, or polygon represents a unique set of data points (rows of the data), with no overlap with other objects within the same graphical layer. This practice, despite being so common to border on a rule, is rarely given much attention.</p>
<p>There are of course counter-examples. For instance, certain visualizations of set-typed data “double up” the contribution of data subsets, such that the same subset of the data may appear in multiple objects <span class="citation">(see e.g. <a href="#ref-alsallakh2013">Alsallakh et al. 2013</a>, <a href="#ref-alsallakh2014">2014</a>; <a href="#ref-conway2017">Conway, Lex, and Gehlenborg 2017</a>; <a href="#ref-lex2014">Lex et al. 2014</a>)</span>. However, these types of visualizations are fairly rare, and represent the exception rather than the norm. When we see a barplot, we typically expect each bar to represent a unique set of cases.</p>
<p>But where does this unconscious “law” of showing disjoint parts of the data come from? I argue that it stems from the fundamental purpose of data visualization: comparison <span class="citation">(<a href="#ref-tufte2001">Tufte 2001</a>; <a href="#ref-tukey1993">Tukey 1993</a>)</span>. When we visualize, we draw our graphics with the ultimate goal of comparing our data along a set of visual channels <span class="citation">(<a href="#ref-bertin1983">Bertin 1983</a>; <a href="#ref-wilkinson2012">Wilkinson 2012</a>; <a href="#ref-franconeri2021">Franconeri et al. 2021</a>; <a href="#ref-wilke2019">Wilke 2019</a>)</span>. This mirrors the comparisons we make about objects and events in the real world. And, in general, it is far easier to reason about objects and events which are independent, rather than ones which overlap or blend together. One example of this comes from basic probability theory, where the sum and product rules have independence as a pre-requisite <span class="citation">(<a href="#ref-kolmogorov2018">Kolmogorov and Bharucha-Reid 2018</a>)</span>. Similarly, psychological research, such as the well-known “Linda experiment” <span class="citation">(<a href="#ref-tversky1983">Tversky and Kahneman 1983</a>)</span>, shows that people struggle with comparing the probability of non-disjoint events. Thus it seems that, in many ways, disjointness presents a more intuitive, “natural” model.</p>
<p>More fundamentally, disjointness may be more intuitive because it reflects a structure which mathematicians have long considered natural: a <a href="mathematical-theory.html#functions">bijection</a> <span class="citation">(see e.g. <a href="#ref-fong2019">Fong and Spivak 2019</a>; <a href="#ref-lawvere2009">Lawvere and Schanuel 2009</a>)</span>. Specifically, if we take a set, split it into disjoint subsets, and label each subset, then there is a one-to-one correspondence between these subsets and the subset labels (i.e. the parts form an <a href="#partition">equivalence class</a>). Practically, this means that we can go back and forth between the subsets and the corresponding labels, without losing any information.</p>
<p>The fact that disjoint subsets form a bijection may be particularly useful in data visualization and this may explain its ubiquity, see Figure <a href="problems.html#fig:geoms-bijection">4.3</a>. For instance, when drawing a barplot, if we divide our data into disjoint subsets and draw one bar corresponding to each part, then we can go back and forth between identifying subsets of the data corresponding to individual bars and vice versa. Thus, the function of identifying data subsets is invertible. In plots where the objects do not represent disjoint subsets, this correspondence is broken: if we select a subset of cases corresponding to a bar, there may be no simple way to identify the original bar from the cases alone. This issue applies both conceptually, when viewing static visualizations, and also more practically, when interacting with interactive visualizations, via features such as linked selection.</p>
<div class="figure"><span style="display:block;" id="fig:geoms-bijection"></span>
<img src="figures/geoms-bijection.png" alt="Disjointness induces a one-to-one mapping (bijection) between geometric objects and subsets of the data. Suppose we mark out the cases corresponding to the leftmost bar (red). Top row: when each geometric object (bar) represents unique subset of data points, we can easily go back and forth between the object and its underlying subset (middle panel), and so the function of picking cases corresponding to each object is invertible. Bottom row: if there is an overlap between the cases represented by each object, then there may be no way to identify the original object after we have picked out the corresponding cases." width="886" />
<p class="caption">
Figure 4.3: Disjointness induces a one-to-one mapping (bijection) between geometric objects and subsets of the data. Suppose we mark out the cases corresponding to the leftmost bar (red). Top row: when each geometric object (bar) represents unique subset of data points, we can easily go back and forth between the object and its underlying subset (middle panel), and so the function of picking cases corresponding to each object is invertible. Bottom row: if there is an overlap between the cases represented by each object, then there may be no way to identify the original object after we have picked out the corresponding cases.
</p>
</div>
<div id="real-world-example" class="section level4 hasAnchor" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> Real-world example<a href="problems.html#real-world-example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To illustrate the idea of disjoint subsets on concrete, real-world example, take the following barplot representing the vote share among the top three parties in the 2023 New Zealand general election <span class="citation">(<a href="#ref-election2023">Electoral Commission New Zealand 2023</a>)</span>:</p>
<div class="figure"><span style="display:block;" id="fig:barplot-bijection"></span>
<img src="figures/barplot-bijection.png" alt="Barplot showing disjoint subsets of the data. The bars show the vote share among the top three parties in the 2023 New Zealand general election, with each bar representing a unique subset of voters." width="750" />
<p class="caption">
Figure 4.4: Barplot showing disjoint subsets of the data. The bars show the vote share among the top three parties in the 2023 New Zealand general election, with each bar representing a unique subset of voters.
</p>
</div>
<p>Each bar represents a unique subset of voters and thus the bars show disjoint data. This is the type of data representation that we encounter most often, however, there are few explicit guidelines about this. Hypothetically, we could transform our data, and use the leftmost bar to show, for example, the union of the votes of National and Labour parties:</p>
<div class="figure"><span style="display:block;" id="fig:union-geoms"></span>
<img src="figures/barplot-notbijection.png" alt="Barplot showing non-disjoint subsets of the data. Most of the bars show the same data as in Figure \@ref(fig:geoms-bijection), however, the leftmost bar representing a union of National and Labour voters. The two leftmost bars are thus not disjoint. For a more realistic example, see Figure \@ref(fig:union-geoms2)." width="750" />
<p class="caption">
Figure 4.5: Barplot showing non-disjoint subsets of the data. Most of the bars show the same data as in Figure <a href="problems.html#fig:geoms-bijection">4.3</a>, however, the leftmost bar representing a union of National and Labour voters. The two leftmost bars are thus not disjoint. For a more realistic example, see Figure <a href="problems.html#fig:union-geoms2">4.7</a>.
</p>
</div>
<p>However, this way of representing the data has several problems. First, this type of visualization is arguably not very useful for addressing our visualization goals. For example, when visualizing election data such as the one above, we typically want to compare the relative number of votes each party received. Figure <a href="problems.html#fig:union-geoms">4.5</a> this comparison needlessly difficult. Specifically, since the leftmost bar represents the union of National and Labour votes, we have to perform additional mental calculation if we want to compare the number of votes received by National and Labour directly <span class="citation">(<a href="#ref-cleveland1985">Cleveland 1985</a>)</span>. Second, we have metadata knowledge <span class="citation">(see e.g. <a href="#ref-wilkinson2012">Wilkinson 2012</a>; <a href="#ref-velleman1993">Velleman and Wilkinson 1993</a>)</span> about the data actually being disjoint. We know that, in the New Zealand parliament electoral system, each voter can only vote for a single party. Hence, it does not make sense to arbitrarily combine the data in this way. Finally, Figure <a href="problems.html#fig:union-geoms">4.5</a> also needlessly duplicates information: the number of votes the National party received is counted twice, once in the leftmost bar and again in the second-from-left bar. This goes against the general principle of representing our data parsimoniously <span class="citation">(<a href="#ref-tufte2001">Tufte 2001</a>)</span>.</p>
<p>Even when our goal is not to compare absolute counts, there are usually better disjoint data visualization methods available. For instance, if we were interested in visualizing the <em>proportion</em> of votes that each party received, we could instead draw the following plot:</p>
<div class="figure"><span style="display:block;" id="fig:stacked-proportion"></span>
<img src="figures/barplot-bijection-proportions.png" alt="Even when proportions are of interest, there are usually disjoint data visualization techniques available. The plot shows proportion of vote share of the top three parties in the 2023 New Zealand general election, with each bar segment again representing a unique subset of voters." width="750" />
<p class="caption">
Figure 4.6: Even when proportions are of interest, there are usually disjoint data visualization techniques available. The plot shows proportion of vote share of the top three parties in the 2023 New Zealand general election, with each bar segment again representing a unique subset of voters.
</p>
</div>
<p>By stacking the bar segments on top of each other as in <a href="problems.html#fig:stacked-proportion">4.6</a>, we can easily compare proportion of the total number of votes each party received, while retaining a disjoint representation. Each bar segment now again represents a unique subset of voters.</p>
<p>The example above is fairly clear-cut case of where disjoint data representation is the better choice. However, there are also more ambiguous situations, such as when multiple attributes of the data are simultaneously present or absent for each case. Take, for example, the 2020 New Zealand joint referendum on the legalization of euthanasia and cannabis. In this referendum, the two issues were included on the same ballot and voters would vote on them simultaneously. The legalization of euthanasia was accepted by the voters, with 65.1% of votes supporting the decision, whereas the legalization of cannabis was rejected, with 50.7% of voters rejecting the decision <span class="citation">(<a href="#ref-referendum2020">Electoral Commission New Zealand 2020</a>)</span>.</p>
<p>We could visualize the referendum data in the following way:</p>
<div class="figure"><span style="display:block;" id="fig:union-geoms2"></span>
<img src="figures/referendum-notbijection.png" alt="Barplot showing a more realistic example of non-disjoint data representation. The bars show the vote share cast by New Zealand voters in the joint 2020 referendum on euthanasia and cannabis. The two bars show (mostly) the same set of ballots, with each single ballot contributing to the height of one segment in each bar." width="750" />
<p class="caption">
Figure 4.7: Barplot showing a more realistic example of non-disjoint data representation. The bars show the vote share cast by New Zealand voters in the joint 2020 referendum on euthanasia and cannabis. The two bars show (mostly) the same set of ballots, with each single ballot contributing to the height of one segment in each bar.
</p>
</div>
<p>In Figure <a href="problems.html#fig:union-geoms2">4.7</a>, both bars include votes cast by the same voter <span class="citation">(ignoring the votes where no preference was given for either issue, <a href="#ref-referendum2020">Electoral Commission New Zealand 2020</a>)</span>, making the representation non-disjoint. In
this case, the visualization works, since the underlying data is genuinely non-independent (each person cast two votes). If we had information about individual votes, it might be interesting to see how many people voted for both euthanasia and cannabis, how many voted for euthanasia but against cannabis, and so on. As was mentioned before, these types of visualizations can be useful for set-typed data <span class="citation">(see e.g. <a href="#ref-alsallakh2014">Alsallakh et al. 2014</a>)</span>.</p>
<p>However, even though the data here is fundamentally non-independent, there is often a way to represent it in a disjoint way that preserves most of the desirable properties. Specifically, we can split the data and draw it as separate plots or small multiples <span class="citation">(<a href="#ref-tufte2001">Tufte 2001</a>)</span>:</p>
<div class="figure"><span style="display:block;" id="fig:small-multiples"></span>
<img src="figures/referendum-bijection.png" alt="Small multiple figure showing the non-disjoint data represented as disjoint bars. The bars again show the vote share cast by New Zealand voters in the joint 2020 referendum on euthanasia and cannabis, however, this time, each bar within one plot represents a unique subset of the cases." width="750" />
<p class="caption">
Figure 4.8: Small multiple figure showing the non-disjoint data represented as disjoint bars. The bars again show the vote share cast by New Zealand voters in the joint 2020 referendum on euthanasia and cannabis, however, this time, each bar within one plot represents a unique subset of the cases.
</p>
</div>
<p>Here again, in Figure <a href="problems.html#fig:small-multiples">4.8</a>, each bar (segment) in each plot represents a disjoint subset of voters.</p>
</div>
<div id="disjointness-and-interaction" class="section level4 hasAnchor" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Disjointness and interaction<a href="problems.html#disjointness-and-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As I argued above, disjoint subsets offer a simpler mental model for understanding data visualizations. When each geometric object represents a unique set of data points, it becomes easier to reason about the comparisons being made. Conversely, when objects overlap or share underlying data points, additional cognitive effort is required to track the relationships between them.</p>
<p>Further, I argue that disjointness presents a particularly good model for interactive visualization <span class="citation">(see also <a href="#ref-wilhelm2008">Wilhelm 2008</a>)</span>. The natural correspondence between geometric objects and subsets of the data makes certain interactions more intuitive, and conversely, overlapping subsets can produce unexpected or unintuitive behavior. For instance, when a user clicks on a bar in a linked barplot, they might reasonably expect to highlight <em>that particular bar</em>, within the active plot, and the corresponding cases within all the other (passive) plots. If they see parts of other bars within the active plot get highlighted as well, they have to spend additional mental effort thinking about the relation between the objects (bars) and the subsets of the data, since this is no longer one-to-one.</p>
<p>Similar issue arises during querying. When a user queries an object that does not represent a disjoint subset of the data, should the returned summary statistics match the object or the (non-disjoint) subset? And how do we signal this to the user? Again, lack of disjointness introduces subtle ambiguities and complicates the interpretation of the presented information.</p>
<p>This does not mean that non-disjoint subsets cannot be usefuly combined with interaction, in specific contexts <span class="citation">(see e.g. <a href="#ref-alsallakh2014">Alsallakh et al. 2014</a>; <a href="#ref-wilhelm2008">Wilhelm 2008</a>)</span>. However, I argue that, as a general model, disjointness provides a very good default. Disjoint subsets simplify our mental model, and this may be the reason why some authors discuss interactive features in the context of partitions, which are by definition disjoint <span class="citation">(see e.g. <a href="#ref-buja1996">Buja, Cook, and Swayne 1996</a>; <a href="#ref-keim2002">Keim 2002</a>)</span>. Likewise, many common data analytic operations, such as SQL aggregation queries <span class="citation">(<code>GROUP BY</code>, <a href="#ref-hellerstein1999">Hellerstein et al. 1999</a>)</span>, operate on disjoint subsets, and this may be another reason why this model is familiar.</p>
</div>
</div>
<div id="plots-as-partitions" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Plots as partitions<a href="problems.html#plots-as-partitions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the two preceding sections, I have argued that it is generally desirable for plots in our (interactive) data visualization system to have two fundamental features:</p>
<ul>
<li>Completeness: They should show the full data</li>
<li>Distinctness: Geometric objects should represent distinct subsets of data points</li>
</ul>
<p>These two features actually map onto two fundamental mathematical properties: <a href="#Functions">surjectivity</a> and <a href="#Partitions">disjointness</a>. In turn, these two properties define a well-known mathematical structure: a <a href="#Partitions">partition</a>. Therefore, partitions offer a compelling model for structuring our plots. I propose the following definition of a <em>regular plot</em>:</p>
<div class="definition">
<p><span id="def:unlabeled-div-1" class="definition"><strong>Definition 4.1  (Regular plot) </strong></span>Regular plot is a plot where the geometric objects within one layer represent a partition of the data, such that there is a bijection between these objects and (possibly aggregated) subsets of the original data.</p>
</div>
<p>Note that this definition still allows for plots where geometric objects in different layers represent overlapping data subsets, such as boxplots with overlaid points, or scatterplots with a smooth fit.</p>
<p>I propose regular plots as a fundamental building block of our interactive data visualization system. By building our interactive figures out of regular plots <span class="citation">(as small multiples, <a href="#ref-tufte2001">Tufte 2001</a>)</span>, we can ensure that the resulting visualization will be easily interpretable, even when combined with interactive features such as linking and querying.</p>
<div id="bijection-on-cases-vs.-bijection-on-subsets" class="section level4 hasAnchor" number="4.2.3.1">
<h4><span class="header-section-number">4.2.3.1</span> Bijection on cases vs. bijection on subsets<a href="problems.html#bijection-on-cases-vs.-bijection-on-subsets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Although I have not been able to find references conceptualizing plots as partitions in the same general way as I do here, some data visualization researchers have used the language of bijections when discussing graphics. For example, <span class="citation">Dastani (<a href="#ref-dastani2002">2002</a>)</span> discusses plots as bijections (homomorphisms) between data tables and visual attribute tables. Similarly, <span class="citation">Ziemkiewicz and Kosara (<a href="#ref-ziemkiewicz2009">2009</a>)</span>, and <span class="citation">Vickers, Faith, and Rossiter (<a href="#ref-vickers2012">2012</a>)</span> argue that, in order to be visually unambiguous, plots should represent bijections of the underlying data. Essentially, these researchers argue that plots should represent bijective mappings of the data tables, such that each object represents one row of the data.</p>
<p>However, this “one-row-one-object” model sidesteps the issue of aggregation (see also Section <a href="problems.html#aggregation">4.3</a>). It operates on the assumption that the data is pre-aggregated, such that, for instance, when we draw a barplot or a histogram, we start with a table that has one row per bar. This is rarely the case in practice. Most visualization systems incorporate aggregation as an explicit component of the data visualization pipeline <span class="citation">(see e.g. <a href="#ref-chi2000">Chi 2000</a>; <a href="#ref-wickham2016">Wickham 2016</a>; <a href="#ref-satyanarayan2015">Satyanarayan et al. 2015</a>, <a href="#ref-satyanarayan2016">2016</a>; <a href="#ref-wu2024">Wu and Chang 2024</a>)</span>. Howeever, acknowledging aggregation presents a problem for the one-row-one-object model, since aggregation is, by definition, not injective. Once we aggregate multiple data points into a summary or a set of summaries, we cannot recover the original cases <span class="citation">(see also <a href="#ref-wu2024">Wu and Chang 2024</a>)</span>. Thus, the model proposed by authors such as <span class="citation">Dastani (<a href="#ref-dastani2002">2002</a>)</span>, <span class="citation">Ziemkiewicz and Kosara (<a href="#ref-ziemkiewicz2009">2009</a>)</span>, and <span class="citation">Vickers, Faith, and Rossiter (<a href="#ref-vickers2012">2012</a>)</span> would exclude many common aggregation-based types of plots, such as barplots and histograms. <span class="citation">Ziemkiewicz and Kosara (<a href="#ref-ziemkiewicz2009">2009</a>)</span> indeed do acknowledge that this is a problem, and admit that, at times, aggregation can be an acceptable trade-off, despite the inherent information loss.</p>
<p>However, if we instead model plots as bijection between <em>parts of data</em> and the geometric objects, rather than between individual <em>data points</em> and geometric objects, aggregation ceases to be a problem. Even after we aggregate a multiple-row subset of the data into a single row summary, this bijection is preserved. Thus, aggregation can be considered a part of the bijection. For instance, if we split our data into ten tables and aggregate each table, we are still left with ten tables of one row each that we can map bijectively to geometric objects.</p>
</div>
<div id="products-of-partitions" class="section level4 hasAnchor" number="4.2.3.2">
<h4><span class="header-section-number">4.2.3.2</span> Products of partitions<a href="problems.html#products-of-partitions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Many types of plots involve data that is partitioned or split across multiple dimensions. This is especially true in interactive data visualization, where features such as linking automatically induce another level of partitioning <span class="citation">(<a href="#ref-wilhelm2008">Wilhelm 2008</a>)</span>. This necessitates a general mechanism for combining partitions to form their product.</p>
<p>To give a concrete example, suppose we want to draw the following barplot:</p>
<p><img src="figures/barplot-partitions-products.png" width="750" /></p>
<p>We start with the following data, which includes a categorical variable (<code>group</code>, plotted along the x-axis), a variable representing selection status (<code>selection</code>, used to colour the bar segments), and a continuous variable that we want to summarize (<code>value</code>):</p>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
13
</td>
</tr>
</tbody>
</table>
<p>To draw individual bar segments, we need to sum <code>value</code> across the subsets cases corresponding to each segment. To do this, we first need to split our data into multiple subsets corresponding to the partition formed by taking the product of <code>group</code> and <code>selection</code> variables.</p>
<p>In R, the general data structure for representing partitions is the <code>factor</code> S3 class. In a <code>factor</code>, all elements of a vector are assigned a label, such that each label represent one disjoint part of the data. Unfortunately, there is no built-in function for creating a Cartesian product of two factors. However, we can easily emulate it using <code>paste</code> function to combine factor levels as strings element-wise:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="problems.html#cb1-1" tabindex="-1"></a>product_factor <span class="ot">&lt;-</span> <span class="fu">paste</span>(df<span class="sc">$</span>group, df<span class="sc">$</span>selection)</span>
<span id="cb1-2"><a href="problems.html#cb1-2" tabindex="-1"></a>split_dfs <span class="ot">&lt;-</span> <span class="fu">split</span>(df, product_factor)</span>
<span id="cb1-3"><a href="problems.html#cb1-3" tabindex="-1"></a><span class="fu">render_tables</span>(split_dfs)</span></code></pre></div>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
21
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
9
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
15
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
15
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
13
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>We can then summarize each small data set by summing <code>value</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="problems.html#cb2-1" tabindex="-1"></a>summarized_dfs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_dfs, <span class="cf">function</span>(x) {</span>
<span id="cb2-2"><a href="problems.html#cb2-2" tabindex="-1"></a>  <span class="fu">aggregate</span>(value <span class="sc">~</span> ., <span class="at">data =</span> x, sum)</span>
<span id="cb2-3"><a href="problems.html#cb2-3" tabindex="-1"></a>})</span>
<span id="cb2-4"><a href="problems.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="problems.html#cb2-5" tabindex="-1"></a><span class="fu">render_tables</span>(summarized_dfs)</span></code></pre></div>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
33
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
9
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
15
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
15
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
25
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Finally, to “stack” the segments on top of each other, we need to combine the summaries back together, within the levels of <code>group</code> variable. We can do this by grouping the data sets by the <code>group</code> variable and taking their cumulative sum:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="problems.html#cb3-1" tabindex="-1"></a>grouped_dfs <span class="ot">&lt;-</span> <span class="fu">split</span>(summarized_dfs, <span class="fu">sapply</span>(summarized_dfs, <span class="cf">function</span>(x) x<span class="sc">$</span>group))</span>
<span id="cb3-2"><a href="problems.html#cb3-2" tabindex="-1"></a>stacked_dfs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(grouped_dfs, <span class="cf">function</span>(x) {</span>
<span id="cb3-3"><a href="problems.html#cb3-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, x)</span>
<span id="cb3-4"><a href="problems.html#cb3-4" tabindex="-1"></a>  x<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(x<span class="sc">$</span>value)</span>
<span id="cb3-5"><a href="problems.html#cb3-5" tabindex="-1"></a>  <span class="fu">rownames</span>(x) <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Remove rownames for nicer formatting</span></span>
<span id="cb3-6"><a href="problems.html#cb3-6" tabindex="-1"></a>  x</span>
<span id="cb3-7"><a href="problems.html#cb3-7" tabindex="-1"></a>})</span>
<span id="cb3-8"><a href="problems.html#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="problems.html#cb3-9" tabindex="-1"></a><span class="fu">render_tables</span>(stacked_dfs)</span></code></pre></div>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
33
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
43
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
24
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
group
</th>
<th style="text-align:left;">
selection
</th>
<th style="text-align:right;">
value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
40
</td>
</tr>
</tbody>
</table>
<p>Now, we can combine these tables into one <code>data.frame</code> and render:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="problems.html#cb4-1" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, stacked_dfs)</span>
<span id="cb4-2"><a href="problems.html#cb4-2" tabindex="-1"></a><span class="co"># Need to reverse factor and row order for ggplot2 to layer segments correctly</span></span>
<span id="cb4-3"><a href="problems.html#cb4-3" tabindex="-1"></a>combined_df<span class="sc">$</span>selection <span class="ot">&lt;-</span> <span class="fu">factor</span>(combined_df<span class="sc">$</span>selection, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb4-4"><a href="problems.html#cb4-4" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> combined_df[<span class="dv">6</span><span class="sc">:</span><span class="dv">1</span>, ] </span>
<span id="cb4-5"><a href="problems.html#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="problems.html#cb4-6" tabindex="-1"></a><span class="fu">ggplot</span>(combined_df, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value, <span class="at">fill =</span> selection)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="problems.html#cb4-7" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_identity</span>())</span></code></pre></div>
<p><img src="figures/barplot-partitions-products.png" width="750" /></p>
<p>What we have just shown is an example of a simple split-apply-combine pipeline <span class="citation">(<a href="#ref-wickham2011">Wickham 2011</a>)</span>. This type of a pipeline is necessary in most types of plots and data visualization systems. For instance, the following <code>ggplot2</code> call produces a similar data visualization pipeline like the one we described above:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="problems.html#cb5-1" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(x, y, <span class="at">fill =</span> fill)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="problems.html#cb5-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;sum&quot;</span>)</span></code></pre></div>
<p>To be more explicit, in the <code>ggplot2</code> call above, we specify that we want to partition the data set by the Cartesian product of the <code>x</code>, <code>y</code>, and <code>fill</code> variables. See the following comment from the <a href="https://github.com/tidyverse/ggplot2/blob/f46805349d6ca8ca7a99f8966cfa0f29279c2f6c/R/grouping.R#L7"><code>ggplot2</code> documentation</a> <span class="citation">(<a href="#ref-wickham2016">Wickham 2016</a>)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="problems.html#cb6-1" tabindex="-1"></a><span class="co"># If the `group` variable is not present, then a new group</span></span>
<span id="cb6-2"><a href="problems.html#cb6-2" tabindex="-1"></a><span class="co"># variable is generated from the interaction of all discrete (factor or</span></span>
<span id="cb6-3"><a href="problems.html#cb6-3" tabindex="-1"></a><span class="co"># character) vectors, excluding `label`.</span></span></code></pre></div>
<p>We then compute whatever summary we want (<code>sum</code>). Finally, when a <code>fill</code> or <code>col</code> aesthetic is used with <code>geom_bar</code>, <code>ggplot2</code> also automatically stack the bars on top of each other by summing their heights. Similar strategy is employed for many other types of stacked plots, including pie charts, histograms, or density plots <span class="citation">(<a href="#ref-wickham2016">Wickham 2016</a>)</span>.</p>
</div>
<div id="limits-of-flat-product-partitions" class="section level4 hasAnchor" number="4.2.3.3">
<h4><span class="header-section-number">4.2.3.3</span> Limits of flat product partitions<a href="problems.html#limits-of-flat-product-partitions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For many common plot types, a single “flat” product of all factors/partitions works reasonably well. However, for other types of plots, this simple model is not enough. Specifically, certain types of plots exhibit hierarchical relationships between the partitions which cannot be represented under this flat model <span class="citation">(see also <a href="#ref-slingsby2009">Slingsby, Dykes, and Wood 2009</a>; <a href="#ref-wu2022">Wu 2022</a>)</span>.</p>
<p>To give a concrete example, let’s turn back to the barplot from the section above (<a href="problems.html#plots-as-partitions">4.2.3</a>). To draw the barplot, we first split our data into smaller tables, summarized each table by summing the values, stacked the summaries by taking their cumulative sum, and finally used the resulting data frame to render bar segments. This gave us a stacked barplot, which is a good visualization for comparing absolute counts across categories.</p>
<p>However, what if, instead of comparing absolute counts, we wanted to compare proportions? It turns out there is another type of visualization, called the spineplot, which can be used to represent the same underlying data as a barplot, however, is much better suited for comparing proportions:</p>
<div class="figure"><span style="display:block;" id="fig:barplot-spineplot"></span>
<img src="figures/barplot-spineplot.png" alt="The same underlying data represented as a barplot (left) and a spineplot (right)." width="750" />
<p class="caption">
Figure 4.9: The same underlying data represented as a barplot (left) and a spineplot (right).
</p>
</div>
<p>Like barplots, spineplots represent some summary statistic (usually counts), aggregated within the levels of a product of two categorical variables. However, unlike barplots, spineplots map the underlying statistics to both the y-axis position (height) and the bar width. Furthermore, the y-axis position is normalized, such that the heights of the different segments within the same category add up to one. This normalization makes it possible to compare the relative frequencies within categories directly (notice how the right panel in Figure <a href="problems.html#fig:barplot-spineplot">4.9</a> makes it obvious that the proportion of red cases within the B and C categories is the same). Thus, like the barplot, the spineplot is a valuable tool for visualizing categorical data, especially when we can use interactive features to switch from one type of representation to the other.</p>
<p>Although barplot and spineplot represent the same underlying data, turning one into the other is not always easy. Specifically, while many grammar-based visualization systems offer a simple declarative syntax for defining barplots, they lack such simple syntax for spineplots. For instance, to draw a spineplot in <code>ggplot2</code>, we first need to do a substantial amount of data wrangling (creating the plot in the right panel of Figure <a href="problems.html#fig:barplot-spineplot">4.9</a> took over 10 lines of code, using standard <code>dplyr</code> syntax). This same hierarchical dependence applies to other “normalized” types of plots, such as spinograms, as well as innately hierarchical displays such as treemaps and mosaic plots [see e.g. <span class="citation">Theus (<a href="#ref-theus2002">2002</a>)</span>; slingsby2009].</p>
</div>
<div id="hierarchy" class="section level4 hasAnchor" number="4.2.3.4">
<h4><span class="header-section-number">4.2.3.4</span> Partitions and hierarchy<a href="problems.html#hierarchy" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Why are spineplots so tricky? The reason is that they force us to confront the hierarchical nature of (interactive) graphics <span class="citation">(<a href="#ref-mcdonald1990">McDonald, Stuetzle, and Buja 1990</a>; <a href="#ref-keller2024">Keller, Manz, and Gehlenborg 2024</a>)</span>. Specifically, while in a barplot, we can get by with a single flat partition of the data, in a spineplot, the data is summarized and stacked <em>along and across</em> different levels of aggregation <span class="citation">(<a href="#ref-wu2024">Wu and Chang 2024</a>)</span>:</p>
<ul>
<li>Along the x-axis, we stack the summaries <em>across the levels of the top-level factor/category</em></li>
<li>Along the y-axis, we stack the summaries <em>across the levels of a product of two factors</em> and normalize them by the values <em>within the levels of the top-level factor</em>.</li>
</ul>
<p>For example, assume we have a data set with two categorical variables, with <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span> levels respectively. If we want to render a spineplot using these two variables, it is not enough to simply split our data into <span class="math inline">\(j \cdot k\)</span> tables. Instead, we need to partition our data twice: first, split it into <span class="math inline">\(j\)</span> tables, and second, split it into <span class="math inline">\(j \cdot k\)</span> tables. We also need to keep track of the which of the <span class="math inline">\(j\)</span> tables on the first level of partitioning <em>corresponds</em> to each of the <span class="math inline">\(j \cdot k\)</span> smaller tables. This automatically induces a hierarchical relationship, where the resulting data subsets form a graph - specifically, a tree - see Figure <a href="problems.html#fig:spineplot-tree">4.10</a>:</p>
<div class="figure"><span style="display:block;" id="fig:spineplot-tree"></span>
<img src="figures/spineplot-tree.png" alt="A diagram of the hierarchical relationship between the subsets of the data represented by a spineplot/barplot. The whole data set is partitioned into bars, which are in turn partitioned into bar segments." width="708" />
<p class="caption">
Figure 4.10: A diagram of the hierarchical relationship between the subsets of the data represented by a spineplot/barplot. The whole data set is partitioned into bars, which are in turn partitioned into bar segments.
</p>
</div>
<p>In <a href="problems.html#fig:spineplot-tree">4.10</a>, each vertical level represents a data partition, and arrows indicate relationships between data subsets, such that a bar subset is composed of segment subsets, and the whole data set is in turn composed of bar subsets. This same tree can be used to represent both barplots and spineplots. For a stacked barplot, this tree structure can be implicit, since we can work with the lowest level of the partitioning only (the segments; ignoring details such as maintaining correct stacking order). However, for spineplots, this hierarchical structure is essential. In spineplots, we apply transformations <em>across</em> the levels of the hierarchy: we need to normalize the statistics corresponding to each segment by the values within the parent bar. This is only possible if each segment can reference its parent bar in some way.</p>
<p>Thus, we need a way for thinking about the hierarchical relationships in our data. Furthermore, for reasons that will become clear later, it may be beneficial to introduce a more formal, mathematical framework for thinking about this hierarchy. A simple algebraic structures for encoding hierarchies is a preorder.</p>
</div>
<div id="plots-as-preorders" class="section level4 hasAnchor" number="4.2.3.5">
<h4><span class="header-section-number">4.2.3.5</span> Plots as preorders<a href="problems.html#plots-as-preorders" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A <a href="mathematical-theory.html#preorders">preorder</a> is a binary relation on a set <span class="math inline">\(S\)</span>, generally denoted by <span class="math inline">\(\leq\)</span>, that is both reflexive and transitive. In simpler terms, given a preordered set <span class="math inline">\(S\)</span>, any two elements <span class="math inline">\(a, b \in S\)</span> either relate (<span class="math inline">\(a \leq b\)</span>, meaning <span class="math inline">\(a\)</span> is “less than” <span class="math inline">\(b\)</span>), or they do not relate at all. Further, the relation obeys some common sense properties: every element relates to itself (reflexivity), and if <span class="math inline">\(a\)</span> relates to <span class="math inline">\(b\)</span> and <span class="math inline">\(b\)</span> relates to <span class="math inline">\(c\)</span>, then <span class="math inline">\(a\)</span> relates to <span class="math inline">\(c\)</span> as well (transitivity).</p>
<p>We can turn our hierarchy of data subsets in Figure <a href="problems.html#fig:spineplot-tree">4.10</a> into a preorder very easily, by simply being more explicit about the relations in the figure. Specifically, define set <span class="math inline">\(S\)</span> as the set of data subsets, and the binary relation <span class="math inline">\(\leq\)</span> as the set inclusion relation <span class="math inline">\(\subseteq\)</span>. Then, we see that the two properties of preorders do indeed hold: every data subset is included in itself (reflexivity), and if a segment subset is a part of a bar subset, and bar subset is a part of the whole data set, then the segment subset is, clearly, a part of the whole data set as well (transitivity). We can describe this preorder via the following diagram (known as a Hasse diagram):</p>
<div class="figure"><span style="display:block;" id="fig:barplot-preorder"></span>
<img src="figures/barplot-preorder.png" alt="A diagram of a preorder of data subsets ordered by inclusion, corresponding to a barplot or spinogram. $W$ represents the whole data set, $B_i$ represent bars, and $S_j$ represent individual bar segments. Arrows indicate set inclusion." width="427" />
<p class="caption">
Figure 4.11: A diagram of a preorder of data subsets ordered by inclusion, corresponding to a barplot or spinogram. <span class="math inline">\(W\)</span> represents the whole data set, <span class="math inline">\(B_i\)</span> represent bars, and <span class="math inline">\(S_j\)</span> represent individual bar segments. Arrows indicate set inclusion.
</p>
</div>
<p>Notice the similarity to Figure <a href="problems.html#fig:spineplot-tree">4.10</a>. There really is not anything new here, we are simply being more explicit about our data assumptions. The real utility of this approach will be revealed later. However, for now, it may be useful to revise our definition of a regular plot:</p>
<div class="definition">
<p><span id="def:unlabeled-div-2" class="definition"><strong>Definition 4.2  (Regular plot 2) </strong></span>Regular plot is a plot where the geometric objects within one layer represent a preorder of data subsets ordered by inclusion (such that there is a bijection between these objects and the data subsets, and the subsets on the same order level represent a partition of the data).</p>
</div>
</div>
<div id="the-graph-behind-the-graph" class="section level4 hasAnchor" number="4.2.3.6">
<h4><span class="header-section-number">4.2.3.6</span> The graph behind the graph<a href="problems.html#the-graph-behind-the-graph" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To summarize, <em>graphs are graphs</em>. As a bit of a playful side-note, this view is not shared by everyone. Particularly, the poster of the following meme shared on the Mathematical Mathematics Memes Facebook group <span class="citation">(<a href="#ref-mathematicalmathematics2024">Martínez 2024</a>)</span> might not agree:</p>
<div class="figure"><span style="display:block;" id="fig:meme"></span>
<img src="figures/graphs-cosplayers.jpg" alt="A joke image shared in the Mathematical Mathematics Memes Facebook group on the 28th of March, 2024 [@mathematicalmathematics2024]." width="75%" style="border:1px solid black;" />
<p class="caption">
Figure 4.12: A joke image shared in the Mathematical Mathematics Memes Facebook group on the 28th of March, 2024 <span class="citation">(<a href="#ref-mathematicalmathematics2024">Martínez 2024</a>)</span>.
</p>
</div>
<p>I hope I have made a reasonably strong case here that many data visualization types are not “delusional cosplayers”. By organizing our data into a preorder, we induce a graph-like, part-whole relationship on the subsets. Thus, graphs really are graphs.</p>
<p>However, organizing our data into a preorder introduces a new kind of challenge: preserving the inherent structure. Preorders are algebraic objects imbued with structure, and, intuitively, it would be wrong to disregard this structure in the subsequent steps of the data visualization pipeline. For example, in a barplot, if we split our bars into segments, it would be inconsistent to stack some segments on top of each other while plotting others side-by-side. Clearly, any further manipulation of the hierarchically partitioned data should <em>respect this underlying structure</em>. However, what does it really mean to respect the structure of our data? This question will be explored in detail in the following section, which deals with the next step of the data visualization pipeline: aggregation.</p>
</div>
</div>
</div>
<div id="aggregation" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Aggregation<a href="problems.html#aggregation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>“This system cannot produce a meaningless graphic, however. This is a strong claim, vulnerable to a single counter-example. It is a claim based on the formal rules of the system, however, not on the evaluation of specific graphics it may produce.”</p>
<p>“Some of the combinations of graphs and statistical methods may be degenerate or bizarre, but there is no moral reason to restrict them.”</p>
<p><span class="citation">Wilkinson (<a href="#ref-wilkinson2012">2012</a>)</span>, The Grammar of Graphics, pp. 15 and 112.</p>
</blockquote>
<p>The second step of any data visualization pipeline is aggregation. Specifically, after we split our data into a hierarchy of parts (a preorder), we need to summarize each part via a set of summary statistics. Further, as I have hinted at in the previous section, these summaries should respect the hierarchical nature of the data. Thus, while the computing summaries may seem like a fairly straightforward step in the visualization pipeline, there is more complexity here than meets the eye. This will be the main subject of the present section.</p>
<div id="the-relationship-between-graphics-and-statistics" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> The relationship between graphics and statistics<a href="problems.html#the-relationship-between-graphics-and-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A key issue in data visualization, which is also the central theme of the present thesis, concerns the relationship between graphics and statistics. Specifically, when we summarize our data and then render these summaries as geometric objects, an important question arises: can we pair arbitrary statistics and geometric objects? Or are there constraints which limit which statistics and geometric objects can be effectively combined, particularly when interaction is involved?</p>
<div id="independence-the-grammar-based-model" class="section level4 hasAnchor" number="4.3.1.1">
<h4><span class="header-section-number">4.3.1.1</span> Independence: The grammar-based model<a href="problems.html#independence-the-grammar-based-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The approach of treating graphics and statistics as independent entities is highly appealing. Indeed, it is the cornerstone of the immensely popular “grammar-based” model of visualization, introduced by Wilkinson in his seminal work The Grammar of Graphics <span class="citation">(<a href="#ref-wilkinson2012">2012</a>)</span>. Under this model, visualizations are constructed out of independent, modular components, such as geometric objects, statistics, scales, and coordinate systems. See the following quote by Wilkinson <span class="citation">(<a href="#ref-wilkinson2012">2012, 14–15</a>)</span>:</p>
<blockquote>
<p>“We have tried to avoid adding functions, graphs, or operators that do not work independently across the system. There are doubtless many statistical graphics the system in this book cannot completely specify. We can add many different graphs, transformations, types of axes, annotations, etc., but there are two limitations we will always face with a formal system.</p>
</blockquote>
<p>The grammar-based model offers many advantages, including simplicity and expressive power. This has contributed to its widespread adoption and implementation in many data visualization systems <span class="citation">(see e.g. <a href="#ref-mcnutt2022">McNutt 2022</a>; <a href="#ref-kim2022">Kim et al. 2022</a>; <a href="#ref-vanderplas2020">Vanderplas, Cook, and Hofmann 2020</a>; <a href="#ref-wickham2010">Wickham 2010</a>; <a href="#ref-satyanarayan2014">Satyanarayan, Wongsuphasawat, and Heer 2014</a>; <a href="#ref-satyanarayan2016">Satyanarayan et al. 2016</a>)</span>. The canonical example is the famous <code>ggplot2</code> package <span class="citation">(<a href="#ref-wickham2010">Wickham 2010</a>)</span>. In <code>ggplot2</code>, plots are built out of components such as geometric objects (called <code>geoms</code>), statistical summaries (<code>stats</code>), and scales. These components can be flexibly combined, allowing the user to express a wide range of graphics using a small set of primitives. The expressive power of <code>ggplot2</code> has made it one of the most popular R packages of all time.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>However, despite its advantages, the grammar-based model has one fundamental flaw: graphics and statistics are not truly independent <span class="citation">(see also <a href="#ref-wu2024">Wu and Chang 2024</a>)</span>. Instead, the visual representation of data must be congruent with its mathematical properties. This constraint, while present even in static visualizations, becomes especially critical in interactive contexts. Let’s illustrate this point with an example of real-world data.</p>
</div>
<div id="stacking-not-graphical" class="section level4 hasAnchor" number="4.3.1.2">
<h4><span class="header-section-number">4.3.1.2</span> Stacking: Limits of independence<a href="problems.html#stacking-not-graphical" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For this example, I will use famous data set from a study on the effect of smoking on child lung capacity <span class="citation">(<a href="#ref-tager1979">Tager et al. 1979</a>; <a href="#ref-kahn2005">Kahn 2005</a>)</span>. In the study, the researchers measured children’s forced expiratory volume (FEV), and recorded it alongside age, height, sex, and smoking status.</p>
<p>A rather surprising feature of this data set is that, at a glance, the children who smoked actually had greater lung volume than non-smokers. In <code>ggplot2</code>, we can easily create a boxplot showing the relationship between smoking status and FEV using the following short code snippet:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="problems.html#cb7-1" tabindex="-1"></a>fev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/fev.csv&quot;</span>)</span>
<span id="cb7-2"><a href="problems.html#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="problems.html#cb7-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-4"><a href="problems.html#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="problems.html#cb7-5" tabindex="-1"></a><span class="fu">ggplot</span>(fev, <span class="fu">aes</span>(smoke, fev, <span class="at">fill =</span> smoke)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="problems.html#cb7-6" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb7-7"><a href="problems.html#cb7-7" tabindex="-1"></a><span class="co"># There is actually a bit more code involved in producing the plot below,</span></span>
<span id="cb7-8"><a href="problems.html#cb7-8" tabindex="-1"></a><span class="co"># but it all just has to do with design/aesthetic flair</span></span></code></pre></div>
<p><img src="figures/grammar-boxplot.png" width="750" /></p>
<p>Before we start extolling the benefits of smoking for juvenile lung health, it may be a good idea to first look at some confounding variables. Lung volume develops with age, and the researchers had collected data from children ages three and up. Clearly, there were not going to be many smokers among three-year olds, so we should make sure age is not a confounder.</p>
<p>We can verify that there indeed is a strong relationship between age and FEV like so:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="problems.html#cb8-1" tabindex="-1"></a><span class="fu">ggplot</span>(fev, <span class="fu">aes</span>(age, fev, <span class="at">fill =</span> smoke)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="problems.html#cb8-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="figures/grammar-scatterplot.png" width="750" /></p>
<p>From the plot above, we can see that age and FEV correlate strongly, and also that the smokers tend to be quite a bit older than the non-smokers. To visualize the distribution of smokers and non-smokers across age a bit more clearly, we can draw an ordinary stacked barplot:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="problems.html#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(fev, <span class="fu">aes</span>(age, fev, <span class="at">fill =</span> smoke)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="problems.html#cb9-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:grammar-barplot-counts"></span>
<img src="figures/grammar-barplot-counts.png" alt="The number of participants by age and smoking status. Notice that the bar segments 'stack', such that the height of the whole bar accurately represents the combined number of smokers and non-smokers." width="750" />
<p class="caption">
Figure 4.13: The number of participants by age and smoking status. Notice that the bar segments ‘stack’, such that the height of the whole bar accurately represents the combined number of smokers and non-smokers.
</p>
</div>
<p>The plot above clearly shows that there were more smokers than non-smokers, and that smokers tended to be on average older. This provides a support for our confounding hypothesis.</p>
<p>Now, what if we wanted to compare FEV across the different ages? A data visualization novice might do something like below, and draw a stacked barplot of the average FEV in each age group:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="problems.html#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(fev, <span class="fu">aes</span>(age, fev, <span class="at">fill =</span> smoke)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="problems.html#cb10-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:grammar-barplot-means"></span>
<img src="figures/grammar-barplot-means.png" alt="A fundamentally flawed visualization of the average FEV by age and smoking status. Notice that the total height of the stacked bars is meaningless: it represents the sum of grouped averages, which is not a valid summary of the combined smoker and non-smoker data." width="750" />
<p class="caption">
Figure 4.14: A fundamentally flawed visualization of the average FEV by age and smoking status. Notice that the total height of the stacked bars is meaningless: it represents the sum of grouped averages, which is not a valid summary of the combined smoker and non-smoker data.
</p>
</div>
<p>At a glance, the plot in <a href="problems.html#fig:grammar-barplot-means">4.14</a> looks fine. However, what do the heights of the stacked bars actually represent? Each coloured bar segment represents a mean of the <code>fev</code> variable, grouped by the levels defined by the product of the <code>age</code> and <code>smoke</code> variables. By stacking the bars on top of each other, we are essentially summing up the average FEV of smokers and non-smokers, within the given age category.</p>
</div>
<div id="some-statistics-are-stackable-but-others-are-not" class="section level4 hasAnchor" number="4.3.1.3">
<h4><span class="header-section-number">4.3.1.3</span> Some statistics are stackable but others are not<a href="problems.html#some-statistics-are-stackable-but-others-are-not" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The visualization in <a href="problems.html#fig:grammar-barplot-means">4.14</a> is problematic because the bar heights lack a meaningful statistical interpretation. The sum of group means is not something that most consumers of visualizations would know how to interpret or care about. In the previous example, in Figure <a href="problems.html#fig:grammar-barplot-counts">4.13</a>, the heights of the stacked bars represented valid overall counts - the number of smokers and non-smokers within a given age category combined. In Figure <a href="problems.html#fig:grammar-barplot-means">4.14</a>, this is no longer the case - the sum of the group means is different from the mean of the combined cases, and so may be the mean of the group means.</p>
<p>In <code>ggplot2</code>, stacking is implemented as a purely graphical operation. That is, within the context of the visualization system, stacking operates on geometric objects (rectangles), irrespective of the underlying summary statistics. However, as we can see from the example above, this can cause problems - <em>what</em> we stack matters. Indeed, many data visualization researchers have explicitly warned about this problem:</p>
<blockquote>
<p>“Stacking is useful when the sum of the amounts represented by the individual stacked bars is in itself a meaningful amount” <span class="citation">(<a href="#ref-wilke2019">Wilke 2019, 52</a>)</span>.</p>
</blockquote>
<blockquote>
<p>“Because this gives the visual impression of one element that is the sum of several others, it is very important that if the element’s size is used to display a statistic, then that statistic must be summable. Stacking bars that represent counts, sums, or percentages are fine, but a stacked bar chart where bars show average values is generally meaningless.” <span class="citation">(<a href="#ref-wills2011">Wills 2011, 112</a>)</span>.</p>
</blockquote>
<blockquote>
<p>“[…] We do this to ensure that aggregate statistics are always computed over the input data, and so users do not inadvertantly compute e.g., averages of averages, which can easily lead to misinterpretation.” <span class="citation">(<a href="#ref-wu2022">Wu 2022</a>)</span></p>
</blockquote>
<p>Based on the quotes above, one might get the impression that we can only ever “stack” or “highlight” sums and counts, to get a valid combined summary statistics. However, take a look at the following plot:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="problems.html#cb11-1" tabindex="-1"></a><span class="co"># Code is not included because this plot cannot be recreated </span></span>
<span id="cb11-2"><a href="problems.html#cb11-2" tabindex="-1"></a><span class="co"># with a simple ggplot2 call (without data wrangling)</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:grammar-barplot-maximums"></span>
<img src="figures/grammar-barplot-maximums.png" alt="The maximum of maxima is a valid maximum of all cases." width="750" />
<p class="caption">
Figure 4.15: The maximum of maxima is a valid maximum of all cases.
</p>
</div>
<p>Here, in Figure <a href="problems.html#fig:grammar-barplot-maximums">4.15</a>, we again plot FEV for smokers and non-smokers across the different age groups, however, this time, we display the <em>maximum FEV</em> on the y-axis. From this plot, we can see that, in most of the age categories which included smokers (age 9 and up), the child with the highest lung capacity was a non-smoker, although there were a few exceptions (ages 11, 16, and 18).</p>
<p>Notice one important feature of the plot above: the heights of the “stacked” bars represent a valid overall summary. Taking grouped data, summarizing each group by its maximum, and then taking the maximum of those maxima yields a valid overall maximum. That is, <em>the maximum of maxima is a valid maximum of all cases</em>. While the general usefulness of the plot in Figure <a href="problems.html#fig:grammar-barplot-maximums">4.15</a> could be debated - given that each bar effectively represents a single data point (the group maximum), and that, in small data sets, the maximum can be a highly variable - the plot still demonstrates one important, undeniable fact: summaries other than sums and counts can be meaningfully “stacked.”</p>
</div>
<div id="stacking-part-whole" class="section level4 hasAnchor" number="4.3.1.4">
<h4><span class="header-section-number">4.3.1.4</span> Advantages of stacking: Part-whole relationship<a href="problems.html#stacking-part-whole" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Before we go on to discuss what makes certain statistics stackable, we first need to address the issue of of why spend so much time talking about stacking in the first place. Specifically, some might argue that stacking is only one way of presenting partitioned data, and that we could equally well present “unstackable” summaries such as the averages in Figure <a href="problems.html#fig:grammar-barplot-means">4.14</a> by plotting the corresponding bars side by side (a technique know as dodging), or by plotting them on top of each other in semi-transparent layers, see <a href="problems.html#fig:dodging-layering">4.16</a>:</p>
<div class="figure"><span style="display:block;" id="fig:dodging-layering"></span>
<img src="figures/grammar-dodging-layering.png" alt="Two alternative means of displaying partitioned data: dodging and layering." width="750" />
<p class="caption">
Figure 4.16: Two alternative means of displaying partitioned data: dodging and layering.
</p>
</div>
<p>Much has been written about the relative merits of stacking, dodging, and layering. For example, layering is only useful with few categories, as blending many colors can make it difficult to tell the categories apart <span class="citation">(<a href="#ref-franconeri2021">Franconeri et al. 2021</a>; <a href="#ref-wilke2019">Wilke 2019</a>)</span>. Further, in a landmark study, <span class="citation">Cleveland and McGill (<a href="#ref-cleveland1984">1984</a>)</span> showed that people tend to be less accurate when reading information from stacked bar charts as opposed to dodged bar charts. Specifically, since the lower y-axis coordinate of a stacked segment is pushed up by the cumulative height of the segments below, it becomes difficult to accurately compare segments’ length, both within and across bars <span class="citation">(<a href="#ref-cleveland1984">Cleveland and McGill 1984</a>)</span>. Subsequent research has independently validated these findings and expanded upon them <span class="citation">(see e.g. <a href="#ref-heer2010">Heer and Bostock 2010</a>; <a href="#ref-thudt2016">Thudt et al. 2016</a>; <a href="#ref-quadri2021">Quadri and Rosen 2021</a>)</span>. Due to this suboptimal statistical legibility, many data visualization researchers have urged caution about stacking <span class="citation">(see e.g. <a href="#ref-byron2008">Byron and Wattenberg 2008</a>; <a href="#ref-cairo2014">Cairo 2014</a>; <a href="#ref-franconeri2021">Franconeri et al. 2021</a>)</span>, and some have even discouraged its use altogether <span class="citation">(<a href="#ref-kosara2016">Kosara 2016</a>; <a href="#ref-wilke2019">Wilke 2019</a>)</span>.</p>
<p>However, I contend that, while dodging and layering are indeed valuable techniques for static visualization, stacking offers significant advantages in interactive contexts. The issue comes down to how the three techniques represent the relatedness of data subsets. In dodging and layering, the only indication of the fact that two subsets are related is their spatial proximity. In contrast, in stacking, the stacked segments are both close together in space (proximity) and also combine together to form a single object <span class="citation">(part-whole relationship, see also <a href="#ref-slingsby2009">Slingsby, Dykes, and Wood 2009</a>)</span>. Thus, in a stacked barplot, we can interpret an individual stacked segments as highlighted <em>parts</em> of a bar, whereas the same is not true for dodging or layering. This subtle distinction has important implications for the figure’s visual properties and interactive behavior <span class="citation">(see also <a href="#ref-roberts2000">Roberts et al. 2000</a>; <a href="#ref-wilhelm2008">Wilhelm 2008</a>)</span>.</p>
<p>Take, for instance, the typical stacked barplot. In a stacked barplot, the heights of the stacked segments sum to the height of the whole bar, providing a fixed upper bound and a clear visual anchor, see Figure <a href="problems.html#fig:stacking-vs-dodging">4.17</a>. This is particularly useful with linked selection. Even when the heights of the segments change, the total bar height remains constant, allowing us to maintain a fixed upper limit on the y-axis, for instance. Besides other advantages, this also reduces the computational overhead, since the axis limits only need to be recomputed <em>when the heights of the whole bars change</em> (e.g. changing binwidth in a histogram), not when the heights of the segments change.</p>
<div class="figure"><span style="display:block;" id="fig:stacking-vs-dodging"></span>
<img src="figures/stacking-vs-dodging.png" alt="Stacking has advantages over dodging (and layering) when it comes to displaying linked selection. Plots left to right show simulated static snapshots of more cases being selected (red). In a stacked barplot (top row), the heights of the higlighted segments are always bound by the height of the whole bar, and so the outline of the figure remains constant. In contrast, in a dodged barplot, the bar segment heights are not bounded, leading to the outline of the figure fluctuating dramatically (notice the changing upper y-axis limit)." width="750" />
<p class="caption">
Figure 4.17: Stacking has advantages over dodging (and layering) when it comes to displaying linked selection. Plots left to right show simulated static snapshots of more cases being selected (red). In a stacked barplot (top row), the heights of the higlighted segments are always bound by the height of the whole bar, and so the outline of the figure remains constant. In contrast, in a dodged barplot, the bar segment heights are not bounded, leading to the outline of the figure fluctuating dramatically (notice the changing upper y-axis limit).
</p>
</div>
<p>This is not the case for dodging and layering. Here, the heights of the bars are not bound by any value, such that the heights of the selected segments can exceed those of unselected segments. This forces us to choose between making the upper y-axis limit reactive (losing the context that the limit provides, each time seleciton happens), or risking the bars “overflowing” the plot area. Furthermore, this lack of visual anchoring creates suboptimal visuals. Research shows that translating and looming stimuli capture attention <span class="citation">(<a href="#ref-franconeri2003">Franconeri and Simons 2003</a>)</span>. Because dodged (or layered) segments lengths lack a visual anchor, they can move around (stretch or shrink) in unpredictable ways in response to selection, creating a distracting visual effect:</p>
<p>The only reference I have been able to find which addresses this issue directly is <span class="citation">Wilhelm (<a href="#ref-wilhelm2008">2008</a>)</span>. Wilhelm outlines three strategies for displaying selection: replacement, overlaying, and repetition. Within the context of the three techniques discussed above (stacking, dodging, and layering), overlaying essentially conflates both stacking and layering, repetition is equivalent to dodging, and replacement involves re-rendering the visualization completely upon selection. Wilhelm argues that replacement is a flawed because it entirely discards contextual information such as axis limits. He also notes that repetition is less common due to the necessity of re-arranging the plot upon selection. Finally, he identifies two issues with overlaying: the fact that plot parameters are inherited from the plot representing the whole data set, and the fact that parts of the original plot may become obscured by the highlighted subset. Ultimately, he appears to favor repetition over the other two methods.</p>
<p>My conclusion diverges from <span class="citation">Wilhelm (<a href="#ref-wilhelm2008">2008</a>)</span>. I contend that, while overlaying/stacking is less flexible than the other two methods, it is nevertheless the superior, since it ensures that the context of the whole data is always preserved. Conversely, repetition/dodging suffers from the same contextual loss as replacement. Specifically, if we draw highlighted subsets as separate objects, then, in the general case, we either have to make the axis limits reactive (leading to loss of context), or risk that the highlighted objects may exceed the plot area. What <span class="citation">Wilhelm (<a href="#ref-wilhelm2008">2008</a>)</span> sees as one of the problems of overlaying - the fact that plot parameters are inherited from the whole data - I instead see as a fundamental strength. The part-whole relationship between the highlighted segments ensures that interaction preserves context, and also reduces computational overhead.</p>
</div>
</div>
<div id="stackable-summaries-a-brief-journey-into-category-theory" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Stackable summaries: A brief journey into Category Theory<a href="problems.html#stackable-summaries-a-brief-journey-into-category-theory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now it is finally time to discuss what makes certain statistics stackable. To do this, I will need to use some fundamental concepts from category theory. These concepts are described in greater detail in the <a href="mathematical-theory.html#mathematical-theory">Appendix: Mathematical Theory</a> - the reader is advised to consult this section if they are unfamiliar with the material (links to appropriate sections will also be provided throughout the following text).</p>
<p>Let’s briefly recap the key points so far. In section <a href="problems.html#partitioning">4.2</a>, I advocated for modeling plots as a hierarchy of partitions. Specifically, starting with the full data set, we divide it into disjoint subsets, each corresponding to a geometric object. These subsets can then be further subdivided, representing parts of those objects (such as those resulting from linked selection). As discussed in Section <a href="problems.html#hierarchy">4.2.3.4</a>, we end up with a tree-like structure that encodes this part-whole relationship, that can be best described as a preorder.</p>
<p>Further, I have made the argument that, when summarizing our data, we should choose summary statistics which preserve this hierarchical, tree-like structure of our data. In Section (stacking-not-graphical), I showed an example of visualizations which violate this structure, by stacking “unstackable” summary statistics, and pointed to others who have noted this problem. I have also showed that this property of being “stackable” is <em>not</em> unique to sums and counts.</p>
<div id="generalizing-preorders-categories" class="section level4 hasAnchor" number="4.3.2.1">
<h4><span class="header-section-number">4.3.2.1</span> Generalizing preorders: Categories<a href="problems.html#generalizing-preorders-categories" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Before, I had formalized the hierarchy of data subsets as a preorder. Now, we need to take one step further towards abstraction by describing preorders within the framework of category theory, specifically as categories.</p>
<p>Although often perceived as complex, the definition of a <a href="mathematical-theory.html#categories">category</a> is actually quite straightforward. In simple terms, a category <span class="math inline">\(\mathcal{C}\)</span> is just a collection of objects, connected by arrows, that conforms to a few properties. More specifically, when we have a category <span class="math inline">\(\mathcal{C}\)</span>:</p>
<ul>
<li>We have a collection of objects <span class="math inline">\(\text{Ob}(\mathcal{C})\)</span></li>
<li>For every pair of objects <span class="math inline">\(c_1, c_2 \in \text{Ob}(\mathcal{C})\)</span>, there is a set of of arrows (morphisms) <span class="math inline">\(c_1 \to c_2\)</span>, <span class="math inline">\(\mathcal{C}(c_1, c_2)\)</span></li>
</ul>
<p>Further:</p>
<ul>
<li>Every object <span class="math inline">\(c \in \text{Ob}(\mathcal{C})\)</span> has special arrow <span class="math inline">\(\text{id}_c\)</span> pointing back to itself (called the identity morphism)</li>
<li>Arrows compose. That is, if there is an arrow <span class="math inline">\(f\)</span> from object <span class="math inline">\(c_1\)</span> to object <span class="math inline">\(c_2\)</span>, and an arrow <span class="math inline">\(g\)</span> from object <span class="math inline">\(c_2\)</span> to object <span class="math inline">\(c_3\)</span>, we can define a composite arrow <span class="math inline">\(f \then g\)</span> from <span class="math inline">\(c_1\)</span> to <span class="math inline">\(c_3\)</span></li>
</ul>
<p>Finally, the arrows need to conform to two properties:</p>
<ul>
<li>Composing with the identity morphism leaves arrows unchanged: <span class="math inline">\(\text{id}_{c_1} \then f = f \then \text{id}_{c_2} = f\)</span></li>
<li>Composition is associative: <span class="math inline">\(f \then (g \then h) = (f \then g) \then h = f \then g \then h\)</span></li>
</ul>
<p>For example, the following is a diagram of a simple category with 2 objects and a single non-identity morphism, called <span class="math inline">\(\underline{\textbf{2}}\)</span>:</p>
<p><img src="figures/category-two.png" width="214" /></p>
<p>What are the objects? What are the arrows? That is all left for us to specify. The abstract nature of the definition can make it difficult to grasp initially, however, there are some fairly straightforward examples that can help. For instance, one simple class of categories are those where the objects <span class="math inline">\(c \in \text{Ob}(\mathcal{C})\)</span> are elements of some set. However, it is important to keep in mind that the definition is far, far broader - the objects could themselves be sets, more complex algebraic structures such as groups, rings, or graphs, or even entire categories.<br />
One simple example of a category is a preorder. Specifically, it can be shown that every preorder is in fact a category. Given a preorder on a set <span class="math inline">\(S\)</span>, define the objects <span class="math inline">\(c \in \text{Ob}(\mathcal{C})\)</span> as the elements in <span class="math inline">\(s \in S\)</span>, and, for any two objects <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, define at most one morphism <span class="math inline">\(a \to b\)</span> if <span class="math inline">\(a \leq b\)</span> (and no morphism if <span class="math inline">\(a \not \leq b\)</span>). Then, the two properties of preorders just fall out of the definition of a category:</p>
<ul>
<li>Reflexivity: that is just the identity morphism. For every <span class="math inline">\(c \in \text{Ob}(\mathcal{C})\)</span>, we have <span class="math inline">\(\text{id}_c : c \to c\)</span></li>
<li>Transitivity: that is just composition of morphisms. Given <span class="math inline">\(f: a \to b\)</span> (<span class="math inline">\(a \leq b\)</span>) and <span class="math inline">\(g: b \to c\)</span> (<span class="math inline">\(b \leq c\)</span>), we can define <span class="math inline">\(h: a \to c\)</span> as <span class="math inline">\(h = f \then g\)</span> (<span class="math inline">\(a \leq c\)</span>)</li>
</ul>
<p>In our concrete case of the preorder of data subsets ordered by inclusion, we can easily reuse the same diagram from Section [REFERENCE], that is, Figure <a href="problems.html#fig:barplot-preorder">4.11</a>, and re-intepret it as a category:</p>
<p><img src="figures/barplot-preorder.png" width="427" /></p>
<p>Here, the objects are again just the data subsets, such as the whole data set <span class="math inline">\(W\)</span>, the bars <span class="math inline">\(B_i\)</span>, and the segments <span class="math inline">\(S_j\)</span>. The morphisms are the arrows indicating the set inclusion relationship. The fact that there is an arrow between <span class="math inline">\(S_1\)</span> and <span class="math inline">\(B_1\)</span>, but no arrow between <span class="math inline">\(S_1\)</span> and <span class="math inline">\(S_2\)</span> simply means that segment 1 is a subset of bar 1, but segments 1 and 2 are disjoint. As mentioned above, reflexivity and transitivity fall out of the definition of a category.</p>
<p>While the benefits of this abstract reformulation of preorders might not be immediately apparent, I encourage the reader to bear with me. In the next sections, I will show the advantages of thinking about our data and visualizations categorically.</p>
</div>
<div id="structure-preserving-maps-functors" class="section level4 hasAnchor" number="4.3.2.2">
<h4><span class="header-section-number">4.3.2.2</span> Structure preserving maps: Functors<a href="problems.html#structure-preserving-maps-functors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A second fundamental concept in category theory is that of a structure-preserving map or a <a href="mathematical-theory.html#functors">functor</a>. A functor is a mapping from one category to another, such that the properties of the first category are preserved or reflected in its embedding within the second <span class="citation">(this can also be thought of as drawing a diagram of the the first category inside the second category, <a href="#ref-fong2019">Fong and Spivak 2019</a>)</span>.</p>
<p>In category theoretic terms, a functor <span class="math inline">\(F: \mathcal{C} \to \mathcal{D}\)</span> is a mapping from category <span class="math inline">\(\mathcal{C}\)</span> to category <span class="math inline">\(\mathcal{D}\)</span> such that:</p>
<ul>
<li>Every object in <span class="math inline">\(c \in \text{Ob}(\mathcal{C})\)</span> is mapped to some object <span class="math inline">\(d \in \text{Ob}(\mathcal{D})\)</span></li>
<li>Every morphism <span class="math inline">\(f: c_1 \to c_2\)</span> in <span class="math inline">\(\mathcal{C}(c_1, c_2)\)</span> is mapped to some morphism in <span class="math inline">\(\mathcal{D}(F(c_1), F(c_2))\)</span>, i.e. <span class="math inline">\(F(f): F(c_1) \to F(c_2)\)</span></li>
</ul>
<p>Further, this mapping is subject to two fundamental properties:</p>
<ul>
<li>Identities are preserved: <span class="math inline">\(F(\text{id}_c) = \text{id}_{F(c)}\)</span></li>
<li>Composition is too: <span class="math inline">\(F(f \then g) = F(f) \then F(g)\)</span></li>
</ul>
<p>The first property simply states that objects cannot be separated from their identities. The second property is more interesting, since it tells us that all compositions (chains of arrows) must be preserved. Other than that, we are free to map the objects and arrows as we wish. We can map multiple objects in <span class="math inline">\(\text{Ob}(\mathcal{C})\)</span> to a single object in <span class="math inline">\(\text{Ob}(\mathcal{D})\)</span>, “squish” a morphism (or a chain of morphisms) in <span class="math inline">\(\mathcal{C}\)</span> by mapping it to an identity morphism in <span class="math inline">\(\mathcal{D}\)</span>, or “stretch” a morphism in <span class="math inline">\(\mathcal{C}\)</span> by mapping it to a composite morphism in <span class="math inline">\(\mathcal{D}\)</span>. However, we cannot “tear” or “rip” any morphism or chain of morphisms in <span class="math inline">\(\mathcal{C}\)</span> into multiple parts in <span class="math inline">\(\mathcal{D}\)</span>.</p>
<p>This second property of preserving composition can be described by the following commutative diagram:</p>
<div class="figure"><span style="display:block;" id="fig:functor"></span>
<img src="figures/functor.png" alt="A commutative diagram of showing how a functor $F$ preserves associativity." width="299" />
<p class="caption">
Figure 4.18: A commutative diagram of showing how a functor <span class="math inline">\(F\)</span> preserves associativity.
</p>
</div>
<p>Here, <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span> are three objects in category <span class="math inline">\(\mathcal{C}\)</span> and <span class="math inline">\(F(A)\)</span>, <span class="math inline">\(F(B)\)</span>, and <span class="math inline">\(F(C)\)</span> are the same three objects mapped to category <span class="math inline">\(\mathcal{D}\)</span>. Since <span class="math inline">\(A\)</span> maps to <span class="math inline">\(B\)</span> via <span class="math inline">\(f\)</span>, and <span class="math inline">\(B\)</span> maps to <span class="math inline">\(C\)</span> via <span class="math inline">\(g\)</span> (both in <span class="math inline">\(\mathcal{C}\)</span>), we can compose the morphisms and map <span class="math inline">\(A\)</span> to <span class="math inline">\(C\)</span> directly via <span class="math inline">\(f \then g\)</span>. When we apply a functor, this property needs to be preserved for any such three objects <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span>.</p>
<p>In simple terms, the second property of functors means that, if we have a way to move from <span class="math inline">\(A\)</span> to <span class="math inline">\(C\)</span> in <span class="math inline">\(\mathcal{C}\)</span>, we <em>must</em> have a way to move from <span class="math inline">\(F(A)\)</span> to <span class="math inline">\(F(C)\)</span> in <span class="math inline">\(\mathcal{D}\)</span> (even if it means staying in the same place - for example, we may map <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span> to the same object in <span class="math inline">\(\mathcal{D}\)</span>, and map <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> to the identity morpism).</p>
</div>
<div id="aggregation-a-functor-from-the-preorder-of-data-subsets-to-the-preorder-of-summary-statistics" class="section level4 hasAnchor" number="4.3.2.3">
<h4><span class="header-section-number">4.3.2.3</span> Aggregation: A functor from the preorder of data subsets to the preorder of summary statistics<a href="problems.html#aggregation-a-functor-from-the-preorder-of-data-subsets-to-the-preorder-of-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As mentioned before, we start with a preorder of data subsets ordered by inclusion, which can be re-interpreted as a category. When we aggregate, we summarize each of these subsets by one or more metrics. We can imagine the process of summarizing data subsets as a functor, mapping from the space of data subsets ordered by set inclusion to the space of summary statistics or metrics, also ordered in some way.</p>
<p>But before we go on to do that, we need to one more trick. We can recast the set inclusion relations in Figure <a href="problems.html#fig:barplot-preorder">4.11</a> as set union. Specifically, instead of the arrows simply denoting the fact that, for example, segment 1 is a subset of bar 1, we can be explicit about the fact that, to get bar 1, we need to take the union of segment 1 and <em>all the other segments within the bar</em>:</p>
<div class="figure"><span style="display:block;" id="fig:barplot-preorder2"></span>
<img src="figures/barplot-preorder2.png" alt="The preorder of data subsets corresponding to a barplot, this time ordered by set union." width="492" />
<p class="caption">
Figure 4.19: The preorder of data subsets corresponding to a barplot, this time ordered by set union.
</p>
</div>
<p>Now, given that we want to preserve the structure of the diagram above, it is natural that we want to preserve properties of set union. For our purposes, two important property of set union we may want to preserve are:</p>
<ul>
<li>Unitality: <span class="math inline">\(A \cup \varnothing = A\)</span> (for all sets <span class="math inline">\(A\)</span>).</li>
<li>Associativity: <span class="math inline">\(A \cup (B \cup C) = (A \cup B) \cup C = A \cup B \cup C\)</span> (for all sets <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span>).</li>
</ul>
<p>The first property, unitality, is relatively straightforward. It simply means that the union of any set with the empty set is just the original set. We can also interpret this as the identity arrow from each object back to itself (since the union of any set with the empty set, <span class="math inline">\(- \cup \varnothing\)</span>, is just the original set). By the functor laws:</p>
<p><span class="math display">\[F(A \cup \varnothing) = F(A) \otimes F(\varnothing) = F(A)\]</span></p>
<p>Therefore, the summary operation <span class="math inline">\(F\)</span> must be produce a valid summary when applied to the empty set <span class="math inline">\(\varnothing\)</span>, and this summary must be unital, such that when combined with any other summary simply yields back the original summary.</p>
<p>The second property, associativity, is a bit more interesting. It means that the order in which we take union of multiple sets does not matter. We can describe it via the following commutative diagram:</p>
<div class="figure"><span style="display:block;" id="fig:barplot-associativity"></span>
<img src="figures/barplot-associativity.png" alt="Set union is associative. We can either first combine set $S_1$ with set $S_2$ and then with set $S_3$, or combine subset $S_1$ with with union of $S_2$ and $S_3$ directly, and get the same result." width="354" />
<p class="caption">
Figure 4.20: Set union is associative. We can either first combine set <span class="math inline">\(S_1\)</span> with set <span class="math inline">\(S_2\)</span> and then with set <span class="math inline">\(S_3\)</span>, or combine subset <span class="math inline">\(S_1\)</span> with with union of <span class="math inline">\(S_2\)</span> and <span class="math inline">\(S_3\)</span> directly, and get the same result.
</p>
</div>
<p>Here, like in any commutative diagram, two parallel paths indicate the same result. Starting at <span class="math inline">\(S_1\)</span>, we can either take the <em>long path</em>, and combine <span class="math inline">\(S_1\)</span> with <span class="math inline">\(S_2\)</span>, and then combine the result with <span class="math inline">\(S_3\)</span>, or take the <em>short path</em>, and combine <span class="math inline">\(S_1\)</span> with the union <span class="math inline">\(S_2 \cup S_3\)</span> directly. The diagram in Figure <a href="problems.html#fig:barplot-associativity">4.20</a> merely tells us that, no matter which path we take, we always end up with the same result.</p>
<p>We could imagine drawing these commutative diagrams for any possible sequence of subsets. For example, the following diagram shows all the ways three subsets can be sequentially combined to form their union:</p>
<div class="figure"><span style="display:block;" id="fig:barplot-associativity2"></span>
<img src="figures/barplot-associativity2.png" alt="All the ways three subsets can be combined into one superset. Arrow labels are omitted to prevent the diagram from becoming cluttered." width="452" />
<p class="caption">
Figure 4.21: All the ways three subsets can be combined into one superset. Arrow labels are omitted to prevent the diagram from becoming cluttered.
</p>
</div>
<p>Further, we could actually draw all of these possible paths inside <a href="problems.html#fig:barplot-preorder2">4.19</a>. However, as you can imagine, with so many arrows and nodes, the figure would quickly become very busy - in Figure <a href="problems.html#fig:barplot-associativity2">4.21</a>, the number of paths grows as a factorial of the number of bottom nodes <span class="citation">(<a href="#ref-fong2019">Fong and Spivak 2019</a>)</span>. Nevertheless, this structure <em>is there</em>, implicitly: we know that we can combine the data subsets corresponding to bar segments in any order, and end up with a valid bar subset.</p>
<p>Thus, when we go on to map our data from the space of data subsets into a space of statistics, we want to preserve this web of arrows. In the microcosm of three segment subsets combining into a bar subset, we want the following diagram to commute:</p>
<div class="figure"><span style="display:block;" id="fig:functor-diagram"></span>
<img src="figures/barplot-functor.png" alt="Commutative diagram of the functor from the space of the data subsets to the space of summary statistics. The top triangle represents the associativity of taking the union of data subsets, F represents the operation of summarizing a set via a summary statistic, and otimes represents the operation of combining two summary statistics together." width="452" />
<p class="caption">
Figure 4.22: Commutative diagram of the functor from the space of the data subsets to the space of summary statistics. The top triangle represents the associativity of taking the union of data subsets, F represents the operation of summarizing a set via a summary statistic, and otimes represents the operation of combining two summary statistics together.
</p>
</div>
<p>This is precisely the diagram of a functor from Figure <a href="problems.html#fig:functor">4.18</a>. The functor <span class="math inline">\(F\)</span> here represents the action of taking a subset of data and summarizing it (more on that later). Most importantly, the commutative diagram tells us the following:</p>
<blockquote>
<p>The summary operation should preserve set union, meaning that we can either first combine the data subsets via union and then summarize the resulting superset, or first summarize the subsets and then combine the summaries, <em>and the result will be the same.</em></p>
</blockquote>
<p>This is the most important point in this section, and one of the most important points in the whole thesis. The definition of a functor tells us which summary statistics can meaningfully preserve the part-whole hierarchical partitioning of our data, and this in turn tells us whether they will be “stackable” and behave well under linked selection.</p>
</div>
<div id="stackable-summaries-monoids" class="section level4 hasAnchor" number="4.3.2.4">
<h4><span class="header-section-number">4.3.2.4</span> Stackable summaries: Monoids<a href="problems.html#stackable-summaries-monoids" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>So far, I have argued that the summary statistics in our plots should preserve the properties of set union, and formalized this idea via the concept of a structure-preserving map or functor. Now, we can apply this definition to concretely identify the set of valid summary statistics that possess these structure-preserving properties. That is, we can describe the statistics which “behave like set union”.</p>
<p>The two important properties of set union we wish to preserve are:</p>
<ul>
<li>Unitality: <span class="math inline">\(F(A \cup \varnothing) = F(A) \otimes F(\varnothing) = F(A)\)</span></li>
<li>Associativity <span class="math inline">\(F(A \cup (B \cup C)) = F((A \cup B) \cup C) = F(A) \otimes F(B) \otimes F(C)\)</span></li>
</ul>
<p>It turns out there is an algebraic structure with these exact properties. Specifically, a monoid <span class="math inline">\((M, e, \otimes)\)</span> is a set <span class="math inline">\(M\)</span> equipped with a binary operation <span class="math inline">\(\otimes\)</span> and a special neutral element <span class="math inline">\(e\)</span>, such that the operation is:</p>
<ul>
<li>Unital: <span class="math inline">\(m \otimes e = e \otimes m = m\)</span> for all <span class="math inline">\(m \in M\)</span></li>
<li>Associative: <span class="math inline">\((m_1 \otimes m_2) \otimes m_3 = m_1 \otimes (m_2 \otimes m_3) = m_1 \otimes m_2 \otimes m_3\)</span></li>
</ul>
<p>If we define the functor <span class="math inline">\(F\)</span> as summarizing a data subset via a monoidal summary statistic, then this will behave exactly as we want. Specifically, define the functor <span class="math inline">\(F\)</span> as summarizing or “folding” some data subset by repeatedly applying the monoidal operation <span class="math inline">\(\otimes\)</span>. For example:</p>
<p><span class="math inline">\(F(A) = F(\{a_1 , a_2, a_3 , \ldots \}) = a_1 \otimes a_2 \otimes a_3 \otimes \ldots\)</span></p>
<p>(we could have written this as <span class="math inline">\(F(A) = (((a_1 \otimes a_2) \otimes a_3) \otimes \ldots)\)</span>, however, thanks to associativity, brackets do not matter)</p>
<p>Then:</p>
<span class="math display">\[\begin{aligned}

F(A) \otimes F(B) &amp;= (a_1 \otimes a_2 \otimes a_3 \otimes \ldots) \otimes (b_1 \otimes b_2 \otimes b_3 \otimes \ldots) \\
&amp;= a_1 \otimes a_2 \otimes a_3 \otimes \ldots \otimes b_1 \otimes b_2 \otimes b_3 \otimes \ldots \\
&amp;= F(A \cup B)

\end{aligned}\]</span>
<p>Also, if we define the summary of an empty set as <span class="math inline">\(F(\varnothing) = e\)</span>, the monoidal unit, then:</p>
<p><span class="math display">\[F(A \cup \varnothing) = F(A) \otimes F(\varnothing) = F(A) \otimes e = F(A) \]</span></p>
<p>A typical example of a monoid is the summation of real numbers <span class="math inline">\((\mathbb{R}, 0, +)\)</span> (which we are familiar with as the “default” summary statistic in a typical barplot). Another example is the product of real numbers: <span class="math inline">\((\mathbb{R}, 1, \cdot)\)</span>, or maximum of real numbers <span class="math inline">\((\mathbb{R}, \max, -\infty)\)</span>.</p>
</div>
<div id="transforming-summaries" class="section level4 hasAnchor" number="4.3.2.5">
<h4><span class="header-section-number">4.3.2.5</span> Transforming summaries<a href="problems.html#transforming-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
</div>
<div id="scaling" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Scaling<a href="problems.html#scaling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we have partitioned our data and computed all relevant summary statistics. Now we need a way to to encode these summaries into visual attributes that we can then present on the computer screen. In most data visualization systems, this is done by specialized components called scales or coordinate systems <span class="citation">(see e.g. <a href="#ref-murrell2005">Murrell 2005</a>; <a href="#ref-wickham2016">Wickham 2016</a>; <a href="#ref-wilkinson2012">Wilkinson 2012</a>; <a href="#ref-petricek2020">Petricek 2020</a>)</span>.</p>
<p>As discussed in Sections <a href="litreview.html#scales-measurement">3.3.3</a> and <a href="litreview.html#visual-perception">3.3.2</a>, there exists is a fair amount of literature on the theoretical properties of scales and their relationship to the mechanisms of visual perception <span class="citation">(see e.g. <a href="#ref-krzywinski2013">Krzywinski 2013</a>; <a href="#ref-michell1986">Michell 1986</a>; <a href="#ref-wilkinson2012">Wilkinson 2012</a>; <a href="#ref-stevens1946">Stevens 1946</a>)</span>. However, when it comes to applying this knowledge and implementing scales in concrete data visualization systems, few research papers are available, and most only discuss the problem in vague, abstract terms <span class="citation">(for some rare counter-examples, see e.g. <a href="#ref-murrell2005">Murrell 2005</a>; <a href="#ref-ziemkiewicz2009">Ziemkiewicz and Kosara 2009</a>)</span>. To learn about how to actually implement scales scales, one has to go digging through open-source code repositories, which are rarely the most concise educational resources.</p>
<p>This gap between theory and practice is quite unfortunate in my opinion, since scales are an integral part of the data visualization pipeline. Further, they are the foundation of many interactive features, such as zooming, panning, and reordering. Finally, within existing data visualization systems, it is often the case that a large portion of the code is dedicated to scales. For instance, within the <code>ggplot2</code> codebase, the file containing the definition of the <code>Scale</code> class has the greatest number of lines, by quite a significant margin <span class="citation">(as of 4th of December 2024, <a href="#ref-ggplot2repo2024">Wickham 2024</a>)</span>, see Figure <a href="problems.html#fig:ggplot2-linecounts">4.23</a>:</p>
<div class="figure"><span style="display:block;" id="fig:ggplot2-linecounts"></span>
<img src="figures/ggplot2-linecounts.png" alt="The top 10 longest source files within the `ggplot2` codebase. Notice that `scale-.R` files contains significantly more lines than the other files." width="750" />
<p class="caption">
Figure 4.23: The top 10 longest source files within the <code>ggplot2</code> codebase. Notice that <code>scale-.R</code> files contains significantly more lines than the other files.
</p>
</div>
<p>For the reasons outlined above, I believe it is important to discuss the issue of applied scaling in more depth. The information here is based largely on how scales have been implemented in existing data visualization codebases, such as the <code>ggplot2</code>package <span class="citation">(<a href="#ref-wickham2016">Wickham 2016</a>)</span> or <code>d3-scale</code> module of D3 <span class="citation">(<a href="#ref-d3-scale2024">Observable 2024</a>; used also by e.g. Vega <a href="#ref-satyanarayan2015">Satyanarayan et al. 2015</a>)</span>, as well as on personal insights gained while implementing my package.</p>
<div id="scales-as-functions" class="section level4 hasAnchor" number="4.4.0.1">
<h4><span class="header-section-number">4.4.0.1</span> Scales as functions<a href="problems.html#scales-as-functions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>From a high-level perspective, a scale is just a function <span class="math inline">\(s: D \to V\)</span> which maps data values <span class="math inline">\(d \in D\)</span> to values of some visual attribute <span class="math inline">\(v \in V\)</span>, such as the x- and y-position, length, area, radius, or color <span class="citation">(<a href="#ref-wilkinson2012">Wilkinson 2012</a>; <a href="#ref-petricek2020">Petricek 2020</a>)</span>. This function may or may not be invertible, such that, at times, each value of the visual attribute may be uniquely identifiable with a single data value, or not.</p>
<p>One of the most common examples of a scale is a function where both <span class="math inline">\(D\)</span> and <span class="math inline">\(V\)</span> are subsets of the real numbers:</p>
<p><span class="math display">\[s: [d_{min}, d_{max}] \to [v_{min}, v_{max}] \qquad d_{min}, d_{max}, v_{min}, v_{max} \in \mathbb{R}\]</span></p>
<p>For example, suppose our data takes values in the range from 1 to 10 and we want to plot it along the x-axis, within a 800 pixels wide plotting region. Then, our scale is simply:</p>
<p><span class="math display">\[s_x: [1, 10] \to [0, 800]\]</span></p>
<p>Now, there is an infinite number of functions that fit this signature. However, one particularly nice and simple candidate is the following function:</p>
<div class="definition">
<p><span id="def:linear-mapping" class="definition"><strong>Definition 4.3  (Simple linear mapping) </strong></span><span class="math display">\[s(d) = v_{min} + \frac{d - d_{min}}{d_{max} - d_{min}} \cdot (v_{max} - v_{min})\]</span></p>
</div>
<p>if we substitute our concrete values into the formula, this becomes:</p>
<p><span class="math display">\[s_x(d) = 0 + \frac{d - 1}{10 - 1} \cdot (800 - 0) = [(d - 1) / 9] \cdot 800\]</span></p>
<p>The function acts on the data in the following way:</p>
<ul>
<li><span class="math inline">\(s_x(1) = (1 - 1) / 9 \cdot 800 = 0\)</span></li>
<li><span class="math inline">\(s_x(10) = (10 - 1) / 9 \cdot 800 = 800\)</span></li>
<li><span class="math inline">\(s_x(d) \in [0, 800]\)</span> for any <span class="math inline">\(d \in [1, 10]\)</span></li>
</ul>
<p>That is, the function maps the data value 1 to pixel 0 (left border of the plotting region), value 10 to to pixel 800 (right border of the plotting region), and any value in between 1 and 10 inside the interval 0 to 800, proportionally to where in the data range it is located.</p>
</div>
<div id="simple-scale-limits" class="section level4 hasAnchor" number="4.4.0.2">
<h4><span class="header-section-number">4.4.0.2</span> Limits of modeling scales with simple functions<a href="problems.html#simple-scale-limits" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Simple linear maps like the one above can work fine for basic data visualization systems. However, once we begin to add more features, this design can become prohibitive. Consider, for example, what happens if we want to:</p>
<ul>
<li>Expand the scale limits</li>
<li>Scale discrete data</li>
<li>Apply non-linear transformations</li>
<li>Pan, zoom, reverse, reorder, or otherwise modify the scale interactively</li>
</ul>
<p>Having a single function with hard-coded values makes these operations difficult. Let’s take the first point in the list above as a motivating example. Consider what happens to data points at the limits of the data range under the simple linear mapping:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="problems.html#cb12-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb12-2"><a href="problems.html#cb12-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb12-3"><a href="problems.html#cb12-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb12-4"><a href="problems.html#cb12-4" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="st">&quot;indianred&quot;</span>, <span class="st">&quot;grey80&quot;</span>)</span>
<span id="cb12-5"><a href="problems.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="problems.html#cb12-6" tabindex="-1"></a><span class="co"># xaxs = &quot;i&quot; makes sure the x-axis limits match the data range exactly</span></span>
<span id="cb12-7"><a href="problems.html#cb12-7" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">col =</span> col, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="800px" style="display: block; margin: auto;" /></p>
<p>The plot above shows values scaled using the simple linear mapping along the x-axis, that is, <span class="math inline">\(s: [1, 10] \to [0, 800]\)</span> (effect of the <code>xaxs = "i"</code> argument). Notice that, since the positions of the points representing the values 1 and 10 (highlighted in red) get mapped to pixel values 0 and 800 (the left and right border of the plot), only half of each point is visible. This is problematic: as was discussed in Section <a href="problems.html#show-all-data">4.2.1</a>, a fundamental principles of graphical integrity is that our graphics should not downplay or hide certain features of the data <span class="citation">(<a href="#ref-tufte2001">Tufte 2001</a>)</span>. Since the points near the axis limits are represented by only 1/2 of the area, they become less visually salient, and this is particularly problematic since these points are more likely to be outliers.</p>
<p>To address this problem, most data visualization systems automatically expand the range of the domain by some pre-specified percentage:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="problems.html#cb13-1" tabindex="-1"></a><span class="co"># By default, the base R plot() function automatically expands the x- and y-axis</span></span>
<span id="cb13-2"><a href="problems.html#cb13-2" tabindex="-1"></a><span class="co"># limits by approximately 4% on each end, see `xaxs` in ?graphics::par</span></span>
<span id="cb13-3"><a href="problems.html#cb13-3" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">col =</span> col, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="800px" style="display: block; margin: auto;" /></p>
<p>We could achieve this by expanding our data range by some hard-coded percentage, for example, a symmetric 10% margin on each side:</p>
<p><span class="math display" id="eq:margins">\[\begin{equation}

  s(d) = v_{min} + \bigg[ 0.1 + \frac{d - d_{min}}{d_{max} - d_{min}} \cdot 0.8
            \bigg] \cdot (v_{max} - v_{min})
  \tag{4.1}

\end{equation}\]</span></p>
<p>However, this design becomes prohibitive as more features are added. For example, if we want to map some discrete data values to the same visual attribute codomain <span class="math inline">\(V\)</span>, do we have to design an entirely new mapping function? Similarly, what if we want to apply a different margin on each side, shift both margins by an equal amount, or flip the scale’s direction? It would be useful if there were some way to abstract out the data domain <span class="math inline">\(D\)</span> and the visual attribute <span class="math inline">\(V\)</span>, such that we could apply some common operations to the scale regardless of its specific implementation.</p>
</div>
<div id="scales-composition" class="section level4 hasAnchor" number="4.4.0.3">
<h4><span class="header-section-number">4.4.0.3</span> Solution: Scales as function composition<a href="problems.html#scales-composition" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The linear mapping formula in Equation <a href="problems.html#eq:margins">(4.1)</a> can guide us in decomposing the scale function into smaller, more manageable parts. Let’s look at it again:</p>
<p><span class="math display">\[  s(d) = v_{min} + \bigg[ 0.1 + \frac{d - d_{min}}{d_{max} - d_{min}} \cdot 0.8
            \bigg] \cdot (v_{max} - v_{min}) \]</span></p>
<p>If we look closely, we may be able to see that the function can be split into three parts:</p>
<p><span class="math display">\[s(d) = \color{steelblue}{v_{min} +} \bigg[ \color{seagreen}{0.1 +} \color{indianred}{\frac{\color{black}{d} - d_{min}}{d_{max} - d_{min}}} \color{seagreen}{\cdot 0.8} \bigg] \color{steelblue}{\cdot (v_{max} - v_{min})}\]</span></p>
<p>That is, the linear mapping can be interpreted as a composition of three simpler functions:</p>
<ul>
<li><span class="math inline">\(\color{indianred}{n(d) = (d - d_{min}) / (d_{max} - d_{min})}\)</span> takes a data value <span class="math inline">\(d \in D\)</span> and maps it to the interval <span class="math inline">\([0, 1]\)</span><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></li>
<li><span class="math inline">\(\color{seagreen}{r(p) = 0.1 + p \cdot 0.8}\)</span> takes a value in <span class="math inline">\([0, 1]\)</span> and maps it elsewhere in <span class="math inline">\([0, 1]\)</span></li>
<li><span class="math inline">\(\color{steelblue}{u(p) = v_{min} + p \cdot (v_{max} - v_{min})}\)</span> takes a value in <span class="math inline">\([0, 1]\)</span> and maps it to a visual attribute value <span class="math inline">\(v \in V\)</span></li>
</ul>
<p>In other words, instead of thinking of scale as mapping from <span class="math inline">\(D\)</span> to <span class="math inline">\(V\)</span> directly, we explicitly for</p>
<p>This leads us to the following definition of a scale:</p>
<div class="definition">
<p><span id="def:scale" class="definition"><strong>Definition 4.4  (Scale as function composition) </strong></span>A scale <span class="math inline">\(s: D \to V\)</span> can be created by composing:</p>
<ul>
<li>A <em>data normalizing</em> function <span class="math inline">\(n_D: D \to \mathbb{R}\)</span>, mapping data values to the real numbers <span class="math inline">\(\mathbb{R}\)</span></li>
<li>A linear <em>rescale</em> function <span class="math inline">\(r_{\mathbb{R}}: \mathbb{R} \to \mathbb{R}\)</span></li>
<li>An <em>visual attribute unnormalizing</em> function <span class="math inline">\(u_V: \mathbb{R} \to V\)</span>, mapping real numbers to the visual attribute codomain</li>
</ul>
<p>Such that:</p>
<p><span class="math display">\[s = u_V \circ r_{\mathbb{R}} \circ n_D\]</span>
Or, more explicitly:</p>
<p><span class="math display">\[s(d) = u_V(r_{\mathbb{R}}(n_D(d)))\]</span></p>
<p>Further, the normalize and unnormalize functions may at times have inverses (or retractions) such that, e.g. <span class="math inline">\((n_D)^{-1} = u_D: \mathbb{R} \to D\)</span> and <span class="math inline">\((u_V)^{-1} = n_V: V \to \mathbb{R}\)</span>. These functions reverse the effect of their counterparts, such that <span class="math inline">\(u_D \circ n_D = n_V \circ u_V = \text{id}\)</span>, the identity function. If both <span class="math inline">\(u_D\)</span> and <span class="math inline">\(n_V\)</span> exist, then we can define the inverse scale function:</p>
<p><span class="math display">\[s^{-1}(v) = u_D(r_{\mathbb{R}}^{-1}(n_V(v)))\]</span></p>
</div>
<p>(the rescale function always has an inverse, since it is just a simple linear map of the form <span class="math inline">\(y = ax + b\)</span>)</p>
<p>That concludes the high-level conceptual overview of this scale model. However, several points warrant further discussion.</p>
<div id="the-extended-unit-interval" class="section level5 hasAnchor" number="4.4.0.3.1">
<h5><span class="header-section-number">4.4.0.3.1</span> The extended unit interval<a href="problems.html#the-extended-unit-interval" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>First, note that I described the functions as <span class="math inline">\(n_D: D \to \mathbb{R}\)</span> and <span class="math inline">\(u_V: \mathbb{R} \to V\)</span>, i.e. I identified the intermediate domain as <span class="math inline">\(\mathbb{R}\)</span>. However, provided that <span class="math inline">\(d\)</span> falls in some <em>typical</em> subset of data values (such as <span class="math inline">\([d_{\min}, d_{\max}]\)</span> for continuous <span class="math inline">\(D\)</span>), <span class="math inline">\(n_D\)</span> should <em>generally</em> return values in the unit interval <span class="math inline">\([0, 1]\)</span> (and, conversely, <span class="math inline">\(u_V\)</span> should map values in <span class="math inline">\([0, 1]\)</span> to typical values of the visual attribute). The reason why I define the intermediate domain as <span class="math inline">\(\mathbb{R}\)</span> instead of strictly <span class="math inline">\([0, 1]\)</span> is to accommodate “unusual” (emphasis on the quotation marks) data or visual attribute values.</p>
<p>For instance, suppose we zoom into a region of a scatterplot and there is a point with its center just outside of the new plot limits. If the point’s radius is greater than the distance of its center to the plot border, a part of the point will still overlap the plotting region and we should render it, even though the x- and y- coordinates lie outside the data range. Therefore, we use <span class="math inline">\(\mathbb{R}\)</span> as the intermediate domain instead of <span class="math inline">\([0, 1]\)</span>, though we can conceptually think of it as an “extended” unit interval <span class="math inline">\([0, 1]\)</span>, that I will denote as <span class="math inline">\([0, 1]&#39;\)</span>.</p>
<p>The choice of <span class="math inline">\([0, 1]&#39;\)</span> is somewhat arbitrary - any interval <span class="math inline">\([a, b]\)</span> with <span class="math inline">\(a, b \in \mathbb{R}\)</span> will work - however, it offers a convenient interpretation. Specifically, values <span class="math inline">\(p \in [0, 1]&#39;\)</span> can be interpreted as percentages: for example, <span class="math inline">\(n_D(d) = 0.5\)</span> indicates data value is at the 50th percentile of the data range, and should, therefore, be generally mapped to the middle of the visual attribute range (other factors that we will discuss later aside). Values outside of <span class="math inline">\([0, 1]\)</span> represent data values extending beyond the data range. For example, <span class="math inline">\(n_D(d) = 1.2\)</span> suggests that the data point lies 20% beyond the upper limit of the data range (provided that <span class="math inline">\(D\)</span> is continuous).</p>
<p>Finally, note that the terms <em>normalizing</em> and <em>unnormalizing</em> are also arbitrary, however, I believe they make for useful labels. We can interpret them as 1D equivalent of vector normalization, mapping a one-dimensional vector in <span class="math inline">\(D\)</span> to and from the extended unit interval <span class="math inline">\([0, 1]&#39;\)</span>.</p>
</div>
<div id="advantages" class="section level5 hasAnchor" number="4.4.0.3.2">
<h5><span class="header-section-number">4.4.0.3.2</span> Advantages<a href="problems.html#advantages" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>By expressing scales as the composition of two functions, we gain flexibility by having three adjustable components: the data domain <span class="math inline">\(D\)</span>, the visual attribute codomain <span class="math inline">\(V\)</span>, and the intermediate extended unit interval <span class="math inline">\([0, 1]&#39; \subset \mathbb{R}\)</span>. As we will see, we can do quite a lot by manipulating and combining these three components. However, going forward, I believe it will be a lot easier to explain these ideas with code examples, rather than through mathematical formulas. Still, I will refer back to the mathematical definition above so it is important to keep it in mind.</p>
</div>
</div>
<div id="proposed-model" class="section level4 hasAnchor" number="4.4.0.4">
<h4><span class="header-section-number">4.4.0.4</span> A high-level model of scale implementation<a href="problems.html#proposed-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To implement scales, we need to translate abstract mathematical objects such as sets <span class="math inline">\(D\)</span>, <span class="math inline">\(V\)</span> and <span class="math inline">\([0, 1]&#39;\)</span> and mappings <span class="math inline">\(n_D\)</span> and <span class="math inline">\(u_V\)</span> to concrete programming constructs. In this section, I will briefly sketch out a high-level model of scales, as implemented in my package, simple TypeScript code (I use TypeScript instead of R because TypeScript’s static typing is particularly useful for explaining some of the concepts here). Further, it’s worth noting that this model of scales can be implemented in many different ways, depending on the programming paradigm. For instance, in the traditional object-oriented programming style (OOP), someone might design a <code>Scale</code> class and then instantiate it as a “smart” object with methods. Personally, I prefer the style of using independent types, data containers, and free functions. This is the style that I used while writing my package and so I will also use it here.</p>
<p>First, we want some kind of object to describe a scale. Based on Definition [REFERENCE], a scale has to primarily incorporate two objects: the data <em>domain</em> and the visual attribute <em>codomain</em>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb14-1"><a href="problems.html#cb14-1" tabindex="-1"></a><span class="kw">interface</span> Scale<span class="op">&lt;</span>D <span class="kw">extends</span> Expanse<span class="op">,</span> V <span class="kw">extends</span> Expanse<span class="op">&gt;</span> {</span>
<span id="cb14-2"><a href="problems.html#cb14-2" tabindex="-1"></a>  domain<span class="op">:</span> D</span>
<span id="cb14-3"><a href="problems.html#cb14-3" tabindex="-1"></a>  codomain<span class="op">:</span> V </span>
<span id="cb14-4"><a href="problems.html#cb14-4" tabindex="-1"></a>}</span></code></pre></div>
<p>The angle brackets indicate generic type parameters. Specifically, <code>D</code> and <code>V</code> are type parameters which extend the <code>Expanse</code> type, and signify the type of the domain and codomain of the scale, respectively. I will explain the <code>Expanse</code> type below in more detail, however, for now, <code>D</code> could be, for example, a continuous expanse, corresponding to a <span class="math inline">\(D = [d_{\max}, d_{\min}]\)</span> for some <span class="math inline">\(d_{\min}, d_{\max} \in \mathbb{R}\)</span>.</p>
<p>The primary use of a scale is to “push” values forward, first through its domain and second through its codomain, or “pull” them back, first through its codomain and second through its domain. We can describe this via the following two function signatures:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb15-1"><a href="problems.html#cb15-1" tabindex="-1"></a><span class="kw">function</span> <span class="fu">pushforward</span><span class="op">&lt;</span>D <span class="kw">extends</span> Expanse<span class="op">,</span> V <span class="kw">extends</span> Expanse<span class="op">&gt;</span>(scale<span class="op">:</span> Scale<span class="op">&lt;</span>D<span class="op">,</span> V<span class="op">&gt;,</span> value<span class="op">:</span> D[<span class="st">&quot;value_type&quot;</span>])<span class="op">:</span> V[<span class="st">&quot;value_type&quot;</span>]</span>
<span id="cb15-2"><a href="problems.html#cb15-2" tabindex="-1"></a><span class="kw">function</span> <span class="fu">pullback</span><span class="op">&lt;</span>D <span class="kw">extends</span> Expanse<span class="op">,</span> V <span class="kw">extends</span> Expanse<span class="op">&gt;</span>(scale<span class="op">:</span> Scale<span class="op">&lt;</span>D<span class="op">,</span> V<span class="op">&gt;,</span> value<span class="op">:</span> V[<span class="st">&quot;value_type&quot;</span>])<span class="op">:</span> D[<span class="st">&quot;value_type&quot;</span>]</span></code></pre></div>
<p>The function signatures are fairly long because of the generic type parameters, however, they are actually very simple. The <code>pushforward</code> function simply takes a scale and a value that matches the scale’s <code>domain</code> (the <code>D["value_type"]</code> refers to an opaque property access returns the type of values that <code>domain</code> operates on) and returns values in the scales <code>codomain</code>. Conversely, the <code>pullback</code> function simply takes a scale and a value in its <code>codomain</code>, and translates it to the scale’s <code>domain</code>.</p>
<p>Now it is type to discuss <code>Expanse</code>. The <code>Expanse</code> supertype is actually very simple, even simpler than that of a <code>Scale</code>. It only has a single property, indicating the value type it operates on:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb16-1"><a href="problems.html#cb16-1" tabindex="-1"></a><span class="kw">interface</span> Expanse {</span>
<span id="cb16-2"><a href="problems.html#cb16-2" tabindex="-1"></a>  value_type<span class="op">:</span> <span class="dt">unknown</span></span>
<span id="cb16-3"><a href="problems.html#cb16-3" tabindex="-1"></a>  <span class="co">// ^ Here, I use TypeScript&#39;s `unknown` type to indicate that `value_type` </span></span>
<span id="cb16-4"><a href="problems.html#cb16-4" tabindex="-1"></a>  <span class="co">// could be anything. In practice, most of the time, this will be</span></span>
<span id="cb16-5"><a href="problems.html#cb16-5" tabindex="-1"></a>  <span class="co">// either `string` or `number`.</span></span>
<span id="cb16-6"><a href="problems.html#cb16-6" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>Expanse</code> type is defined by the following two function signatures:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb17-1"><a href="problems.html#cb17-1" tabindex="-1"></a><span class="kw">function</span> <span class="fu">normalize</span><span class="op">&lt;</span>T <span class="kw">extends</span> Expanse<span class="op">&gt;</span>(expanse<span class="op">:</span> T<span class="op">,</span> value<span class="op">:</span> T[<span class="st">&quot;value_type&quot;</span>])<span class="op">:</span> <span class="dt">number</span></span>
<span id="cb17-2"><a href="problems.html#cb17-2" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unnormalize</span><span class="op">&lt;</span>T <span class="kw">extends</span> Expanse<span class="op">&gt;</span>(expanse<span class="op">:</span> T<span class="op">,</span> value<span class="op">:</span> <span class="dt">number</span>)<span class="op">:</span> T[<span class="st">&quot;value_type&quot;</span>]</span></code></pre></div>
<p>These correspond to the <span class="math inline">\(n_{\cdot}\)</span> and <span class="math inline">\(u_{\cdot}\)</span> functions above. Specifically, the <code>normalize</code> function takes in an expanse and a value that the expanse operates on (<code>T["value_type"]</code>) and converts it to a number (i.e. <span class="math inline">\(p \in [0, 1]&#39; = \mathbb{R}\)</span>), whereas the <code>unnormalize</code> function takes in an expanse and a number and converts it to the expanse’s value type. Generally, these functions should be inverses of each other, or at least retractions, such that <code>unnormalize(exp, normalize(exp, x)) == x</code> and <code>normalize(exp, unnormalize(exp, p)) == p</code>.</p>
<p>As polymorphic functions, <code>normalize</code> and <code>unnormalize</code> could be implemented as methods bound to specific <code>Expanse</code> subtype, an overloaded functions with dynamic dispatch, or even via a simple switch statement. The specific approach really does not matter. The important point is that we can use <code>Expanse</code> subtypes for converting between values and numbers. Therefore, the <code>domain</code> and <code>codomain</code> actually do the majority of the work of a scale. For instance, with a bit of hand-waving that we will clarify later, we can implement a simplified version of the <code>pushforward</code> function as:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb18-1"><a href="problems.html#cb18-1" tabindex="-1"></a><span class="kw">function</span> <span class="fu">pushforward</span><span class="op">&lt;</span>D <span class="kw">extends</span> Expanse<span class="op">,</span> V <span class="kw">extends</span> Expanse<span class="op">&gt;</span>(scale<span class="op">:</span> Scale<span class="op">&lt;</span>D<span class="op">,</span> V<span class="op">&gt;,</span> value<span class="op">:</span> D[<span class="st">&quot;value_type&quot;</span>]) {</span>
<span id="cb18-2"><a href="problems.html#cb18-2" tabindex="-1"></a>  <span class="kw">const</span> { domain<span class="op">,</span> codomain } <span class="op">=</span> scale</span>
<span id="cb18-3"><a href="problems.html#cb18-3" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">unnormalize</span>(codomain<span class="op">,</span> <span class="fu">normalize</span>(domain<span class="op">,</span> value))</span>
<span id="cb18-4"><a href="problems.html#cb18-4" tabindex="-1"></a>  <span class="co">// ^ Or `return codomain.unnormalize(domain.normalize(value))`, in traditional OOP style</span></span>
<span id="cb18-5"><a href="problems.html#cb18-5" tabindex="-1"></a>}</span></code></pre></div>
<p>The simplified implementation of the <code>pushforward</code> function is almost identical, except that the order of <code>domain</code> and <code>codomain</code> is reversed.</p>
<p>So, to summarize, a <code>Scale</code> object has two important properties - <code>domain</code> and <code>codomain</code> - which are both of subtypes of type <code>Expanse</code>, and, in fact, the majority of actual work is done with/by these objects. As such, we should discuss the <code>Expanse</code> subtypes next. However, before we go on to do that, we should compare the implementation outlined above to other implementations of scales in existing data visualization systems.</p>
</div>
<div id="comparison-to-past-implementations-of-scales" class="section level4 hasAnchor" number="4.4.0.5">
<h4><span class="header-section-number">4.4.0.5</span> Comparison to past implementations of scales<a href="problems.html#comparison-to-past-implementations-of-scales" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Many popular data visualization systems implement a two-component model of scales similar to the one outlined in the previous section. For example, in <code>D3</code> <span class="citation">(<a href="#ref-bostock2011">Bostock, Ogievetsky, and Heer 2011</a>)</span>, scales are implemented in a functional style, such that the data domain and the visual attribute codomain are passed as tuples or arrays of values to a higher-order <code>scale*</code> function (such as <code>scaleLinear</code>, <code>scalePoint</code>, or <code>scaleBand</code>), which then returns a new function that can be used for scaling. The domain and codomain can also be modified afterwards, using the <code>scale*.domain</code> and <code>scale*.range</code> methods respectively (JavaScript functions are objects and can have other functions/methods attached to them).</p>
<p>For illustration, here are few examples from the official documentation <span class="citation">(<a href="#ref-d3-scale2024">Observable 2024</a>)</span>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode ts"><code class="sourceCode typescript"><span id="cb19-1"><a href="problems.html#cb19-1" tabindex="-1"></a><span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">130</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">960</span>])<span class="op">;</span></span>
<span id="cb19-2"><a href="problems.html#cb19-2" tabindex="-1"></a><span class="fu">x</span>(<span class="dv">20</span>)<span class="op">;</span> <span class="co">// 80</span></span>
<span id="cb19-3"><a href="problems.html#cb19-3" tabindex="-1"></a><span class="kw">const</span> color <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>]<span class="op">,</span> [<span class="st">&quot;brown&quot;</span><span class="op">,</span> <span class="st">&quot;steelblue&quot;</span>])<span class="op">;</span></span>
<span id="cb19-4"><a href="problems.html#cb19-4" tabindex="-1"></a><span class="fu">color</span>(<span class="dv">20</span>)<span class="op">;</span> <span class="co">// &quot;rgb(154, 52, 57)&quot;</span></span>
<span id="cb19-5"><a href="problems.html#cb19-5" tabindex="-1"></a><span class="co">// The domain and codomain can be changed after initialization</span></span>
<span id="cb19-6"><a href="problems.html#cb19-6" tabindex="-1"></a><span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">domain</span>([<span class="dv">10</span><span class="op">,</span> <span class="dv">130</span>])<span class="op">;</span> </span></code></pre></div>
<p>Internally, the <code>scale*</code> functions rely on other specialized functions to translate from its domain to the codomain (such as the <code>normalize()</code> and <code>scale()</code> functions for continuous and discrete/ordinal domains, respectively, and various <code>interpolate()</code> functions for codomains).</p>
<p>Similarly, in <code>ggplot2</code> <span class="citation">(<a href="#ref-wickham2016">Wickham 2016</a>)</span>, all scales inherit from the <code>Scale</code> base class, with each subtype implementing <code>limits</code> and <code>palette</code> properties. The <code>limits</code> property is a vector which corresponds to the data domain and the <code>palette</code> property is a function which corresponds roughly to the visual codomain (the x- and y-position behave slightly differently, due to being transformed via coordinate systems). Internally, the package uses the <code>rescale</code> function from the <code>scales</code> package <span class="citation">(<a href="#ref-wickham2023">Wickham, Pedersen, and Seidel 2023</a>)</span> to map data values to <span class="math inline">\([0, 1]\)</span> and then the <code>palette</code> function is responsible for mapping these normalized values to the visual attribute. For illustration, here’s the full definition of the <code>map</code> method on the <code>ScaleContinuous</code> class (I’ve added comments for clarity):</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="problems.html#cb20-1" tabindex="-1"></a>map <span class="ot">=</span> <span class="cf">function</span>(self, x, <span class="at">limits =</span> self<span class="sc">$</span><span class="fu">get_limits</span>()) {</span>
<span id="cb20-2"><a href="problems.html#cb20-2" tabindex="-1"></a>  <span class="co"># Limits are just a tuple, rescale maps x to [0, 1]</span></span>
<span id="cb20-3"><a href="problems.html#cb20-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> self<span class="sc">$</span><span class="fu">rescale</span>(self<span class="sc">$</span><span class="fu">oob</span>(x, <span class="at">range =</span> limits), limits) </span>
<span id="cb20-4"><a href="problems.html#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="problems.html#cb20-5" tabindex="-1"></a>  uniq <span class="ot">&lt;-</span> <span class="fu">unique0</span>(x)</span>
<span id="cb20-6"><a href="problems.html#cb20-6" tabindex="-1"></a>  <span class="co"># Palette is a function which returns a vector of attribute values</span></span>
<span id="cb20-7"><a href="problems.html#cb20-7" tabindex="-1"></a>  pal <span class="ot">&lt;-</span> self<span class="sc">$</span><span class="fu">palette</span>(uniq) </span>
<span id="cb20-8"><a href="problems.html#cb20-8" tabindex="-1"></a>  scaled <span class="ot">&lt;-</span> pal[<span class="fu">match</span>(x, uniq)]</span>
<span id="cb20-9"><a href="problems.html#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="problems.html#cb20-10" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(scaled), scaled, self<span class="sc">$</span>na.value)</span>
<span id="cb20-11"><a href="problems.html#cb20-11" tabindex="-1"></a>}</span></code></pre></div>
<p>However, an key difference between the models of scales discussed above, and the proposed model discussed in Section <a href="problems.html#proposed-model">4.4.0.4</a> is that, in both <code>D3</code> and <code>ggplot2</code>, the domain and codomain are of different types. Consequently, the packages’ equivalents of the <code>normalize</code> and <code>unnormalize</code> functions have completely different implementations. In <code>D3</code>, internally, the functions used to translate from <span class="math inline">\(D \to [0, 1]&#39;\)</span> are fundamentally different from those used to translate from <span class="math inline">\([0, 1]&#39; \to V\)</span>. This difference is even more pronounced in <code>ggplot2</code>, where <code>limits</code> is a simple vector/tuple whereas <code>palette</code> is a function.</p>
<p>I contend that having two separate types for the domain and codomain has several disadvantages. First, it impedes code reuse, since we cannot simply use the same object in either place. Second, it complicates the mental model: the user has to hold a completely different concept for the domain and codomain in their head. Finally, the models of scales outlined above are designed to work in only one direction: from the data to the visual attribute. To go the other way around, from the visual attribute to the data, other, specialized functions have to be implemented.</p>
<p>Instead, I propose a unified model where the domain and codomain differ only in the context they are used. This greatly simplifies code reuse and the mental model, as the same <code>Expanse</code> subtype can serve as either. Moreover, if the domain and codomain implement both <code>normalize</code> and <code>unnormalize</code> functions, constructing the inverse scale function is trivial. There are also several other advantages, which I will discuss in the following sections.</p>
</div>
<div id="implementing-margins-zooming-and-panning" class="section level4 hasAnchor" number="4.4.0.6">
<h4><span class="header-section-number">4.4.0.6</span> Implementing margins, zooming, and panning<a href="problems.html#implementing-margins-zooming-and-panning" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recall that, at the end of section <a href="problems.html#scales-composition">4.4.0.3</a>,</p>
</div>
<div id="scale-transformations" class="section level4 hasAnchor" number="4.4.0.7">
<h4><span class="header-section-number">4.4.0.7</span> Scale transformations<a href="problems.html#scale-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>“Transformation is a critical tool for visualization or for any other mode of data analysis
because it can substantially simplify the structure of a set of data.”</p>
<p><span class="citation">Cleveland (<a href="#ref-cleveland1993">1993</a>)</span>, pp. 48</p>
</blockquote>

</div>
</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-alsallakh2013" class="csl-entry">
Alsallakh, Bilal, Wolfgang Aigner, Silvia Miksch, and Helwig Hauser. 2013. <span>“Radial Sets: Interactive Visual Analysis of Large Overlapping Sets.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 19 (12): 2496–2505.
</div>
<div id="ref-alsallakh2014" class="csl-entry">
Alsallakh, Bilal, Luana Micallef, Wolfgang Aigner, Helwig Hauser, Silvia Miksch, and Peter Rodgers. 2014. <span>“Visualizing Sets and Set-Typed Data: State-of-the-Art and Future Challenges.”</span> <em>Eurographics Conference on Visualization (EuroVis)</em>.
</div>
<div id="ref-bertin1983" class="csl-entry">
Bertin, Jacques. 1983. <em>Semiology of Graphics</em>. University of Wisconsin press.
</div>
<div id="ref-bostock2011" class="csl-entry">
Bostock, Michael, Vadim Ogievetsky, and Jeffrey Heer. 2011. <span>“D<span class="math inline">\(^3\)</span> Data-Driven Documents.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 17 (12): 2301–9.
</div>
<div id="ref-buja1996" class="csl-entry">
Buja, Andreas, Dianne Cook, and Deborah F Swayne. 1996. <span>“Interactive High-Dimensional Data Visualization.”</span> <em>Journal of Computational and Graphical Statistics</em> 5 (1): 78–99.
</div>
<div id="ref-byron2008" class="csl-entry">
Byron, Lee, and Martin Wattenberg. 2008. <span>“Stacked Graphs–Geometry &amp; Aesthetics.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 14 (6): 1245–52.
</div>
<div id="ref-cairo2014" class="csl-entry">
Cairo, Alberto. 2014. <span>“Graphics Lies, Misleading Visuals: Reflections on the Challenges and Pitfalls of Evidence-Driven Visual Communication.”</span> In <em>New Challenges for Data Design</em>, 103–16. Springer.
</div>
<div id="ref-cairo2016" class="csl-entry">
———. 2016. <em>The Truthful Art: Data, Charts, and Maps for Communication</em>. New Riders.
</div>
<div id="ref-cairo2019" class="csl-entry">
———. 2019. <em>How Charts Lie: Getting Smarter about Visual Information</em>. WW Norton &amp; Company.
</div>
<div id="ref-chen2008" class="csl-entry">
Chen, Chun-houh, Wolfgang Karl Härdle, and Antony Unwin. 2008. <em>Handbook of Data Visualization</em>. Springer Science &amp; Business Media.
</div>
<div id="ref-chi2000" class="csl-entry">
Chi, Ed Huai-hsin. 2000. <span>“A Taxonomy of Visualization Techniques Using the Data State Reference Model.”</span> In <em>IEEE Symposium on Information Visualization 2000. INFOVIS 2000. Proceedings</em>, 69–75. IEEE.
</div>
<div id="ref-cleveland1985" class="csl-entry">
Cleveland, William S. 1985. <em>The Elements of Graphing Data</em>. Wadsworth Publ. Co.
</div>
<div id="ref-cleveland1993" class="csl-entry">
———. 1993. <em>Visualizing Data</em>. Hobart press.
</div>
<div id="ref-cleveland1984" class="csl-entry">
Cleveland, William S, and Robert McGill. 1984. <span>“Graphical Perception: Theory, Experimentation, and Application to the Development of Graphical Methods.”</span> <em>Journal of the American Statistical Association</em> 79 (387): 531–54.
</div>
<div id="ref-conway2017" class="csl-entry">
Conway, Jake R, Alexander Lex, and Nils Gehlenborg. 2017. <span>“UpSetR: An r Package for the Visualization of Intersecting Sets and Their Properties.”</span> <em>Bioinformatics</em> 33 (18): 2938–40.
</div>
<div id="ref-dalal1989" class="csl-entry">
Dalal, Siddhartha R, Edward B Fowlkes, and Bruce Hoadley. 1989. <span>“Risk Analysis of the Space Shuttle: Pre-Challenger Prediction of Failure.”</span> <em>Journal of the American Statistical Association</em> 84 (408): 945–57.
</div>
<div id="ref-dastani2002" class="csl-entry">
Dastani, Mehdi. 2002. <span>“The Role of Visual Perception in Data Visualization.”</span> <em>Journal of Visual Languages &amp; Computing</em> 13 (6): 601–22.
</div>
<div id="ref-rmeta2024" class="csl-entry">
Data Science Meta. 2024. <span>“CRAN r Packages by Number of Downloads.”</span> <a href="https://www.datasciencemeta.com/rpackages">https://www.datasciencemeta.com/rpackages</a>.
</div>
<div id="ref-dimara2019" class="csl-entry">
Dimara, Evanthia, and Charles Perin. 2019. <span>“What Is Interaction for Data Visualization?”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 26 (1): 119–29.
</div>
<div id="ref-referendum2020" class="csl-entry">
Electoral Commission New Zealand. 2020. <span>“Official Referendum Results Released.”</span> <a href="https://elections.nz/media-and-news/2020/official-referendum-results-released">https://elections.nz/media-and-news/2020/official-referendum-results-released</a>.
</div>
<div id="ref-election2023" class="csl-entry">
———. 2023. <span>“E9 Statistics - Overall Results.”</span> <a href="https://www.electionresults.govt.nz/electionresults_2023/index.html">https://www.electionresults.govt.nz/electionresults_2023/index.html</a>.
</div>
<div id="ref-fong2019" class="csl-entry">
Fong, Brendan, and David I Spivak. 2019. <em>An Invitation to Applied Category Theory: Seven Sketches in Compositionality</em>. Cambridge University Press.
</div>
<div id="ref-franconeri2021" class="csl-entry">
Franconeri, Steven L, Lace M Padilla, Priti Shah, Jeffrey M Zacks, and Jessica Hullman. 2021. <span>“The Science of Visual Data Communication: What Works.”</span> <em>Psychological Science in the Public Interest</em> 22 (3): 110–61.
</div>
<div id="ref-franconeri2003" class="csl-entry">
Franconeri, Steven L, and Daniel J Simons. 2003. <span>“Moving and Looming Stimuli Capture Attention.”</span> <em>Perception &amp; Psychophysics</em> 65 (7): 999–1010.
</div>
<div id="ref-head2015" class="csl-entry">
Head, Megan L, Luke Holman, Rob Lanfear, Andrew T Kahn, and Michael D Jennions. 2015. <span>“The Extent and Consequences of p-Hacking in Science.”</span> <em>PLoS Biology</em> 13 (3): e1002106.
</div>
<div id="ref-heer2010" class="csl-entry">
Heer, Jeffrey, and Michael Bostock. 2010. <span>“Crowdsourcing Graphical Perception: Using Mechanical Turk to Assess Visualization Design.”</span> In <em>Proceedings of the SIGCHI Conference on Human Factors in Computing Systems</em>, 203–12.
</div>
<div id="ref-hellerstein1999" class="csl-entry">
Hellerstein, J. M., R. Avnur, A. Chou, C. Hidber, C. Olston, and V. Raman. 1999. <span>“<span class="nocase">Interactive data analysis: the Control project</span>.”</span> <em>Computer</em> 32 (8): 51–59. <a href="https://doi.org/10.1109/2.781635">https://doi.org/10.1109/2.781635</a>.
</div>
<div id="ref-kahn2005" class="csl-entry">
Kahn, Michael. 2005. <span>“An Exhalent Problem for Teaching Statistics.”</span> <em>Journal of Statistics Education</em> 13 (2).
</div>
<div id="ref-keim2002" class="csl-entry">
Keim, Daniel A. 2002. <span>“Information Visualization and Visual Data Mining.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 8 (1): 1–8.
</div>
<div id="ref-keller2024" class="csl-entry">
Keller, Mark S, Trevor Manz, and Nils Gehlenborg. 2024. <span>“Use-Coordination: Model, Grammar, and Library for Implementation of Coordinated Multiple Views.”</span> In <em>2024 IEEE Visualization and Visual Analytics (VIS)</em>, 166–70. IEEE.
</div>
<div id="ref-kerr1998" class="csl-entry">
Kerr, Norbert L. 1998. <span>“HARKing: Hypothesizing After the Results Are Known.”</span> <em>Personality and Social Psychology Review</em> 2 (3): 196–217.
</div>
<div id="ref-kim2022" class="csl-entry">
Kim, Hyeok, Ryan Rossi, Fan Du, Eunyee Koh, Shunan Guo, Jessica Hullman, and Jane Hoffswell. 2022. <span>“Cicero: A Declarative Grammar for Responsive Visualization.”</span> In <em>Proceedings of the 2022 CHI Conference on Human Factors in Computing Systems</em>, 1–15.
</div>
<div id="ref-kolmogorov2018" class="csl-entry">
Kolmogorov, Andrei Nikolaevich, and Albert T Bharucha-Reid. 2018. <em>Foundations of the Theory of Probability: Second English Edition</em>. Courier Dover Publications.
</div>
<div id="ref-kosara2016" class="csl-entry">
Kosara, Robert. 2016. <span>“Presentation-Oriented Visualization Techniques.”</span> <em>IEEE Computer Graphics and Applications</em> 36 (1): 80–85.
</div>
<div id="ref-krzywinski2013" class="csl-entry">
Krzywinski, Martin. 2013. <span>“Axes, Ticks and Grids.”</span> <em>Nature Methods</em> 10 (February): 183. <a href="https://doi.org/10.1038/nmeth.2337">https://doi.org/10.1038/nmeth.2337</a>.
</div>
<div id="ref-lawvere2009" class="csl-entry">
Lawvere, F William, and Stephen H Schanuel. 2009. <em>Conceptual Mathematics: A First Introduction to Categories</em>. Cambridge University Press.
</div>
<div id="ref-lex2014" class="csl-entry">
Lex, Alexander, Nils Gehlenborg, Hendrik Strobelt, Romain Vuillemot, and Hanspeter Pfister. 2014. <span>“UpSet: Visualization of Intersecting Sets.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 20 (12): 1983–92.
</div>
<div id="ref-lisnic2024" class="csl-entry">
Lisnic, Maxim, Zach Cutler, Marina Kogan, and Alexander Lex. 2024. <span>“Visualization Guardrails: Designing Interventions Against Cherry-Picking in Interactive Data Explorers.”</span> <a href="https://osf.io/preprints/osf/4j9nr">https://osf.io/preprints/osf/4j9nr</a>.
</div>
<div id="ref-mathematicalmathematics2024" class="csl-entry">
Martínez, Alejandro. 2024. <span>“Rustic OC Instead of Being Pr[o]du[c]tive.”</span> <a href="https://www.facebook.com/photo/?fbid=8191809750834143&amp;set=g.1567682496877142">https://www.facebook.com/photo/?fbid=8191809750834143&amp;set=g.1567682496877142</a>.
</div>
<div id="ref-mcdonald1990" class="csl-entry">
McDonald, John Alan, Werner Stuetzle, and Andreas Buja. 1990. <span>“Painting Multiple Views of Complex Objects.”</span> <em>ACM SIGPLAN Notices</em> 25 (10): 245–57.
</div>
<div id="ref-mcnutt2022" class="csl-entry">
McNutt, Andrew M. 2022. <span>“No Grammar to Rule Them All: A Survey of Json-Style Dsls for Visualization.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 29 (1): 160–70.
</div>
<div id="ref-michell1986" class="csl-entry">
Michell, Joel. 1986. <span>“Measurement Scales and Statistics: A Clash of Paradigms.”</span> <em>Psychological Bulletin</em> 100 (3): 398.
</div>
<div id="ref-murrell2005" class="csl-entry">
Murrell, Paul. 2005. <em>R Graphics</em>. Chapman; Hall/CRC.
</div>
<div id="ref-d3-scale2024" class="csl-entry">
Observable. 2024. <span>“D3-Scale <span><span class="math inline">\(\vert\)</span></span> D3 by Observable.”</span> <a href="https://d3js.org/d3-scale">https://d3js.org/d3-scale</a>.
</div>
<div id="ref-petricek2020" class="csl-entry">
Petricek, Tomas. 2020. <span>“Designing Composable Functional Libraries.”</span> <em>Lambda Days</em>. <a href="https://www.youtube.com/watch?v=G1Dp0NtQHeY">https://www.youtube.com/watch?v=G1Dp0NtQHeY</a>.
</div>
<div id="ref-quadri2021" class="csl-entry">
Quadri, Ghulam Jilani, and Paul Rosen. 2021. <span>“A Survey of Perception-Based Visualization Studies by Task.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em>.
</div>
<div id="ref-roberts2000" class="csl-entry">
Roberts, Jonathan C, Rob Knight, Mark Gibbins, and Nimesh Patel. 2000. <span>“Multiple Window Visualization on the Web Using VRML and the EAI.”</span> In <em>Proceedings of the Seventh UK VR-SIG Conference</em>, 149–57. SChEME.
</div>
<div id="ref-satyanarayan2016" class="csl-entry">
Satyanarayan, Arvind, Dominik Moritz, Kanit Wongsuphasawat, and Jeffrey Heer. 2016. <span>“Vega-Lite: A Grammar of Interactive Graphics.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 23 (1): 341–50.
</div>
<div id="ref-satyanarayan2015" class="csl-entry">
Satyanarayan, Arvind, Ryan Russell, Jane Hoffswell, and Jeffrey Heer. 2015. <span>“Reactive Vega: A Streaming Dataflow Architecture for Declarative Interactive Visualization.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 22 (1): 659–68.
</div>
<div id="ref-satyanarayan2014" class="csl-entry">
Satyanarayan, Arvind, Kanit Wongsuphasawat, and Jeffrey Heer. 2014. <span>“Declarative Interaction Design for Data Visualization.”</span> In <em>Proceedings of the 27th Annual ACM Symposium on User Interface Software and Technology</em>, 669–78.
</div>
<div id="ref-slingsby2009" class="csl-entry">
Slingsby, Aidan, Jason Dykes, and Jo Wood. 2009. <span>“Configuring Hierarchical Layouts to Address Research Questions.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 15 (6): 977–84.
</div>
<div id="ref-stevens1946" class="csl-entry">
Stevens, Stanley Smith. 1946. <span>“On the Theory of Scales of Measurement.”</span> <em>Science</em> 103 (2684): 677–80.
</div>
<div id="ref-tager1979" class="csl-entry">
Tager, Ira B, Scott T Weiss, Bernard Rosner, and Frank E Speizer. 1979. <span>“Effect of Parental Cigarette Smoking on the Pulmonary Function of Children.”</span> <em>American Journal of Epidemiology</em> 110 (1): 15–26.
</div>
<div id="ref-theus2002" class="csl-entry">
Theus, Martin. 2002. <span>“<span class="nocase">Interactive Data Visualization using Mondrian</span>.”</span> <em>J. Stat. Soft.</em> 7 (November): 1–9. <a href="https://doi.org/10.18637/jss.v007.i11">https://doi.org/10.18637/jss.v007.i11</a>.
</div>
<div id="ref-thudt2016" class="csl-entry">
Thudt, Alice, Jagoda Walny, Charles Perin, Fateme Rajabiyazdi, Lindsay MacDonald, Diane Vardeleon, Saul Greenberg, and Sheelagh Carpendale. 2016. <span>“Assessing the Readability of Stacked Graphs.”</span> In <em>Proceedings of Graphics Interface Conference (GI)</em>.
</div>
<div id="ref-tierney2023" class="csl-entry">
Tierney, Nicholas, and Dianne Cook. 2023. <span>“<span class="nocase">Expanding Tidy Data Principles to Facilitate Missing Data Exploration, Visualization and Assessment of Imputations</span>.”</span> <em>J. Stat. Soft.</em> 105 (February): 1–31. <a href="https://doi.org/10.18637/jss.v105.i07">https://doi.org/10.18637/jss.v105.i07</a>.
</div>
<div id="ref-tufte2001" class="csl-entry">
Tufte, Edward R. 2001. <em>The Visual Display of Quantitative Information</em>. Cheshire, Connecticut: Graphics Press LLC.
</div>
<div id="ref-tukey1993" class="csl-entry">
Tukey, John W. 1993. <span>“Graphic Comparisons of Several Linked Aspects: Alternatives and Suggested Principles.”</span> <em>Journal of Computational and Graphical Statistics</em> 2 (1): 1–33.
</div>
<div id="ref-tversky1983" class="csl-entry">
Tversky, Amos, and Daniel Kahneman. 1983. <span>“Extensional Versus Intuitive Reasoning: The Conjunction Fallacy in Probability Judgment.”</span> <em>Psychological Review</em> 90 (4): 293.
</div>
<div id="ref-unwin1996" class="csl-entry">
Unwin, Antony, George Hawkins, Heike Hofmann, and Bernd Siegl. 1996. <span>“<span class="nocase">Interactive Graphics for Data Sets with Missing Values<span>—</span>MANET</span>.”</span> <em>J. Comput. Graph. Stat.</em>, June. <a href="https://www.tandfonline.com/doi/abs/10.1080/10618600.1996.10474700">https://www.tandfonline.com/doi/abs/10.1080/10618600.1996.10474700</a>.
</div>
<div id="ref-vanderplas2020" class="csl-entry">
Vanderplas, Susan, Dianne Cook, and Heike Hofmann. 2020. <span>“Testing Statistical Charts: What Makes a Good Graph?”</span> <em>Annual Review of Statistics and Its Application</em> 7: 61–88.
</div>
<div id="ref-velleman1993" class="csl-entry">
Velleman, Paul F, and Leland Wilkinson. 1993. <span>“Nominal, Ordinal, Interval, and Ratio Typologies Are Misleading.”</span> <em>The American Statistician</em> 47 (1): 65–72.
</div>
<div id="ref-vickers2012" class="csl-entry">
Vickers, Paul, Joe Faith, and Nick Rossiter. 2012. <span>“Understanding Visualization: A Formal Approach Using Category Theory and Semiotics.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 19 (6): 1048–61.
</div>
<div id="ref-wickham2010" class="csl-entry">
Wickham, Hadley. 2010. <span>“A Layered Grammar of Graphics.”</span> <em>Journal of Computational and Graphical Statistics</em> 19 (1): 3–28.
</div>
<div id="ref-wickham2011" class="csl-entry">
———. 2011. <span>“The Split-Apply-Combine Strategy for Data Analysis.”</span> <em>Journal of Statistical Software</em> 40: 1–29.
</div>
<div id="ref-wickham2016" class="csl-entry">
———. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis (2e)</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-ggplot2repo2024" class="csl-entry">
———. 2024. <span>“Ggplot2.”</span> <em>GitHub</em>. <a href="https://github.com/tidyverse/ggplot2">https://github.com/tidyverse/ggplot2</a>.
</div>
<div id="ref-wickham2009" class="csl-entry">
Wickham, Hadley, Michael Lawrence, Dianne Cook, Andreas Buja, Heike Hofmann, and Deborah F Swayne. 2009. <span>“The Plumbing of Interactive Graphics.”</span> <em>Computational Statistics</em> 24: 207–15.
</div>
<div id="ref-wickham2023" class="csl-entry">
Wickham, Hadley, Thomas Lin Pedersen, and Dana Seidel. 2023. <em>Scales: Scale Functions for Visualization</em>. <a href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a>.
</div>
<div id="ref-wilhelm2008" class="csl-entry">
Wilhelm, Adalbert. 2008. <span>“Linked Views for Visual Exploration.”</span> In <em>Handbook of Data Visualization</em>, 200–214. Springer Science &amp; Business Media.
</div>
<div id="ref-wilke2019" class="csl-entry">
Wilke, Claus O. 2019. <em>Fundamentals of Data Visualization: A Primer on Making Informative and Compelling Figures</em>. O’Reilly Media.
</div>
<div id="ref-wilkinson2012" class="csl-entry">
Wilkinson, Leland. 2012. <em>The Grammar of Graphics</em>. Springer.
</div>
<div id="ref-wills2011" class="csl-entry">
Wills, Graham. 2011. <em>Visualizing Time: Designing Graphical Representations for Statistical Data</em>. Springer Science &amp; Business Media.
</div>
<div id="ref-wu2022" class="csl-entry">
Wu, Eugene. 2022. <span>“View Composition Algebra for Ad Hoc Comparison.”</span> <em>IEEE Transactions on Visualization and Computer Graphics</em> 28 (6): 2470–85.
</div>
<div id="ref-wu2024" class="csl-entry">
Wu, Eugene, and Remco Chang. 2024. <span>“Design-Specific Transformations in Visualization.”</span> <em>arXiv Preprint arXiv:2407.06404</em>.
</div>
<div id="ref-ziemkiewicz2009" class="csl-entry">
Ziemkiewicz, Caroline, and Robert Kosara. 2009. <span>“Embedding Information Visualization Within Visual Representation.”</span> In <em>Advances in Information and Intelligent Systems</em>, 307–26. Springer.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Being the top most downloaded CRAN package as of 4th of December 2024, <span class="citation">Data Science Meta (<a href="#ref-rmeta2024">2024</a>)</span><a href="problems.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>More on this below.<a href="problems.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="litreview.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="goals.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
