<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Applied example | Fluent Graphics</title>
  <meta name="description" content="8 Applied example | Fluent Graphics" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Applied example | Fluent Graphics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Applied example | Fluent Graphics" />
  
  
  

<meta name="author" content="Adam Bartonicek" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="system.html"/>
<link rel="next" href="discussion.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Abstract</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="litreview.html"><a href="litreview.html"><i class="fa fa-check"></i><b>3</b> Background</a>
<ul>
<li class="chapter" data-level="3.1" data-path="litreview.html"><a href="litreview.html#brief-history"><i class="fa fa-check"></i><b>3.1</b> Brief history of interactive data visualization</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="litreview.html"><a href="litreview.html#static-data-visualization-from-ancient-times-to-the-space-age"><i class="fa fa-check"></i><b>3.1.1</b> Static data visualization: From ancient times to the space age</a></li>
<li class="chapter" data-level="3.1.2" data-path="litreview.html"><a href="litreview.html#early-interactive"><i class="fa fa-check"></i><b>3.1.2</b> Early interactive data visualization: By statisticians for statisticians</a></li>
<li class="chapter" data-level="3.1.3" data-path="litreview.html"><a href="litreview.html#web-based"><i class="fa fa-check"></i><b>3.1.3</b> Interactive data visualization and the internet: Web-based interactivity</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="litreview.html"><a href="litreview.html#what-is-interactive-visualization"><i class="fa fa-check"></i><b>3.2</b> What even is interactive data visualization?</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="litreview.html"><a href="litreview.html#interactive-interacting"><i class="fa fa-check"></i><b>3.2.1</b> Interactive vs.¬†interacting with</a></li>
<li class="chapter" data-level="3.2.2" data-path="litreview.html"><a href="litreview.html#interactive-enough"><i class="fa fa-check"></i><b>3.2.2</b> Interactive <em>enough</em>?</a></li>
<li class="chapter" data-level="3.2.3" data-path="litreview.html"><a href="litreview.html#complexity-of-features"><i class="fa fa-check"></i><b>3.2.3</b> Complexity of interactive features</a></li>
<li class="chapter" data-level="3.2.4" data-path="litreview.html"><a href="litreview.html#working-definition"><i class="fa fa-check"></i><b>3.2.4</b> Working definition</a></li>
<li class="chapter" data-level="3.2.5" data-path="litreview.html"><a href="litreview.html#common-features"><i class="fa fa-check"></i><b>3.2.5</b> Common interactive features</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="litreview.html"><a href="litreview.html#general-data-visualization-theory"><i class="fa fa-check"></i><b>3.3</b> General data visualization theory</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="litreview.html"><a href="litreview.html#visualization-goals"><i class="fa fa-check"></i><b>3.3.1</b> Visualization goals</a></li>
<li class="chapter" data-level="3.3.2" data-path="litreview.html"><a href="litreview.html#visual-perception"><i class="fa fa-check"></i><b>3.3.2</b> Visual perception</a></li>
<li class="chapter" data-level="3.3.3" data-path="litreview.html"><a href="litreview.html#scales-measurement"><i class="fa fa-check"></i><b>3.3.3</b> Scales and measurement</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="problems.html"><a href="problems.html"><i class="fa fa-check"></i><b>4</b> Challenges</a>
<ul>
<li class="chapter" data-level="4.1" data-path="problems.html"><a href="problems.html#the-structure-of-this-chapter-data-visualization-pipeline"><i class="fa fa-check"></i><b>4.1</b> The structure of this chapter: Data visualization pipeline</a></li>
<li class="chapter" data-level="4.2" data-path="problems.html"><a href="problems.html#partitioning"><i class="fa fa-check"></i><b>4.2</b> Partitioning</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="problems.html"><a href="problems.html#show-all-data"><i class="fa fa-check"></i><b>4.2.1</b> Showing the full data</a></li>
<li class="chapter" data-level="4.2.2" data-path="problems.html"><a href="problems.html#disjointness-and-comparison"><i class="fa fa-check"></i><b>4.2.2</b> Disjointness and comparison</a></li>
<li class="chapter" data-level="4.2.3" data-path="problems.html"><a href="problems.html#plots-as-partitions"><i class="fa fa-check"></i><b>4.2.3</b> Plots as partitions</a></li>
<li class="chapter" data-level="4.2.4" data-path="problems.html"><a href="problems.html#hierarchy"><i class="fa fa-check"></i><b>4.2.4</b> Partitions, hierarchy, and preorders</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="problems.html"><a href="problems.html#aggregation"><i class="fa fa-check"></i><b>4.3</b> Aggregation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="problems.html"><a href="problems.html#the-relationship-between-graphics-and-statistics"><i class="fa fa-check"></i><b>4.3.1</b> The relationship between graphics and statistics</a></li>
<li class="chapter" data-level="4.3.2" data-path="problems.html"><a href="problems.html#stackable-summaries-a-brief-journey-into-category-theory"><i class="fa fa-check"></i><b>4.3.2</b> Stackable summaries: A brief journey into Category Theory</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="problems.html"><a href="problems.html#scaling"><i class="fa fa-check"></i><b>4.4</b> Scaling</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="goals.html"><a href="goals.html"><i class="fa fa-check"></i><b>5</b> Goals</a>
<ul>
<li class="chapter" data-level="5.1" data-path="goals.html"><a href="goals.html#user-profile"><i class="fa fa-check"></i><b>5.1</b> User profile</a></li>
<li class="chapter" data-level="5.2" data-path="goals.html"><a href="goals.html#programming-interface"><i class="fa fa-check"></i><b>5.2</b> Programming interface</a></li>
<li class="chapter" data-level="5.3" data-path="goals.html"><a href="goals.html#user-interface"><i class="fa fa-check"></i><b>5.3</b> User interface</a></li>
<li class="chapter" data-level="5.4" data-path="goals.html"><a href="goals.html#interactive-features"><i class="fa fa-check"></i><b>5.4</b> Interactive features</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="high-level-design.html"><a href="high-level-design.html"><i class="fa fa-check"></i><b>6</b> High-level design</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="high-level-design.html"><a href="high-level-design.html#user-profile-1"><i class="fa fa-check"></i><b>6.0.1</b> User profile</a></li>
<li class="chapter" data-level="6.1" data-path="high-level-design.html"><a href="high-level-design.html#programming-paradigm"><i class="fa fa-check"></i><b>6.1</b> Programming paradigm</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="high-level-design.html"><a href="high-level-design.html#imperative-programming"><i class="fa fa-check"></i><b>6.1.1</b> Imperative programming</a></li>
<li class="chapter" data-level="6.1.2" data-path="high-level-design.html"><a href="high-level-design.html#functional-programming"><i class="fa fa-check"></i><b>6.1.2</b> Functional programming</a></li>
<li class="chapter" data-level="6.1.3" data-path="high-level-design.html"><a href="high-level-design.html#object-oriented-programming"><i class="fa fa-check"></i><b>6.1.3</b> Object oriented programming</a></li>
<li class="chapter" data-level="6.1.4" data-path="high-level-design.html"><a href="high-level-design.html#data-oriented-programming"><i class="fa fa-check"></i><b>6.1.4</b> Data oriented programming</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="high-level-design.html"><a href="high-level-design.html#reactivity"><i class="fa fa-check"></i><b>6.2</b> Reactivity</a></li>
<li class="chapter" data-level="6.3" data-path="high-level-design.html"><a href="high-level-design.html#data-representation"><i class="fa fa-check"></i><b>6.3</b> Data representation</a></li>
<li class="chapter" data-level="6.4" data-path="high-level-design.html"><a href="high-level-design.html#rendering-engine"><i class="fa fa-check"></i><b>6.4</b> Rendering engine</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="system.html"><a href="system.html"><i class="fa fa-check"></i><b>7</b> System description</a>
<ul>
<li class="chapter" data-level="7.1" data-path="system.html"><a href="system.html#core-requirements"><i class="fa fa-check"></i><b>7.1</b> Core requirements</a></li>
<li class="chapter" data-level="7.2" data-path="system.html"><a href="system.html#application-programming-interface-plotscaper"><i class="fa fa-check"></i><b>7.2</b> Application Programming Interface (<code>plotscaper</code>)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="system.html"><a href="system.html#basic-example"><i class="fa fa-check"></i><b>7.2.1</b> Basic example</a></li>
<li class="chapter" data-level="7.2.2" data-path="system.html"><a href="system.html#scene-and-schema"><i class="fa fa-check"></i><b>7.2.2</b> The scene and the schema</a></li>
<li class="chapter" data-level="7.2.3" data-path="system.html"><a href="system.html#html-document-embedding"><i class="fa fa-check"></i><b>7.2.3</b> HTML document embedding</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="system.html"><a href="system.html#interactive-figure-platform-plotscape"><i class="fa fa-check"></i><b>7.3</b> Interactive figure platform (<code>plotscape</code>)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="system.html"><a href="system.html#Indexable"><i class="fa fa-check"></i><b>7.3.1</b> Indexable</a></li>
<li class="chapter" data-level="7.3.2" data-path="system.html"><a href="system.html#Getter"><i class="fa fa-check"></i><b>7.3.2</b> Getter</a></li>
<li class="chapter" data-level="7.3.3" data-path="system.html"><a href="system.html#dataframe"><i class="fa fa-check"></i><b>7.3.3</b> Dataframe</a></li>
<li class="chapter" data-level="7.3.4" data-path="system.html"><a href="system.html#reactive"><i class="fa fa-check"></i><b>7.3.4</b> Reactive</a></li>
<li class="chapter" data-level="7.3.5" data-path="system.html"><a href="system.html#factors"><i class="fa fa-check"></i><b>7.3.5</b> Factors</a></li>
<li class="chapter" data-level="7.3.6" data-path="system.html"><a href="system.html#reducers"><i class="fa fa-check"></i><b>7.3.6</b> Reducers</a></li>
<li class="chapter" data-level="7.3.7" data-path="system.html"><a href="system.html#scales"><i class="fa fa-check"></i><b>7.3.7</b> Scales</a></li>
<li class="chapter" data-level="7.3.8" data-path="system.html"><a href="system.html#expanses"><i class="fa fa-check"></i><b>7.3.8</b> Expanses</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="applied-example.html"><a href="applied-example.html"><i class="fa fa-check"></i><b>8</b> Applied example</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="applied-example.html"><a href="applied-example.html#about-the-data-set"><i class="fa fa-check"></i><b>8.0.1</b> About the data set</a></li>
<li class="chapter" data-level="8.0.2" data-path="applied-example.html"><a href="applied-example.html#interactive-exploration"><i class="fa fa-check"></i><b>8.0.2</b> Interactive exploration</a></li>
<li class="chapter" data-level="8.1" data-path="applied-example.html"><a href="applied-example.html#summary"><i class="fa fa-check"></i><b>8.1</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>9</b> Discussion</a></li>
<li class="chapter" data-level="10" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i><b>10</b> Glossary</a></li>
<li class="chapter" data-level="11" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>11</b> Appendix</a></li>
<li class="chapter" data-level="12" data-path="mathematical-theory.html"><a href="mathematical-theory.html"><i class="fa fa-check"></i><b>12</b> Mathematical theory</a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="mathematical-theory.html"><a href="mathematical-theory.html#relations"><i class="fa fa-check"></i><b>12.0.1</b> Relations</a></li>
<li class="chapter" data-level="12.0.2" data-path="mathematical-theory.html"><a href="mathematical-theory.html#functions"><i class="fa fa-check"></i><b>12.0.2</b> Functions</a></li>
<li class="chapter" data-level="12.0.3" data-path="mathematical-theory.html"><a href="mathematical-theory.html#partitions"><i class="fa fa-check"></i><b>12.0.3</b> Partitions</a></li>
<li class="chapter" data-level="12.0.4" data-path="mathematical-theory.html"><a href="mathematical-theory.html#preorders"><i class="fa fa-check"></i><b>12.0.4</b> Preorders</a></li>
<li class="chapter" data-level="12.0.5" data-path="mathematical-theory.html"><a href="mathematical-theory.html#monoids"><i class="fa fa-check"></i><b>12.0.5</b> Monoids</a></li>
<li class="chapter" data-level="12.0.6" data-path="mathematical-theory.html"><a href="mathematical-theory.html#groups"><i class="fa fa-check"></i><b>12.0.6</b> Groups</a></li>
<li class="chapter" data-level="12.0.7" data-path="mathematical-theory.html"><a href="mathematical-theory.html#categories"><i class="fa fa-check"></i><b>12.0.7</b> Categories</a></li>
<li class="chapter" data-level="12.0.8" data-path="mathematical-theory.html"><a href="mathematical-theory.html#functors"><i class="fa fa-check"></i><b>12.0.8</b> Functors</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fluent Graphics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="applied-example" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Applied example<a href="applied-example.html#applied-example" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>Please note that the data set used in this section is fairly large (~70,000 rows) and so the figures take some time to load (please allow ~30 seconds).</p>
</blockquote>
<p>This section demonstrates a typical interactive workflow with <code>plotscaper</code>. The goal is to showcase the package‚Äôs key features and capabilities by exploring a large, real-world data set, pertaining to a pressing issue: mental health.</p>
<p>Mental health is a global concern. In developed nations, mental health disorders are primary contributor to years lived with disability, significantly impacting both the well-being of individuals and the economic productivity of entire countries <span class="citation">(<a href="#ref-who2022">Organization 2022</a>)</span>. This issue, however, extends beyond developed nations. The global burden of mental health disorders has been steadily rising over the recent decades, a trend which is particularly concerning in low-income countries where access to mental health services is even more limited <span class="citation">(<a href="#ref-patel2018">Patel et al. 2018</a>)</span>.</p>
<p>Having had personal experience with friends and relatives impacted by mental health issues, as well as having majored in psychology during my undergraduate studies, I have had a long-standing interest in the topic. It is clear to me that mental health is a key challenge that the world is facing today, and the first step towards solving it will require clearly identifying key trends and patterns. For this reason, I chose to dedicate this section to an exploration of a large longitudinal mental health data set.</p>
<div id="about-the-data-set" class="section level3 hasAnchor" number="8.0.1">
<h3><span class="header-section-number">8.0.1</span> About the data set<a href="applied-example.html#about-the-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <a href="https://www.uzis.cz/index-en.php">Institute of Health Information and Statistics of the Czech Republic</a> (IHIS, √öZIS in Czech) is a government agency established by the Czech Ministry of Health. Its primary responsibility is the collection, processing, and reporting of medical data within the country of Czechia <span class="citation">(<a href="#ref-uzis2024">√öZIS 2024</a>)</span>. Of interest, the institute provides high-quality, open-access medical data, including information about the use and manufacture of pharmaceutics, fiscal and employment records from healthcare facilities, and various epidemiological data sets.</p>
<p>The Long-term Care data set <span class="citation">(<a href="#ref-soukupova2023">Soukupov√° et al. 2023</a>)</span> contains longitudinal information about long-term psychiatric care in Czechia. More specifically, it contains aggregated data on individuals released from psychiatric care facilities between 2010 and 2022. It includes information such the region of the treatment facility, the sex of the patients, age category, diagnosis based on the international ICD-10 classification <span class="citation">(<a href="#ref-icd2024a">World Health Organization 2024a</a>, <a href="#ref-icd2024b">2024b</a>)</span>, the number of hospitalizations, and the total number of days spent in care by the given subset of patients.</p>
<p>Here‚Äôs the data set at a quick glance:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="applied-example.html#cb121-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/longterm_care.csv&quot;</span>)</span>
<span id="cb121-2"><a href="applied-example.html#cb121-2" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(df)</span></code></pre></div>
<pre><code>## Rows: 68,115
## Columns: 12
## $ year                   [3m[38;5;246m&lt;int&gt;[39m[23m 2019, 2016, 2011, 2013, 2019, 2013, 2018, 2017, 2019, 2015, 2018, 2022, 2012, 2010‚Ä¶
## $ region_code            [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;CZ071&quot;, &quot;CZ064&quot;, &quot;CZ080&quot;, &quot;CZ072&quot;, &quot;CZ080&quot;, &quot;CZ053&quot;, &quot;CZ080&quot;, &quot;CZ031&quot;, &quot;CZ032&quot;, &quot;‚Ä¶
## $ region                 [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;Olomouck√Ω kraj&quot;, &quot;Jihomoravsk√Ω kraj&quot;, &quot;Moravskoslezsk√Ω kraj&quot;, &quot;Zl√≠nsk√Ω kraj&quot;, &quot;Mo‚Ä¶
## $ sex                    [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;female&quot;, &quot;male&quot;, &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;female&quot;, &quot;m‚Ä¶
## $ diagnosis              [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;f10&quot;, &quot;f2&quot;, &quot;f7&quot;, &quot;f4 without f42&quot;, &quot;f60‚Äìf61&quot;, &quot;f32‚Äìf33&quot;, &quot;f3 without f32&amp;f33&quot;, &quot;‚Ä¶
## $ reason_for_termination [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;release&quot;, &quot;early termination&quot;, &quot;early termination&quot;, &quot;early termination&quot;, &quot;transfe‚Ä¶
## $ age_category           [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;40‚Äì49&quot;, &quot;30‚Äì39&quot;, &quot;30‚Äì39&quot;, &quot;40‚Äì49&quot;, &quot;50‚Äì59&quot;, &quot;40‚Äì49&quot;, &quot;60‚Äì69&quot;, &quot;0‚Äì19&quot;, &quot;70‚Äì79&quot;, &quot;2‚Ä¶
## $ stay_category          [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;short&quot;, &quot;medium&quot;, &quot;short&quot;, &quot;short&quot;, &quot;short&quot;, &quot;short&quot;, &quot;medium&quot;, &quot;medium&quot;, &quot;short&quot;‚Ä¶
## $ field                  [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;psychiatry&quot;, &quot;psychiatry&quot;, &quot;psychiatry&quot;, &quot;psychiatry&quot;, &quot;psychiatry&quot;, &quot;psychiatry&quot;‚Ä¶
## $ care_category          [3m[38;5;246m&lt;chr&gt;[39m[23m &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;child&quot;, &quot;adult&quot;, &quot;‚Ä¶
## $ cases                  [3m[38;5;246m&lt;int&gt;[39m[23m 13, 3, 2, 3, 1, 2, 2, 32, 2, 2, 1, 12, 1, 1, 2, 9, 18, 1, 1, 1, 1, 3, 1, 8, 16, 13‚Ä¶
## $ days                   [3m[38;5;246m&lt;int&gt;[39m[23m 196, 345, 38, 108, 1, 47, 319, 3813, 120, 256, 151, 574, 49, 210, 3333, 186, 441, ‚Ä¶</code></pre>
<p>The data contains over 68,000 rows, totaling over 410,000 individual-patient hospitalizations. Each row records the number patients with a particular set of of characteristics released from a treatment facility during a given year, and the number of days the patients spent in treatment in total.</p>
<p>In the original version of the data set, the column names as well as the labels of the categorical variables are in Czech. To make the analysis more easily accessible to non-Czech speakers, I took the liberty of translating most of these to English (excluding the <code>region</code> variable). The translation script is available in the <a href="https://github.com/bartonicek/thesis/blob/master/longterm_care_translate.R">thesis repository</a>. Additionally, the <a href="https://www.nzip.cz/data/2060-dlouhodoba-psychiatricka-pece">data set website</a> contains a JSON schema with a text description of each of the variables <span class="citation">(<a href="#ref-soukupova2023">Soukupov√° et al. 2023</a>)</span>. I translated these descriptions as well and provide them below, in Table <a href="applied-example.html#tab:longterm-care-schema">8.1</a>:</p>
<table>
<caption><span id="tab:longterm-care-schema">Table 8.1: </span>Schema of the long-term care data set, including the original column names (Czech), as well as translated names and descriptions.</caption>
<colgroup>
<col width="12%" />
<col width="16%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Translated name</th>
<th align="left">Original name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="left">rok</td>
<td align="left">The year hospitalization was terminated</td>
</tr>
<tr class="even">
<td align="left">region_code</td>
<td align="left">kraj_kod</td>
<td align="left">Region code based on the NUTS 3 classification</td>
</tr>
<tr class="odd">
<td align="left">region</td>
<td align="left">kraj_nazev</td>
<td align="left">Region where the facility was located</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="left">pohlavi</td>
<td align="left">Classification of patients‚Äô sex</td>
</tr>
<tr class="odd">
<td align="left">diagnosis</td>
<td align="left">zakladni_diagnoza</td>
<td align="left">The primary diagnosis of the psychiatric disorder based on the ICD-10 classification</td>
</tr>
<tr class="even">
<td align="left">reason_for_termination</td>
<td align="left">ukonceni</td>
<td align="left">The reason for termination of care</td>
</tr>
<tr class="odd">
<td align="left">age_category</td>
<td align="left">vekova_kategorie</td>
<td align="left">Classification of patients‚Äô age category</td>
</tr>
<tr class="even">
<td align="left">stay_category</td>
<td align="left">kategorie_delky_hospitalizace</td>
<td align="left">Classification of hospitalization based on length: short-term (&lt; 3 months), medium-term (3-6 months), and long-term (6+ months)</td>
</tr>
<tr class="odd">
<td align="left">field</td>
<td align="left">obor</td>
<td align="left">The field of psychiatric care</td>
</tr>
<tr class="even">
<td align="left">care_category</td>
<td align="left">kategorie_pece</td>
<td align="left">Classification of care: child or adult</td>
</tr>
<tr class="odd">
<td align="left">cases</td>
<td align="left">pocet_hospitalizaci</td>
<td align="left">The total number of cases/hospitalizations in the given subgroup of patients</td>
</tr>
<tr class="even">
<td align="left">days</td>
<td align="left">delka_hospitlizace</td>
<td align="left">The total time spent in care, in days (= sum of the number of days all patients in a given subgroup spent in care)</td>
</tr>
</tbody>
</table>
<p>Before we go on to explore the data set with interactive figures, there are a couple of things to note about the data set. The first is that the data has been pre-aggregated, such that each row represents the combined number of releases within a given subgroup of patients. For example, the first row indicates that, in the year 2019, 13 women aged 40-49 were released from treatment facilities in Olomouck√Ω kraj (region), after receiving short-term care for F10 ICD-10 diagnosis <span class="citation">(mental and behavioural disorders due to alcohol use, <a href="#ref-icd2024a">World Health Organization 2024a</a>)</span> for a sum total of 196 days:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="applied-example.html#cb123-1" tabindex="-1"></a>df[<span class="dv">1</span>, ]</span></code></pre></div>
<pre><code>##   year region_code         region    sex diagnosis reason_for_termination age_category stay_category      field
## 1 2019       CZ071 Olomouck√Ω kraj female       f10                release        40‚Äì49         short psychiatry
##   care_category cases days
## 1         adult    13  196</code></pre>
<p>The reason for this aggregation is likely to anonymize the data and reduce the risk of identifying individual patients <span class="citation">(see e.g. <a href="#ref-pina2024">Pina et al. 2024</a>)</span>. However, when creating visualizations, we need to take the fact that each row represents a group of patients into account. For instance, when drawing a barplot, simply plotting row counts would not be appropriate, since that would ignore the size of the patient groups. Instead, to represent the data properly, we should aggregate (sum) either <code>cases</code> or <code>days</code>, depending on the question of interest. The same applies to all other aggregation plots, such as histograms <span class="citation">(i.e.¬†weighted histograms, see e.g. <a href="#ref-unwin2008">Unwin, Theus, and H√§rdle 2008</a>)</span> and fluctuation diagrams.</p>
<p>Fortunately, as we will see, <code>plotscaper</code> makes it easy to create these weighted types visualizations. And further, while the information this aggregated data provides inherently less granular information than patient-level records, we will see that it still preserves a large amount of structure.</p>
</div>
<div id="interactive-exploration" class="section level3 hasAnchor" number="8.0.2">
<h3><span class="header-section-number">8.0.2</span> Interactive exploration<a href="applied-example.html#interactive-exploration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="the-relationship-between-cases-and-days" class="section level4 hasAnchor" number="8.0.2.1">
<h4><span class="header-section-number">8.0.2.1</span> The relationship between cases and days<a href="applied-example.html#the-relationship-between-cases-and-days" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We start by exploring the relationship between the two primary continuous variables of interest: <code>cases</code> (the number of patients in a given subgroup released from care) and <code>days</code> (the total number of days the given subgroup of patients spent in care). Intuitively, we would expect a positive, linear relationship between these variables, such that a larger patient groups should spend more days in care. We can use <code>plotscaper</code> to visualize this relationship via a scatterplot:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="applied-example.html#cb125-1" tabindex="-1"></a><span class="fu">library</span>(plotscaper) <span class="co"># Load in the package</span></span>
<span id="cb125-2"><a href="applied-example.html#cb125-2" tabindex="-1"></a></span>
<span id="cb125-3"><a href="applied-example.html#cb125-3" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb125-4"><a href="applied-example.html#cb125-4" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span> <span class="co"># Create a declarative schema for the figure</span></span>
<span id="cb125-5"><a href="applied-example.html#cb125-5" tabindex="-1"></a>  <span class="fu">add_scatterplot</span>(<span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span> <span class="co"># Add a scatterplot</span></span>
<span id="cb125-6"><a href="applied-example.html#cb125-6" tabindex="-1"></a>  <span class="fu">render</span>() <span class="co"># Render the schema into an interactive figure</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:example-cases-days"></span>
<iframe src="./figures/example-cases-days.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p class="caption">
Figure 8.1: Relationship between the number of cases in a patient subgroup and the total number of days spent in care.
</p>
</div>
<p>Interestingly, the points did not show a simple linear trend. Instead, they seemed to cluster in three distinct ‚Äúleaflets‚Äù, each exhibiting a roughly linear trend. This suggests the presence of a pooling effect, such that the overall trend is the result of combining three distinct groups. Closer inspection of the data reveals that the <code>stay_category</code> variable has three levels: short-term (&lt; 3 months), medium-term (3-6 months), and long-term (6+ months) care. Color-coding the cases indeed confirms that the three levels of <code>stay_category</code> correspond to the leaflets:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="applied-example.html#cb126-1" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb126-2"><a href="applied-example.html#cb126-2" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span></span>
<span id="cb126-3"><a href="applied-example.html#cb126-3" tabindex="-1"></a>  <span class="fu">add_scatterplot</span>(<span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb126-4"><a href="applied-example.html#cb126-4" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;stay_category&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span> <span class="co"># y-axis is weighted by cases</span></span>
<span id="cb126-5"><a href="applied-example.html#cb126-5" tabindex="-1"></a>  <span class="fu">assign_cases</span>(<span class="fu">which</span>(df<span class="sc">$</span>stay_category <span class="sc">==</span> <span class="st">&quot;short&quot;</span>), <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="co"># Mark short-term green</span></span>
<span id="cb126-6"><a href="applied-example.html#cb126-6" tabindex="-1"></a>  <span class="fu">assign_cases</span>(<span class="fu">which</span>(df<span class="sc">$</span>stay_category <span class="sc">==</span> <span class="st">&quot;long&quot;</span>), <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="co"># Mark long-term red</span></span>
<span id="cb126-7"><a href="applied-example.html#cb126-7" tabindex="-1"></a>  <span class="fu">render</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:example-cases-stay-cat"></span>
<iframe src="./figures/example-cases-stay-cat.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p class="caption">
Figure 8.2: The relationship between cases and days is subject to a pooling effect: while patient groups within each care duration category (short-term, medium-term, and long-term) exhibit a linear relationship individually, this does not hold when the groups are considered together.
</p>
</div>
<blockquote>
<p>Click on the barplot bars to confirm there is a fairly minimal overlap between points belonging to the three categories (selected points will be brought to the foreground). To remove all selection, double-click the figure.</p>
</blockquote>
<p>However, the pooling effect does not itself explain the absence of points between the three leaflets. If the distribution of cases and days within each of the three <code>stay_category</code> levels were uniform, we should expect to see more points in the gaps between the leaflets. This additionally suggests a potential selection process, where patients are less likely to be discharged at durations near the category boundaries. We can confirm this by plotting the average number of days spent in care:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="applied-example.html#cb127-1" tabindex="-1"></a><span class="co"># Compute the average number of days spent in treatment</span></span>
<span id="cb127-2"><a href="applied-example.html#cb127-2" tabindex="-1"></a>df<span class="sc">$</span>avg_days <span class="ot">&lt;-</span> df<span class="sc">$</span>days <span class="sc">/</span> df<span class="sc">$</span>cases </span>
<span id="cb127-3"><a href="applied-example.html#cb127-3" tabindex="-1"></a></span>
<span id="cb127-4"><a href="applied-example.html#cb127-4" tabindex="-1"></a>df <span class="sc">|&gt;</span>  </span>
<span id="cb127-5"><a href="applied-example.html#cb127-5" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span></span>
<span id="cb127-6"><a href="applied-example.html#cb127-6" tabindex="-1"></a>  <span class="fu">add_scatterplot</span>(<span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;avg_days&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb127-7"><a href="applied-example.html#cb127-7" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;stay_category&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb127-8"><a href="applied-example.html#cb127-8" tabindex="-1"></a>  <span class="fu">assign_cases</span>(<span class="fu">which</span>(df<span class="sc">$</span>stay_category <span class="sc">==</span> <span class="st">&quot;short-term&quot;</span>), <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb127-9"><a href="applied-example.html#cb127-9" tabindex="-1"></a>  <span class="fu">assign_cases</span>(<span class="fu">which</span>(df<span class="sc">$</span>stay_category <span class="sc">==</span> <span class="st">&quot;long-term&quot;</span>), <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb127-10"><a href="applied-example.html#cb127-10" tabindex="-1"></a>  <span class="fu">set_scale</span>(<span class="st">&quot;scatterplot1&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="co"># Log-transform the y-axis</span></span>
<span id="cb127-11"><a href="applied-example.html#cb127-11" tabindex="-1"></a>            <span class="at">transformation =</span> <span class="st">&quot;log10&quot;</span>, <span class="at">default =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb127-12"><a href="applied-example.html#cb127-12" tabindex="-1"></a>  <span class="fu">render</span>()</span></code></pre></div>
<iframe src="./figures/example-cases-avg-days.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p>Now we can clearly see the gaps between the three different distributions along the y-axis.</p>
<blockquote>
<p>Try querying the points near the y-axis gaps by pressing the <code>Q</code> key and hovering over them. You should observe that the gaps roughly span the 60-90 day and 150-210 day ranges, corresponding to 2-3 months and 5-7 months, respectively.</p>
</blockquote>
<p>The trend we see in the scatterplot above strong indication of a selection process is at work. Specifically, it seems that patients who stay in treatment for more than two months are likely to be transferred to medium-term care and kept around for longer, and, likewise, those who stay in treatment for more than five months are likely to be moved to long-term care. There are likely administrative of health-insurance related reasons for this trend, nevertheless, it is still an interesting pattern to take note of.</p>
</div>
<div id="number-of-cases-over-time" class="section level4 hasAnchor" number="8.0.2.2">
<h4><span class="header-section-number">8.0.2.2</span> Number of cases over time<a href="applied-example.html#number-of-cases-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A key question is how have the numbers of patients in treatment evolved over time. We can investigate this by plotting the same scatterplot as we did in the section above, as well as two barplots showing the total number of cases and the total number days in treatment, within each year. We can also include a histogram of the number of days, for a good measure:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="applied-example.html#cb128-1" tabindex="-1"></a>schema <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb128-2"><a href="applied-example.html#cb128-2" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span></span>
<span id="cb128-3"><a href="applied-example.html#cb128-3" tabindex="-1"></a>  <span class="fu">add_scatterplot</span>(<span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb128-4"><a href="applied-example.html#cb128-4" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb128-5"><a href="applied-example.html#cb128-5" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb128-6"><a href="applied-example.html#cb128-6" tabindex="-1"></a>  <span class="fu">add_histogram</span>(<span class="fu">c</span>(<span class="st">&quot;days&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span> <span class="co"># Again, make sure to weigh the y-axis</span></span>
<span id="cb128-7"><a href="applied-example.html#cb128-7" tabindex="-1"></a>  <span class="fu">set_parameters</span>(<span class="st">&quot;histogram1&quot;</span>, <span class="at">width =</span> <span class="dv">20</span>) <span class="co"># Set histogram binwidth to 20 days</span></span>
<span id="cb128-8"><a href="applied-example.html#cb128-8" tabindex="-1"></a></span>
<span id="cb128-9"><a href="applied-example.html#cb128-9" tabindex="-1"></a>schema <span class="sc">|&gt;</span> <span class="fu">render</span>()</span></code></pre></div>
<iframe src="./figures/example-cases-days-time.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p>From the barplots, we can immediately see an interesting pattern: while the numbers of cases seem to have declined over time, the number of days patients spent in care seem to seems to have remained fairly constant. This suggest that while there are fewer patients over all, they are being hospitalized for longer.</p>
<p>We can confirm this interactively. Click on the bars corresponding to the year 2010 and 2022, in either of the two barplots (feel free to mark either of the bars by holding down the <code>1</code> or <code>2</code> keys and clicking them). You should see that, compared to 2010, there were more patients in long term care in 2022, and the relationship between the number of cases and the number of days in care was steeper.</p>
<p>On its own, the declining number of cases over time might appear as a positive development; however, the constant number days in treatment suggests a more worrying trend. Specifically, treatment facility placements are limited resource <span class="citation">(<a href="#ref-who2022">Organization 2022</a>)</span>, and the fact that days in treatment have stayed constant while cases have declined may indicate that the Czech healthcare system is becoming burdened by patients in long-term care, reducing its capacity to serve new clients.</p>
<p>Another way we can scrutinize the trend more closely by zooming into the histogram:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="applied-example.html#cb129-1" tabindex="-1"></a>schema <span class="sc">|&gt;</span> </span>
<span id="cb129-2"><a href="applied-example.html#cb129-2" tabindex="-1"></a>  <span class="fu">assign_cases</span>(<span class="fu">which</span>(df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2010</span>), <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb129-3"><a href="applied-example.html#cb129-3" tabindex="-1"></a>  <span class="fu">assign_cases</span>(<span class="fu">which</span>(df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2022</span>), <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb129-4"><a href="applied-example.html#cb129-4" tabindex="-1"></a>  <span class="fu">zoom</span>(<span class="st">&quot;histogram1&quot;</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">0</span>, <span class="fl">3e03</span>, <span class="fl">1e05</span>), <span class="at">units =</span> <span class="st">&quot;data&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb129-5"><a href="applied-example.html#cb129-5" tabindex="-1"></a>  <span class="fu">render</span>()</span></code></pre></div>
<iframe src="./figures/example-cases-days-time-zoom.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<blockquote>
<p>You can zoom into a plot in two ways: programmatically using the <code>zoom</code> function (as shown above), or manually by clicking and dragging to select a rectangular region and pressing the <code>Z</code> key. You can chain multiple zooms to magnify small regions of the plot. To undo zooming, press either the <code>X</code> to revert back one level of zoom, or <code>R</code> to reset the figure to its default state (including the default zoom level).</p>
</blockquote>
<p>By clicking on the two bars, you should be able to see that, compared to 2010, the 2022 distribution of days spent in treatment had a fatter tail, suggesting that there were more patients who spent very long time in care.</p>
</div>
<div id="age-and-child-and-adolescent-mental-health" class="section level4 hasAnchor" number="8.0.2.3">
<h4><span class="header-section-number">8.0.2.3</span> Age and child and adolescent mental health<a href="applied-example.html#age-and-child-and-adolescent-mental-health" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The global mental health decline affects adults and children alike, however, childhood mental health disorders are particularly concerning. If these disorders manifest during critical developmental periods, they can have serious, often life-long consequences, causing irreversible changes in brain physiology even with successful treatment <span class="citation">(see e.g. <a href="#ref-keeley2021">Keeley 2021</a>)</span>. Children also have less agency than adults in managing their mental health, relying heavily on caregivers and schools for support. For these reasons and more, monitoring the mental health of children and adolescents is critical.</p>
<p>Fortunately, the overall proportion of children and adolescents in the data set was fairly low, amounting to &lt;9% of all cases and &lt;6% of the total number of days spent in treatment:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="applied-example.html#cb130-1" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(cases, days) <span class="sc">~</span> care_category, sum, <span class="at">data =</span> df) <span class="sc">|&gt;</span></span>
<span id="cb130-2"><a href="applied-example.html#cb130-2" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="cf">function</span>(x) { <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">return</span>(x <span class="sc">/</span> <span class="fu">sum</span>(x)) <span class="cf">else</span> x }) <span class="sc">|&gt;</span></span>
<span id="cb130-3"><a href="applied-example.html#cb130-3" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span></code></pre></div>
<pre><code>##   care_category      cases       days
## 1         adult 0.91028915 0.94285172
## 2         child 0.08971085 0.05714828</code></pre>
<p>To investigate how these numbers evolved over time, we can make use of the following figure:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="applied-example.html#cb132-1" tabindex="-1"></a><span class="co"># Create a figure layout with two small plots in the left</span></span>
<span id="cb132-2"><a href="applied-example.html#cb132-2" tabindex="-1"></a><span class="co"># column, and one tall plot in the right column</span></span>
<span id="cb132-3"><a href="applied-example.html#cb132-3" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb132-4"><a href="applied-example.html#cb132-4" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">3</span>,</span>
<span id="cb132-5"><a href="applied-example.html#cb132-5" tabindex="-1"></a>  <span class="dv">2</span>, <span class="dv">3</span></span>
<span id="cb132-6"><a href="applied-example.html#cb132-6" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-7"><a href="applied-example.html#cb132-7" tabindex="-1"></a></span>
<span id="cb132-8"><a href="applied-example.html#cb132-8" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb132-9"><a href="applied-example.html#cb132-9" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span></span>
<span id="cb132-10"><a href="applied-example.html#cb132-10" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb132-11"><a href="applied-example.html#cb132-11" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb132-12"><a href="applied-example.html#cb132-12" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;care_category&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb132-13"><a href="applied-example.html#cb132-13" tabindex="-1"></a>  <span class="fu">set_layout</span>(layout) <span class="sc">|&gt;</span> <span class="co"># Set the layout</span></span>
<span id="cb132-14"><a href="applied-example.html#cb132-14" tabindex="-1"></a>  <span class="fu">render</span>() </span></code></pre></div>
<iframe src="./figures/example-cases-days-children.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p>So far, we have been using a fairly simple interactive workflow that could be easily recreated via code, taking only one or two interactive actions at a time. However, now it is time to see the full potential of interactivity by chaining several interactive actions together. To explore how the proportion of child and adolescent patients evolved over time, try taking the following steps:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>Mark the cases corresponding to children: click on the corresponding bar in the right barplot while holding down the <code>1</code> key.</li>
<li>Normalize the two leftmost barplots: click each of on the plots to activate it and press the <code>N</code> key while the plot is active (you can revert back to absolute counts by pressing the <code>N</code> key again).</li>
<li>Zoom into the regions of the leftmost barplots containing selected cases: click-and-drag to select a rectangular region and pressing the <code>Z</code> key.</li>
</ol>
</blockquote>
<p>By following these steps, you should end up with a figure similar to the one below:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="applied-example.html#cb133-1" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb133-2"><a href="applied-example.html#cb133-2" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span></span>
<span id="cb133-3"><a href="applied-example.html#cb133-3" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb133-4"><a href="applied-example.html#cb133-4" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb133-5"><a href="applied-example.html#cb133-5" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;care_category&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb133-6"><a href="applied-example.html#cb133-6" tabindex="-1"></a>  <span class="fu">assign_cases</span>(<span class="fu">which</span>(df<span class="sc">$</span>care_category <span class="sc">==</span> <span class="st">&quot;child&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb133-7"><a href="applied-example.html#cb133-7" tabindex="-1"></a>  plotscaper<span class="sc">::</span><span class="fu">normalize</span>(<span class="st">&quot;barplot1&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb133-8"><a href="applied-example.html#cb133-8" tabindex="-1"></a>  plotscaper<span class="sc">::</span><span class="fu">normalize</span>(<span class="st">&quot;barplot2&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb133-9"><a href="applied-example.html#cb133-9" tabindex="-1"></a>  <span class="fu">zoom</span>(<span class="st">&quot;barplot1&quot;</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.15</span>)) <span class="sc">|&gt;</span></span>
<span id="cb133-10"><a href="applied-example.html#cb133-10" tabindex="-1"></a>  <span class="fu">zoom</span>(<span class="st">&quot;barplot2&quot;</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.15</span>)) <span class="sc">|&gt;</span></span>
<span id="cb133-11"><a href="applied-example.html#cb133-11" tabindex="-1"></a>  <span class="fu">set_layout</span>(layout) <span class="sc">|&gt;</span></span>
<span id="cb133-12"><a href="applied-example.html#cb133-12" tabindex="-1"></a>  <span class="fu">render</span>() </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:example-cases-days-children-marked"></span>
<iframe src="./figures/example-cases-days-children-marked.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p class="caption">
Figure 8.3: While the proportion of days spent in treatment by children and adolescent has declined, the proportion of cases that children and adolescents make up has increased.
</p>
</div>
<p>Interestingly, the two barplots show the opposite trend. While the proportion of the treatment days used by children and adolescents has declined over time, the proportion of total cases they make up has increased. The relative increase in cases appears to be driven by an overall decline in patient numbers: in absolute counts, the number of child and adolescent patients has remained fairly constant between 2010 to 2022, while the total patient count has decreased.</p>
<p>We can also get a more granular breakdown by plotting the age category variable:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="applied-example.html#cb134-1" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb134-2"><a href="applied-example.html#cb134-2" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span></span>
<span id="cb134-3"><a href="applied-example.html#cb134-3" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;age_category&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb134-4"><a href="applied-example.html#cb134-4" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb134-5"><a href="applied-example.html#cb134-5" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;age_category&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb134-6"><a href="applied-example.html#cb134-6" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb134-7"><a href="applied-example.html#cb134-7" tabindex="-1"></a>  <span class="fu">render</span>()</span></code></pre></div>
<iframe src="./figures/example-cases-days-age.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p>Again, if we interrogate the figure by employing interactive actions such as selection, zooming, and normalization, we can discover that one age category in which there has been steady growth in both the proportion of cases and days spend in treatment are 70-79 year olds. This aligns with the limited placement availability hypothesis: while these patients account for a relatively small fraction of the total cases, they represent a disproportionately large and increasing proportion of days in treatment. Later, we will also see evidence that many of these patients suffer from neurodegenerative diseases, which require intensive long-term care. It may be the case that, with increasing life-expectancy, the healthcare system is not able to handle the influx of older patients, limiting the availability of placements.</p>
</div>
<div id="prevalence-of-diagnoses" class="section level4 hasAnchor" number="8.0.2.4">
<h4><span class="header-section-number">8.0.2.4</span> Prevalence of diagnoses<a href="applied-example.html#prevalence-of-diagnoses" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another important information we can glean from the data set is the prevalence of different diagnoses and their demographic characteristics. The data set identifies mental disorders according to ICD-10, an internationally recognized disease classification system published by the World Health organization which organizes various diseases into categories based on aetiology <span class="citation">(<a href="#ref-icd2024a">World Health Organization 2024a</a>)</span>.</p>
<p>It is first necessary to discuss the coding scheme of the diagnoses. The codes were directly translated from the Czech version of the data set <span class="citation">(<a href="#ref-soukupova2023">Soukupov√° et al. 2023</a>)</span>. The vast majority diagnoses come from the F category, which represents mental and behavioral disorders, although there are also few references to the G category, which classifies diseases of the nervous system. Further, note that while some levels of the <code>diagnosis</code> variable represent a singular ICD-10 diagnosis (e.g.¬†<code>f10</code>), others represent a range of diagnoses (e.g.¬†<code>f11-f19</code>), a union (e.g.¬†<code>f0 and g30</code>), or an exclusive difference (e.g.¬†<code>f4 without f42</code>).</p>
<p>Importantly, some of the codes also represent a range of diagnoses <em>implicitly</em>. For instance, whereas <code>f10</code> code refers to the F10 diagnosis (alcohol-use disorders), the part <code>f4</code> in <code>f4 without f42</code> does <em>not</em> refer to the F04 diagnosis (organic amnesic syndrome, not induced by alcohol and other psychoactive substances) but instead to the F40-F48 range of diagnoses <span class="citation">(neurotic, stress-related and somatoform disorders, <a href="#ref-icd2024a">World Health Organization 2024a</a>)</span>. Likewise, <code>f2</code> represents F20-F29 (schizophrenia, schizotypal and delusional disorders), <code>f7</code> represents F70-F79 (mental retardation), and <code>f5</code> represents F50-F59 (behavioural syndromes associated with physiological disturbances and physical factors). I have confirmed this via personal communication with the data set‚Äôs authors <span class="citation">(<a href="#ref-melicharova2025">Melicharov√° 2025</a>)</span>.</p>
<p>Table <a href="applied-example.html#tab:icd10">8.2</a> lists codes used in the data, in order of their prevalence (the number of all cases across all time), along with a short description based on the ICD-10 <span class="citation">(<a href="#ref-icd2024a">World Health Organization 2024a</a>)</span>, and some clarifying notes in parentheses that I myself have added:</p>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:icd10">Table 8.2: </span>The data diagnosis code and ICD-10 description
</caption>
<thead>
<tr>
<th style="text-align:left;">
Code
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
f10
</td>
<td style="text-align:left;">
Mental and behavioural disorders due to use of alcohol
</td>
</tr>
<tr>
<td style="text-align:left;">
f2
</td>
<td style="text-align:left;">
Schizophrenia, schizotypal and delusional disorders (f20-f29)
</td>
</tr>
<tr>
<td style="text-align:left;">
f0 and g30
</td>
<td style="text-align:left;">
Dementia in Alzheimer‚Äôs disease (f0), Alzheimer‚Äôs disease (g30)
</td>
</tr>
<tr>
<td style="text-align:left;">
f4 without f42
</td>
<td style="text-align:left;">
Neurotic, stress-related and somatoform disorders (f40-f48; includes e.g.¬†specific phobias, generalized anxiety disorder, and post-traumatic stress disorder), without obsessive-compulsive disorder (f42)
</td>
</tr>
<tr>
<td style="text-align:left;">
f11-f19
</td>
<td style="text-align:left;">
Mental and behavioural disorders due to psychoactive substance use (excluding alcohol use, f10)
</td>
</tr>
<tr>
<td style="text-align:left;">
f8‚Äìf9
</td>
<td style="text-align:left;">
Disorders of psychological development (f80-f89), behavioural and emotional disorders with onset usually occurring in childhood and adolescence (f90-f98) and unspecified mental disorder (f99)
</td>
</tr>
<tr>
<td style="text-align:left;">
f32‚Äìf33
</td>
<td style="text-align:left;">
Depressive episode (f32), recurrent depressive disorder (f33)
</td>
</tr>
<tr>
<td style="text-align:left;">
f60‚Äìf61
</td>
<td style="text-align:left;">
Specific personality disorders (f60; includes e.g.¬†paranoid, schizoid, histrionic, or anxious/avoidant personality disorders), mixed and other personality disorders (f61)
</td>
</tr>
<tr>
<td style="text-align:left;">
f7
</td>
<td style="text-align:left;">
Mental retardation (f70-f79)
</td>
</tr>
<tr>
<td style="text-align:left;">
f3 without f32 &amp; f33
</td>
<td style="text-align:left;">
Mood [affective] disorders (f30-f39) without depressive episode (f32) and recurrent depressive disorder (f33)
</td>
</tr>
<tr>
<td style="text-align:left;">
f62‚Äìf69
</td>
<td style="text-align:left;">
Personality and behavioral disorders (includes things such as PTSD, habit and impulse disorders, sexual preference disorders, etc‚Ä¶)
</td>
</tr>
<tr>
<td style="text-align:left;">
f5
</td>
<td style="text-align:left;">
Behavioural syndromes associated with physiological disturbances and physical factors (f50-f59; includes eating disorders, sleep disorders, sexual dysfunction disorders, and others)
</td>
</tr>
<tr>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
f42
</td>
<td style="text-align:left;">
Obsessive-compulsive disorder
</td>
</tr>
</tbody>
</table>
<p>To explore the prevalence of the various diagnoses as well as their demographic characteristics, we create another interactive figure. For this figure, I decided to plot the following variables: <code>diagnosis</code>, <code>age_category</code>, <code>sex</code>, and <code>reason_for_termination</code>. These seemed like the most interesting demographic variables. The <code>region</code> variable could also be an interesting choice, however, initial exploration did not reveal any interesting trends so I decided to omit it.</p>
<p>From now on, I will describe interesting features of the data in text rather than through individual figures. You are encouraged to verify these findings by interacting with the figures and using the techniques discussed so far.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="applied-example.html#cb135-1" tabindex="-1"></a><span class="co"># Create ordering for barplots based on frequency</span></span>
<span id="cb135-2"><a href="applied-example.html#cb135-2" tabindex="-1"></a>order_df <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(cases <span class="sc">~</span> diagnosis, sum, <span class="at">data =</span> df)</span>
<span id="cb135-3"><a href="applied-example.html#cb135-3" tabindex="-1"></a>order_df <span class="ot">&lt;-</span> order_df[<span class="fu">order</span>(order_df<span class="sc">$</span>cases), ]</span>
<span id="cb135-4"><a href="applied-example.html#cb135-4" tabindex="-1"></a></span>
<span id="cb135-5"><a href="applied-example.html#cb135-5" tabindex="-1"></a>order_df2 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(cases <span class="sc">~</span> reason_for_termination, sum, <span class="at">data =</span> df)</span>
<span id="cb135-6"><a href="applied-example.html#cb135-6" tabindex="-1"></a>order_df2 <span class="ot">&lt;-</span> order_df2[<span class="fu">order</span>(order_df2<span class="sc">$</span>cases), ]</span>
<span id="cb135-7"><a href="applied-example.html#cb135-7" tabindex="-1"></a></span>
<span id="cb135-8"><a href="applied-example.html#cb135-8" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb135-9"><a href="applied-example.html#cb135-9" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span></span>
<span id="cb135-10"><a href="applied-example.html#cb135-10" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;diagnosis&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb135-11"><a href="applied-example.html#cb135-11" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;age_category&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb135-12"><a href="applied-example.html#cb135-12" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb135-13"><a href="applied-example.html#cb135-13" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;reason_for_termination&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb135-14"><a href="applied-example.html#cb135-14" tabindex="-1"></a>  <span class="co"># Sort the bars by prevalence (can also do interactively by pressing `O` key)</span></span>
<span id="cb135-15"><a href="applied-example.html#cb135-15" tabindex="-1"></a>  <span class="fu">set_scale</span>(<span class="st">&quot;barplot1&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="at">breaks =</span> order_df<span class="sc">$</span>diagnosis) <span class="sc">|&gt;</span> </span>
<span id="cb135-16"><a href="applied-example.html#cb135-16" tabindex="-1"></a>  <span class="fu">set_scale</span>(<span class="st">&quot;barplot4&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="at">breaks =</span> order_df2<span class="sc">$</span>reason_for_termination) <span class="sc">|&gt;</span> </span>
<span id="cb135-17"><a href="applied-example.html#cb135-17" tabindex="-1"></a>  <span class="fu">render</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:example-cases-diagnosis"></span>
<iframe src="./figures/example-cases-diagnosis.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p class="caption">
Figure 8.4: Majority of patient load was taken up by the top five most common disorders: alcohol-use disorders, schizophrenia, Alzheimer‚Äôs disease, neurotic and stress-related disorders, and psychoactive substance disorders.
</p>
</div>
<p>The barplot in the top left panel of the Figure <a href="applied-example.html#fig:example-cases-diagnosis">8.4</a> shows that the five most common disorders accounted for the majority of patient cases. Each of these disorders affected over 40,000 patients between 2010 and 2022, representing over 75% of all cases (319,557 out of 414,242).</p>
<blockquote>
<p>Press the <code>Q</code> key and hover over the bars in the top left panel of Figure <a href="applied-example.html#fig:example-cases-diagnosis">8.4</a> to see what diagnosis each represents.</p>
</blockquote>
<p>In order of prevalence, the top five disorders were, were: alcohol-use disorders, schizophrenia, Alzheimer‚Äôs disease, neurotic and stress-related disorders, and disorders caused by psychoactive substances (excluding alcohol). Overall, the high prevalence of these disorders is fairly, given that their high socio-economic impact is well-known to psychiatrists. Nevertheless, it may be illustrative to take a closer look at this data and examine demographic trends.</p>
<p>First, alcohol use disorders were the most common diagnosis. This is not surprising, since, globally, alcohol use disorders rank among the most common disorders and are associated with high mortality due to chronic health conditions and injury <span class="citation">(<a href="#ref-carvalho2019">Carvalho et al. 2019</a>)</span>. In the data set, this diagnosis was about twice as common in men and showed a fairly symmetric, normal-shaped age distribution, occurring the most frequently in 40-49 and 50-59 year-olds (this can be seen by selecting the corresponding bar in the top-left panel of figure Figure <a href="applied-example.html#fig:example-cases-diagnosis">8.4</a> and normalizing the age-category barplot).</p>
<p>The second most prevalent category of diagnoses were schizophrenia, schizotypal, and delusional disorders. While the individual lifetime prevalence of schizophrenia is not as high as some other disorders on this list, the reason for its high representation in the data set is likely its chronic and serious nature. Among those with mental illness, people with schizophrenia have one of the lowest life expectancies <span class="citation">(see e.g. <a href="#ref-chang2011">C.-K. Chang et al. 2011</a>)</span>, and often require multi-year or even life-long hospitalization <span class="citation">(<a href="#ref-messias2007">Messias, Chen, and Eaton 2007</a>)</span>. This debilitating nature of schizophrenia has prompted some experts to describe it as ‚Äúarguably one of the most severe health conditions affecting mankind‚Äù <span class="citation">(see e.g. <a href="#ref-messias2007">Messias, Chen, and Eaton 2007</a>; <a href="#ref-tandon2024">Tandon et al. 2024</a>)</span>. In the data set at hand, schizophrenic disorders had a fairly balanced sex ratio and a fairly flat age distribution.</p>
<p>Third most prevalent disorder categories was Alzheimer‚Äôs disease. The high prevalence of this disorder is unfortunately also to be expected, as, in developed countries, Alzheimer‚Äôs disease tends the leading cause of long-term psychiatric care in old age <span class="citation">(see e.g. <a href="#ref-cao2020">Cao et al. 2020</a>; <a href="#ref-langa2017">Langa et al. 2017</a>)</span>. It also tends to be more prevalent in women. These patterns could be seen fairly well in the data set: the age distribution of Alzheimer‚Äôs disease was strongly skewed, occurring much more frequently in older patients (and, in fact, making up the majority of &gt;70 year-old patients), and the diagnosis was about ~40% more prevalent in women than in men. We can also see that Alzheimer‚Äôs patient made up the vast majority of patients who had died in care, further reinforcing its status as a disease of old age.</p>
<p>The fourth most prevalent category of disorders were neurotic, stress-related, and somatoform disorders (excluding the obsessive-compulsive disorder, F42) which was classified as its own category in the data set. This category includes disorders such as specific phobias, generalized anxiety disorder, and the post-traumatic stress disorder <span class="citation">(<a href="#ref-icd2024a">World Health Organization 2024a</a>)</span>. These disorders are known to be relatively common, occur roughly twice as often in women as in men, and have a generally even age distribution, with decline in prevalence in older age <span class="citation">(<a href="#ref-bandelow2015">Bandelow and Michaelis 2015</a>)</span>. This pattern could be seen well in the data set, with women making up the majority of the cases and the age distribution being fairly uniform, until a drop-off starting at about 60-69 years of age. In fact, these disorders were the most common diagnosis for women under 40:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="applied-example.html#cb136-1" tabindex="-1"></a>df<span class="sc">$</span>age_category_n <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(df<span class="sc">$</span>age_category, <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb136-2"><a href="applied-example.html#cb136-2" tabindex="-1"></a>under_40 <span class="ot">&lt;-</span> <span class="fu">unique</span>(df<span class="sc">$</span>age_category_n[df<span class="sc">$</span>age_category <span class="sc">==</span> <span class="st">&quot;30‚Äì39&quot;</span>])</span>
<span id="cb136-3"><a href="applied-example.html#cb136-3" tabindex="-1"></a></span>
<span id="cb136-4"><a href="applied-example.html#cb136-4" tabindex="-1"></a><span class="fu">subset</span>(df, sex <span class="sc">==</span> <span class="st">&quot;female&quot;</span> <span class="sc">&amp;</span> age_category_n <span class="sc">&lt;=</span> under_40) <span class="sc">|&gt;</span></span>
<span id="cb136-5"><a href="applied-example.html#cb136-5" tabindex="-1"></a>  (\(x) <span class="fu">aggregate</span>(cases <span class="sc">~</span> diagnosis, sum, <span class="at">data =</span> x))() <span class="sc">|&gt;</span></span>
<span id="cb136-6"><a href="applied-example.html#cb136-6" tabindex="-1"></a>  (\(x) x[<span class="fu">order</span>(<span class="sc">-</span>x<span class="sc">$</span>cases), ])() <span class="sc">|&gt;</span></span>
<span id="cb136-7"><a href="applied-example.html#cb136-7" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">align =</span> <span class="st">&quot;ll&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">diagnosis</th>
<th align="left">cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">f4 without f42</td>
<td align="left">12599</td>
</tr>
<tr class="even">
<td align="left">f2</td>
<td align="left">11783</td>
</tr>
<tr class="odd">
<td align="left">f11‚Äìf19</td>
<td align="left">10722</td>
</tr>
<tr class="even">
<td align="left">f8‚Äìf9</td>
<td align="left">6882</td>
</tr>
<tr class="odd">
<td align="left">f10</td>
<td align="left">6880</td>
</tr>
</tbody>
</table>
<p>The fifth and final of the top five diagnoses were disorders due to use of psychoactive substances. This finding is also not particularly surprising, since, among European countries, Czechia ranks moderately high in consumption psychoactive substances, particularly ecstasy and cannabis <span class="citation">(<a href="#ref-mounteney2016">Mounteney et al. 2016</a>)</span>. By contrast to some of the earlier categories, this diagnosis was significantly more common in males and in young people, showing a skewed age distribution with peak in the 20-29 category. Interestingly, the patients in this category also made up a fairly high proportion of those who had their care terminated early. It is hard to say what this means exactly (a more detailed coding schema for this variable is not available), however, other disorders with high proportion of early terminations included personality disorders (F60-F61 and F62-F69), suggesting that perhaps some patients may be released from care early because of serious behavioral problems.</p>
<p>Overall, the high prevalence of the top five diagnoses seemed to stem from their broad scope which encompassed a wide range of disorders. For instance, alcohol and other psychoactive substance use disorders can manifest in diverse symptoms, including dependence, psychosis, and amnesic syndrome <span class="citation">(<a href="#ref-icd2024a">World Health Organization 2024a</a>)</span>. Similarly, as was mentioned above, the stress-related diagnosis covers a broad spectrum of conditions. Alzheimer‚Äôs disease was one notable exception, representing a fairly specific diagnosis with well-established physiological markers such as the presence of amyloid plaques and neurofibrillary tangles <span class="citation">(see e.g. <a href="#ref-deture2019">DeTure and Dickson 2019</a>)</span>. It could be the case that, under a different classification scheme, Alzheimer‚Äôs disease would be the most prevalent disorder.</p>
<p>Regardless, the diagnoses which followed the top five tended to be more specific, generally encompassing only one or two ICD-10 codes. Such was the case, for example, for depressive episode and recurrent depressive disorder (F32-F33), specific and mixed personality disorders (F60-F61), and so on. While it could be the case that these disorders would rank higher if some of the top five diagnoses were more granular as well, it is also possible that these disorders require less long-term care due to being more amenable to outpatient treatment methods <span class="citation">(see e.g. <a href="#ref-roiser2012">Roiser, Elliott, and Sahakian 2012</a>)</span>.</p>
</div>
<div id="prevalence-of-diagnoses-over-time" class="section level4 hasAnchor" number="8.0.2.5">
<h4><span class="header-section-number">8.0.2.5</span> Prevalence of diagnoses over time<a href="applied-example.html#prevalence-of-diagnoses-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can also scrutinize the prevalence of different mental disorders over time. Again, we need to distinguish between the number of cases versus the number of days patients spent in care. We can use the following figure:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="applied-example.html#cb137-1" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb137-2"><a href="applied-example.html#cb137-2" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span></span>
<span id="cb137-3"><a href="applied-example.html#cb137-3" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;diagnosis&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb137-4"><a href="applied-example.html#cb137-4" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb137-5"><a href="applied-example.html#cb137-5" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;days&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb137-6"><a href="applied-example.html#cb137-6" tabindex="-1"></a>  <span class="fu">set_layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb137-7"><a href="applied-example.html#cb137-7" tabindex="-1"></a>  <span class="fu">set_scale</span>(<span class="st">&quot;barplot1&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="at">breaks =</span> order_df<span class="sc">$</span>diagnosis) <span class="sc">|&gt;</span></span>
<span id="cb137-8"><a href="applied-example.html#cb137-8" tabindex="-1"></a>  <span class="fu">render</span>()</span></code></pre></div>
<iframe src="./figures/example-cases-diagnosis-time.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p>Overall, over time, the proportion of both cases and days in treatment the various diagnoses made up seemed to remain fairly constant, with perhaps a slight general decreasing trend in the number of cases. Of the top five diagnoses, the one which seemed to buck this trend was schizophrenia (F20-F29), which had a fairly marked increasing trend in the proportion of days. Furthermore, the number of cases related to psychoactive substance use disorders (excluding alcohol) seemed to also be rising slightly.</p>
<p>Of the rarer disorders, the one in which there seemed to be a significant relative rise in both the proportion of cases and days in treatment were mental and behavioral disorders associated with physiological disturbances and physical factors (F50-F59). This category includes disorders such as anorexia, bulimia, sleep disorders, and sexual dysfunction disorders. Given that this category was more prevalent in women and young people (as can be seen by interrogating Figure <a href="applied-example.html#fig:example-cases-diagnosis">8.4</a>), the likely explanation for this trend is rise in the number of cases of anorexia and bulimia. There also seemed to be slight of a decrease in the number of days spent in treatment by patients with stress-related disorders (F40-F49 without F42) and depression disorders (F32 and F33).</p>
<p>We can quickly verify these findings by fitting simple linear regressions for each diagnosis. First, we can model the number of cases by year:</p>
<table class="table" style="color: black; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:cases-by-year">Table 8.3: </span><span id="tab:cases-by-year">Table 8.4: </span>Simple linear regressions of the number of cases by year for each diagnosis
</caption>
<thead>
<tr>
<th style="text-align:left;">
diagnosis
</th>
<th style="text-align:left;">
beta
</th>
<th style="text-align:left;">
lower 95% CI
</th>
<th style="text-align:left;">
upper 95% CI
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
f10
</td>
<td style="text-align:left;color: red !important;">
-0.09
</td>
<td style="text-align:left;color: red !important;">
-0.16
</td>
<td style="text-align:left;color: red !important;">
-0.02
</td>
<td style="text-align:left;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
f2
</td>
<td style="text-align:left;color: red !important;">
-0.26
</td>
<td style="text-align:left;color: red !important;">
-0.34
</td>
<td style="text-align:left;color: red !important;">
-0.19
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f0 and g30
</td>
<td style="text-align:left;color: red !important;">
-0.12
</td>
<td style="text-align:left;color: red !important;">
-0.19
</td>
<td style="text-align:left;color: red !important;">
-0.05
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f4 without f42
</td>
<td style="text-align:left;color: red !important;">
-0.26
</td>
<td style="text-align:left;color: red !important;">
-0.35
</td>
<td style="text-align:left;color: red !important;">
-0.17
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f11‚Äìf19
</td>
<td style="text-align:left;color: red !important;">
-0.08
</td>
<td style="text-align:left;color: red !important;">
-0.14
</td>
<td style="text-align:left;color: red !important;">
-0.02
</td>
<td style="text-align:left;">
0.014
</td>
</tr>
<tr>
<td style="text-align:left;">
f8‚Äìf9
</td>
<td style="text-align:left;color: black !important;">
0.14
</td>
<td style="text-align:left;color: red !important;">
-0.22
</td>
<td style="text-align:left;color: black !important;">
0.49
</td>
<td style="text-align:left;">
0.449
</td>
</tr>
<tr>
<td style="text-align:left;">
f32‚Äìf33
</td>
<td style="text-align:left;color: red !important;">
-0.11
</td>
<td style="text-align:left;color: red !important;">
-0.15
</td>
<td style="text-align:left;color: red !important;">
-0.07
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f60‚Äìf61
</td>
<td style="text-align:left;color: red !important;">
-0.13
</td>
<td style="text-align:left;color: red !important;">
-0.18
</td>
<td style="text-align:left;color: red !important;">
-0.09
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f7
</td>
<td style="text-align:left;color: red !important;">
-0.10
</td>
<td style="text-align:left;color: red !important;">
-0.15
</td>
<td style="text-align:left;color: red !important;">
-0.05
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f3 without f32&amp;f33
</td>
<td style="text-align:left;color: red !important;">
-0.07
</td>
<td style="text-align:left;color: red !important;">
-0.10
</td>
<td style="text-align:left;color: red !important;">
-0.04
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f62‚Äìf69
</td>
<td style="text-align:left;color: red !important;">
-0.09
</td>
<td style="text-align:left;color: red !important;">
-0.12
</td>
<td style="text-align:left;color: red !important;">
-0.06
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f5
</td>
<td style="text-align:left;color: black !important;">
0.11
</td>
<td style="text-align:left;color: black !important;">
0.04
</td>
<td style="text-align:left;color: black !important;">
0.17
</td>
<td style="text-align:left;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;color: red !important;">
-0.02
</td>
<td style="text-align:left;color: red !important;">
-0.04
</td>
<td style="text-align:left;color: red !important;">
-0.01
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f42
</td>
<td style="text-align:left;color: black !important;">
0.01
</td>
<td style="text-align:left;color: black !important;">
0.00
</td>
<td style="text-align:left;color: black !important;">
0.03
</td>
<td style="text-align:left;">
0.127
</td>
</tr>
</tbody>
</table>
<p>As we can see in Table <a href="#tab:prevalence-over-time"><strong>??</strong></a>, for most diagnoses, there seemed to be a decreasing trend in the number of cases over time. The only diagnosis for which the number of cases was significantly <em>increasing</em> over time was F50-F59, confirming the observations made in the interactive figure.</p>
<p>We can do the same for the number of days by year:</p>
<table class="table" style="color: black; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:days-by-year">Table 8.5: </span><span id="tab:days-by-year">Table 8.6: </span>Simple linear regressions of the number of days by year for each diagnosis
</caption>
<thead>
<tr>
<th style="text-align:left;">
diagnosis
</th>
<th style="text-align:left;">
beta
</th>
<th style="text-align:left;">
lower 95% CI
</th>
<th style="text-align:left;">
upper 95% CI
</th>
<th style="text-align:left;">
p-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
f10
</td>
<td style="text-align:left;color: black !important;">
5.02
</td>
<td style="text-align:left;color: black !important;">
1.16
</td>
<td style="text-align:left;color: black !important;">
8.88
</td>
<td style="text-align:left;">
0.011
</td>
</tr>
<tr>
<td style="text-align:left;">
f2
</td>
<td style="text-align:left;color: black !important;">
41.70
</td>
<td style="text-align:left;color: black !important;">
32.02
</td>
<td style="text-align:left;color: black !important;">
51.39
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f0 and g30
</td>
<td style="text-align:left;color: black !important;">
27.48
</td>
<td style="text-align:left;color: black !important;">
19.94
</td>
<td style="text-align:left;color: black !important;">
35.02
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f4 without f42
</td>
<td style="text-align:left;color: red !important;">
-3.79
</td>
<td style="text-align:left;color: red !important;">
-6.44
</td>
<td style="text-align:left;color: red !important;">
-1.14
</td>
<td style="text-align:left;">
0.005
</td>
</tr>
<tr>
<td style="text-align:left;">
f11‚Äìf19
</td>
<td style="text-align:left;color: black !important;">
3.89
</td>
<td style="text-align:left;color: black !important;">
1.07
</td>
<td style="text-align:left;color: black !important;">
6.71
</td>
<td style="text-align:left;">
0.007
</td>
</tr>
<tr>
<td style="text-align:left;">
f8‚Äìf9
</td>
<td style="text-align:left;color: black !important;">
0.72
</td>
<td style="text-align:left;color: red !important;">
-17.25
</td>
<td style="text-align:left;color: black !important;">
18.69
</td>
<td style="text-align:left;">
0.937
</td>
</tr>
<tr>
<td style="text-align:left;">
f32‚Äìf33
</td>
<td style="text-align:left;color: red !important;">
-4.32
</td>
<td style="text-align:left;color: red !important;">
-6.41
</td>
<td style="text-align:left;color: red !important;">
-2.23
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f60‚Äìf61
</td>
<td style="text-align:left;color: black !important;">
1.00
</td>
<td style="text-align:left;color: red !important;">
-1.64
</td>
<td style="text-align:left;color: black !important;">
3.64
</td>
<td style="text-align:left;">
0.456
</td>
</tr>
<tr>
<td style="text-align:left;">
f7
</td>
<td style="text-align:left;color: black !important;">
21.70
</td>
<td style="text-align:left;color: black !important;">
15.50
</td>
<td style="text-align:left;color: black !important;">
27.89
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f3 without f32&amp;f33
</td>
<td style="text-align:left;color: red !important;">
-1.84
</td>
<td style="text-align:left;color: red !important;">
-4.08
</td>
<td style="text-align:left;color: black !important;">
0.40
</td>
<td style="text-align:left;">
0.107
</td>
</tr>
<tr>
<td style="text-align:left;">
f62‚Äìf69
</td>
<td style="text-align:left;color: black !important;">
26.18
</td>
<td style="text-align:left;color: black !important;">
19.37
</td>
<td style="text-align:left;color: black !important;">
32.99
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f5
</td>
<td style="text-align:left;color: black !important;">
6.40
</td>
<td style="text-align:left;color: black !important;">
3.32
</td>
<td style="text-align:left;color: black !important;">
9.47
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;color: black !important;">
16.54
</td>
<td style="text-align:left;color: black !important;">
9.69
</td>
<td style="text-align:left;color: black !important;">
23.40
</td>
<td style="text-align:left;">
&lt; 0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
f42
</td>
<td style="text-align:left;color: black !important;">
3.23
</td>
<td style="text-align:left;color: black !important;">
0.19
</td>
<td style="text-align:left;color: black !important;">
6.26
</td>
<td style="text-align:left;">
0.037
</td>
</tr>
</tbody>
</table>
<p>Here, the situation was a bit more varied. For most diagnoses, the number of days patients spent in care seemed to increase, with particularly large increases being observed for schizophrenia (F20-F29), Alzheimer‚Äôs disease (F02 and G30), mental retardation (F70-F79), and personality disorders (F62-F69). The two diagnosis for which the number of days in treatment actually decreased were, interestingly, stress-related disorders (F40-F49 without F42) and depression disorders (F32 and F33).</p>
</div>
<div id="characteristics-of-patient-cohorts-over-time" class="section level4 hasAnchor" number="8.0.2.6">
<h4><span class="header-section-number">8.0.2.6</span> Characteristics of patient cohorts over time<a href="applied-example.html#characteristics-of-patient-cohorts-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>One final things we are going to investigate are characteristics of patient cohorts. Specifically, given that each row of data represents one patient cohort within a given year, of a given sex, diagnosis, and so on, we can investigate whether there were any interesting patterns within the patient cohorts over time. One way we can do this is via the following figure:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="applied-example.html#cb138-1" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb138-2"><a href="applied-example.html#cb138-2" tabindex="-1"></a>  <span class="fu">create_schema</span>() <span class="sc">|&gt;</span></span>
<span id="cb138-3"><a href="applied-example.html#cb138-3" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;diagnosis&quot;</span>, <span class="st">&quot;cases&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb138-4"><a href="applied-example.html#cb138-4" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;cases&quot;</span>), <span class="fu">list</span>(<span class="at">reducer =</span> <span class="st">&quot;max&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb138-5"><a href="applied-example.html#cb138-5" tabindex="-1"></a>  <span class="fu">add_barplot</span>(<span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;days&quot;</span>), <span class="fu">list</span>(<span class="at">reducer =</span> <span class="st">&quot;max&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb138-6"><a href="applied-example.html#cb138-6" tabindex="-1"></a>  <span class="fu">set_scale</span>(<span class="st">&quot;barplot1&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="at">breaks =</span> order_df<span class="sc">$</span>diagnosis) <span class="sc">|&gt;</span></span>
<span id="cb138-7"><a href="applied-example.html#cb138-7" tabindex="-1"></a>  <span class="fu">set_layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb138-8"><a href="applied-example.html#cb138-8" tabindex="-1"></a>  <span class="fu">render</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:example-cases-diagnosis-max"></span>
<iframe src="./figures/example-cases-diagnosis-max.html" width="100%" height="400px" data-external="1" style="border: none;">
</iframe>
<p class="caption">
Figure 8.5: While Alzheimer‚Äôs patients accounted for the longest hospitalized cohorts prior to 2016, following 2016, the longest hospitalized cohorts tended to be schizophrenia patients.
</p>
</div>
<p>In Figure <a href="applied-example.html#fig:example-cases-diagnosis-max">8.5</a>, I show plots of diagnoses, as well as a summary of days and cases over time. However, note that, whereas all barplots of days and cases over time shown before had sum (of cases and days) as the y-axis summary statistic, the two barplots in the lower half of figure Figure <a href="applied-example.html#fig:example-cases-diagnosis-max">8.5</a> show maximum, not sum. These plots effectively tell us the size and the number of days in treatment for the largest/longest hospitalized patient cohort within a given year. Based on theory in Section <a href="problems.html#problems">4</a>, we know that these plots will behave well under linked selection (with one selection group).</p>
<p>By investigating the diagnoses, we can discover some interesting trends in the patient cohorts. Specifically, by comparing the schizophrenia (F20-F29) and the Alzheimer‚Äôs disease diagnoses (F0 and G30), we can see that they show a complementary trend in the maximum number of days hospitalized. Specifically, whereas Alzheimer‚Äôs disease generally accounted for the longest-hospitalized patient cohorts up until 2016, schizophrenia accounted for the longest-hospitalized patient cohorts for five of the six years following 2016 (excluding 2020, where Alzheimer‚Äôs disease narrowly beat it out). This occurred despite schizophrenia patient cohorts shrinking in size over time and the fact that Alzheimer‚Äôs disease was more restricted in terms of age-range, so we would naturally expect larger cohorts (due to ‚Äúlumping‚Äù). On that note, developmental disorders (F80-F99), despite the making up only a small proportion of the total number cases, made up many of the largest patients cohorts year over year. This is understandable given that these patients came almost exclusively from the youngest age group and were otherwise relatively homogeneous.</p>
</div>
</div>
<div id="summary" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Summary<a href="applied-example.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I have used the Long-term Care data set <span class="citation">(<a href="#ref-soukupova2023">Soukupov√° et al. 2023</a>)</span> to demonstrate the typical data analytic workflow using <code>plotscaper</code>. By creating interactive figures and leveraging a suite of interactive features such as linked selection, representation switching, querying, and zooming and panning, we were able to quickly discover many interesting features about the data set, highlighting the usefulness of the package and interactive data visualization in general.</p>
<p>Some key take-away points were:</p>
<ul>
<li>Since 2010, the number of cases has generally decreased, while the number of treatment days has remained constant, suggesting that fewer individuals are receiving long-term psychiatric care, but for longer durations. This suggests a limited placement availability hypothesis, where the healthcare system may be struggling to accommodate new patients due to existing patient load.</li>
<li>The trend of decreasing number of cases and increasing number of days was reversed for children, who represented a growing proportion of patients but a smaller proportion of treatment days over time.</li>
<li>The proportion of treatment days represented by older patients (60-69 and 70-79 year olds) has increased over time, further supporting the limited placement hypothesis, since these patients often require longer care.</li>
<li>There were few patients staying in care for periods of between 2-3 months and 5-7 months, suggesting that there may be potential selection mechanisms influencing hospitalization duration (e.g.¬†administrative reasons).</li>
<li>The five most common diagnoses were, in order: alcohol use disorders, schizophrenia, Alzheimer‚Äôs disease, stress-related disorders, and psychoactive substance use disorders. Patient demographics for these disorders showed some very strong trends which largely aligned with the existing literature.</li>
<li>One diagnostic category which actually shown a significant increase in the number of cases over time were behavioural syndromes associated with physiological disturbances and physical factors. Given that this category includes disorders like anorexia and bulimia, and that the majority of cases were young women, this suggests that, while rare, eating disorders may be on the rise, and should be given attention.</li>
<li>While initially, the longest hospitalized patient cohorts tended to be Alzheimer‚Äôs patients, over time, schizophrenia patients became the longest hospitalized patient cohorts</li>
</ul>

</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bandelow2015" class="csl-entry">
Bandelow, Borwin, and Sophie Michaelis. 2015. <span>‚ÄúEpidemiology of Anxiety Disorders in the 21st Century.‚Äù</span> <em>Dialogues in Clinical Neuroscience</em> 17 (3): 327‚Äì35.
</div>
<div id="ref-cao2020" class="csl-entry">
Cao, Qing, Chen-Chen Tan, Wei Xu, Hao Hu, Xi-Peng Cao, Qiang Dong, Lan Tan, and Jin-Tai Yu. 2020. <span>‚ÄúThe Prevalence of Dementia: A Systematic Review and Meta-Analysis.‚Äù</span> <em>Journal of Alzheimer‚Äôs Disease</em> 73 (3): 1157‚Äì66.
</div>
<div id="ref-carvalho2019" class="csl-entry">
Carvalho, Andre F, Markus Heilig, Augusto Perez, Charlotte Probst, and J√ºrgen Rehm. 2019. <span>‚ÄúAlcohol Use Disorders.‚Äù</span> <em>The Lancet</em> 394 (10200): 781‚Äì92.
</div>
<div id="ref-chang2011" class="csl-entry">
Chang, Chin-Kuo, Richard D Hayes, Gayan Perera, Mathew TM Broadbent, Andrea C Fernandes, William E Lee, Mathew Hotopf, and Robert Stewart. 2011. <span>‚ÄúLife Expectancy at Birth for People with Serious Mental Illness and Other Major Disorders from a Secondary Mental Health Care Case Register in London.‚Äù</span> <em>PloS One</em> 6 (5): e19590.
</div>
<div id="ref-deture2019" class="csl-entry">
DeTure, Michael A, and Dennis W Dickson. 2019. <span>‚ÄúThe Neuropathological Diagnosis of Alzheimer‚Äôs Disease.‚Äù</span> <em>Molecular Neurodegeneration</em> 14 (1): 32.
</div>
<div id="ref-keeley2021" class="csl-entry">
Keeley, Brian. 2021. <span>‚ÄúThe State of the World‚Äôs Children 2021: On My Mind‚ÄìPromoting, Protecting and Caring for Children‚Äôs Mental Health.‚Äù</span> <em>UNICEF</em>.
</div>
<div id="ref-langa2017" class="csl-entry">
Langa, Kenneth M, Eric B Larson, Eileen M Crimmins, Jessica D Faul, Deborah A Levine, Mohammed U Kabeto, and David R Weir. 2017. <span>‚ÄúA Comparison of the Prevalence of Dementia in the United States in 2000 and 2012.‚Äù</span> <em>JAMA Internal Medicine</em> 177 (1): 51‚Äì58.
</div>
<div id="ref-melicharova2025" class="csl-entry">
Melicharov√°, Hana. 2025. Personal email communication.
</div>
<div id="ref-messias2007" class="csl-entry">
Messias, Erick L, Chuan-Yu Chen, and William W Eaton. 2007. <span>‚ÄúEpidemiology of Schizophrenia: Review of Findings and Myths.‚Äù</span> <em>Psychiatric Clinics of North America</em> 30 (3): 323‚Äì38.
</div>
<div id="ref-mounteney2016" class="csl-entry">
Mounteney, Jane, Paul Griffiths, Roumen Sedefov, Andre Noor, Juli√°n Vicente, and Roland Simon. 2016. <span>‚ÄúThe Drug Situation in Europe: An Overview of Data Available on Illicit Drugs and New Psychoactive Substances from European Monitoring in 2015.‚Äù</span> <em>Addiction</em> 111 (1): 34‚Äì48.
</div>
<div id="ref-who2022" class="csl-entry">
Organization, World Health. 2022. <em>World Mental Health Report: Transforming Mental Health for All</em>. World Health Organization.
</div>
<div id="ref-patel2018" class="csl-entry">
Patel, Vikram, Shekhar Saxena, Crick Lund, Graham Thornicroft, Florence Baingana, Paul Bolton, Dan Chisholm, et al. 2018. <span>‚ÄúThe Lancet Commission on Global Mental Health and Sustainable Development.‚Äù</span> <em>The Lancet</em> 392 (10157): 1553‚Äì98.
</div>
<div id="ref-pina2024" class="csl-entry">
Pina, Eduardo, Jos√© Ramos, Henrique Jorge, Paulo V√°z, Jos√© Silva, Cristina Wanzeller, Maryam Abbasi, and Pedro Martins. 2024. <span>‚ÄúData Privacy and Ethical Considerations in Database Management.‚Äù</span> <em>Journal of Cybersecurity and Privacy</em> 4 (3): 494‚Äì517.
</div>
<div id="ref-roiser2012" class="csl-entry">
Roiser, Jonathan P, Rebecca Elliott, and Barbara J Sahakian. 2012. <span>‚ÄúCognitive Mechanisms of Treatment in Depression.‚Äù</span> <em>Neuropsychopharmacology</em> 37 (1): 117‚Äì36.
</div>
<div id="ref-soukupova2023" class="csl-entry">
Soukupov√°, J, H Melicharov√°, O ≈†anca, V Bart≈Ønƒõk, J Jarkovsk√Ω, and M Komenda. 2023. <span>‚Äú<span class="nocase">Dlouhodob√° psychiatrick√° p√©ƒçe</span>.‚Äù</span> <em>NZIP</em>. <a href="https://www.nzip.cz/data/2060-dlouhodoba-psychiatricka-pece">https://www.nzip.cz/data/2060-dlouhodoba-psychiatricka-pece</a>.
</div>
<div id="ref-tandon2024" class="csl-entry">
Tandon, Rajiv, Henry Nasrallah, Schahram Akbarian, William T Carpenter Jr, Lynn E DeLisi, Wolfgang Gaebel, Michael F Green, et al. 2024. <span>‚ÄúThe Schizophrenia Syndrome, Circa 2024: What We Know and How That Informs Its Nature.‚Äù</span> <em>Schizophrenia Research</em> 264: 1‚Äì28.
</div>
<div id="ref-unwin2008" class="csl-entry">
Unwin, Antony, Martin Theus, and Wolfgang H√§rdle. 2008. <span>‚ÄúExploratory Graphics of a Financial Dataset.‚Äù</span> In <em>Handbook of Data Visualization</em>, 832‚Äì52. Springer Science &amp; Business Media.
</div>
<div id="ref-uzis2024" class="csl-entry">
√öZIS. 2024. <span>‚Äú<span class="nocase">About us - √öZIS ƒåR</span>.‚Äù</span> <a href="https://www.uzis.cz/index-en.php?pg=about-us">https://www.uzis.cz/index-en.php?pg=about-us</a>.
</div>
<div id="ref-icd2024a" class="csl-entry">
World Health Organization. 2024a. <span>‚Äú<span>ICD-10 Version:2019</span>.‚Äù</span> <a href="https://icd.who.int/browse10/2019/en">https://icd.who.int/browse10/2019/en</a>.
</div>
<div id="ref-icd2024b" class="csl-entry">
‚Äî‚Äî‚Äî. 2024b. <span>‚Äú<span class="nocase">International Classification of Diseases (ICD)</span>.‚Äù</span> <a href="https://www.who.int/standards/classifications/classification-of-diseases">https://www.who.int/standards/classifications/classification-of-diseases</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="system.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="discussion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
