[["applied-example.html", "8 Applied example 8.1 Summary", " 8 Applied example Please note that the data set used in this section is fairly large (~70,000 rows) and so this section takes a while to load. This section demonstrates a typical interactive workflow with plotscaper. The goal is to showcase the package’s key features and capabilities by exploring a large, real-world data set, pertaining to a pressing issue: mental health. Mental health is a global concern. In developed nations, mental health disorders are primary contributor to years lived with disability, significantly impacting both the well-being of individuals and the economic productivity of entire countries (Organization 2022). This issue, however, extends beyond developed nations. The global burden of mental health disorders has been steadily rising over the recent decades, a trend which is particularly concerning in low-income countries where access to mental health services is even more limited (Patel et al. 2018). Having had personal experience with friends and relatives impacted by mental health issues, as well as having majored in psychology during my undergraduate studies, I have had a long-standing interest in the topic. It is clear to me that mental health is a key challenge that the world is facing today, and the first step towards solving it will require clearly identifying key trends and patterns. For this reason, I chose to dedicate this section to an exploration of a large longitudinal mental health data set. 8.0.1 About the data set The Institute of Health Information and Statistics of the Czech Republic (IHIS, ÚZIS in Czech) is a government agency established by the Czech Ministry of Health. Its primary responsibility is the collection, processing, and reporting of medical data within the country of Czechia (ÚZIS 2024). Of interest, the institute provides high-quality, open-access medical data, including information about the use and manufacture of pharmaceutics, fiscal and employment records from healthcare facilities, and various epidemiological data sets. The Long-term Care data set (Soukupová et al. 2023) contains longitudinal information about long-term psychiatric care in Czechia. More specifically, it contains aggregated data on individuals released from psychiatric care facilities between 2010 and 2022. It includes information such the region of the treatment facility, the sex of the patients, age category, diagnosis based on the international ICD-10 classification (World Health Organization 2024a, 2024b), the number of hospitalizations, and the total number of days spent in care by the given subset of patients. Here’s the data set at a quick glance: df &lt;- read.csv(&quot;./data/longterm_care.csv&quot;) dplyr::glimpse(df) ## Rows: 68,115 ## Columns: 12 ## $ year &lt;int&gt; 2019, 2016, 2011, 2013, 2019, 2013, 2018, 2017, 2019, 2015, 2018, 2022, 2012,… ## $ region_code &lt;chr&gt; &quot;CZ071&quot;, &quot;CZ064&quot;, &quot;CZ080&quot;, &quot;CZ072&quot;, &quot;CZ080&quot;, &quot;CZ053&quot;, &quot;CZ080&quot;, &quot;CZ031&quot;, &quot;CZ03… ## $ region &lt;chr&gt; &quot;Olomoucký kraj&quot;, &quot;Jihomoravský kraj&quot;, &quot;Moravskoslezský kraj&quot;, &quot;Zlínský kraj&quot;… ## $ sex &lt;chr&gt; &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;female&quot;, &quot;male&quot;, &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;female… ## $ diagnosis &lt;chr&gt; &quot;f10&quot;, &quot;f2&quot;, &quot;f7&quot;, &quot;f4 without f42&quot;, &quot;f60–f61&quot;, &quot;f32–f33&quot;, &quot;f3 without f32&amp;f3… ## $ reason_for_termination &lt;chr&gt; &quot;release&quot;, &quot;early termination&quot;, &quot;early termination&quot;, &quot;early termination&quot;, &quot;tr… ## $ age_category &lt;chr&gt; &quot;40–49&quot;, &quot;30–39&quot;, &quot;30–39&quot;, &quot;40–49&quot;, &quot;50–59&quot;, &quot;40–49&quot;, &quot;60–69&quot;, &quot;0–19&quot;, &quot;70–79… ## $ stay_category &lt;chr&gt; &quot;short&quot;, &quot;medium&quot;, &quot;short&quot;, &quot;short&quot;, &quot;short&quot;, &quot;short&quot;, &quot;medium&quot;, &quot;medium&quot;, &quot;s… ## $ field &lt;chr&gt; &quot;psychiatry&quot;, &quot;psychiatry&quot;, &quot;psychiatry&quot;, &quot;psychiatry&quot;, &quot;psychiatry&quot;, &quot;psychi… ## $ care_category &lt;chr&gt; &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;adult&quot;, &quot;child&quot;, &quot;adul… ## $ cases &lt;int&gt; 13, 3, 2, 3, 1, 2, 2, 32, 2, 2, 1, 12, 1, 1, 2, 9, 18, 1, 1, 1, 1, 3, 1, 8, 1… ## $ days &lt;int&gt; 196, 345, 38, 108, 1, 47, 319, 3813, 120, 256, 151, 574, 49, 210, 3333, 186, … The data contains over 68,000 rows, totaling over 410,000 individual-patient hospitalizations. Each row records the number patients with a particular set of of characteristics released from a treatment facility during a given year, and the number of days the patients spent in treatment in total. In the original version of the data set, the column names as well as the labels of the categorical variables are in Czech. To make the analysis more easily accessible to non-Czech speakers, I took the liberty of translating most of these to English (excluding the region variable). The translation script is available in the thesis repository. Additionally, the data set website contains a JSON schema with a text description of each of the variables (Soukupová et al. 2023). I translated these descriptions as well and provide them below, in Table 8.1: Table 8.1: Schema of the long-term care data set, including the original column names (Czech), as well as translated names and descriptions. Translated name Original name Description year rok The year hospitalization was terminated region_code kraj_kod Region code based on the NUTS 3 classification region kraj_nazev Region where the facility was located sex pohlavi Classification of patients’ sex diagnosis zakladni_diagnoza The primary diagnosis of the psychiatric disorder based on the ICD-10 classification reason_for_termination ukonceni The reason for termination of care age_category vekova_kategorie Classification of patients’ age category stay_category kategorie_delky_hospitalizace Classification of hospitalization based on length: short-term (&lt; 3 months), medium-term (3-6 months), and long-term (6+ months) field obor The field of psychiatric care care_category kategorie_pece Classification of care: child or adult cases pocet_hospitalizaci The total number of cases/hospitalizations in the given subgroup of patients days delka_hospitlizace The total time spent in care, in days (= sum of the number of days all patients in a given subgroup spent in care) Before we go on to explore the data set with interactive figures, there are a couple of things to note about the data set. The first is that the data has been pre-aggregated, such that each row represents the combined number of releases within a given subgroup of patients. For example, the first row indicates that, in the year 2019, 13 women aged 40-49 were released from treatment facilities in Olomoucký kraj (region), after receiving short-term care for F10 ICD-10 diagnosis (mental and behavioural disorders due to alcohol use, World Health Organization 2024a) for a sum total of 196 days: df[1, ] ## year region_code region sex diagnosis reason_for_termination age_category stay_category ## 1 2019 CZ071 Olomoucký kraj female f10 release 40–49 short ## field care_category cases days ## 1 psychiatry adult 13 196 The reason for this aggregation is likely to anonymize the data and reduce the risk of identifying individual patients (see e.g. Pina et al. 2024). However, when creating visualizations, we need to take the fact that each row represents a group of patients into account. For instance, when drawing a barplot, simply plotting row counts would not be appropriate, since that would ignore the size of the patient groups. Instead, to represent the data properly, we should aggregate (sum) either cases or days, depending on the question of interest. The same applies to all other aggregation plots, such as histograms (i.e. weighted histograms, see e.g. Unwin, Theus, and Härdle 2008) and fluctuation diagrams. Fortunately, as we will see, plotscaper makes it easy to create these weighted types visualizations. And further, while the information this aggregated data provides inherently less granular information than patient-level records, we will see that it still preserves a large amount of structure. 8.0.2 Interactive exploration 8.0.2.1 The relationship between cases and days We start by exploring the relationship between the two primary continuous variables of interest: cases (the number of patients in a given subgroup released from care) and days (the total number of days the given subgroup of patients spent in care). Intuitively, we would expect a positive, linear relationship between these variables, such that a larger patient groups should spend more days in care. We can use plotscaper to visualize this relationship via a scatterplot: library(plotscaper) # Load in the package df |&gt; create_schema() |&gt; # Create a declarative schema for the figure add_scatterplot(c(&quot;cases&quot;, &quot;days&quot;)) |&gt; # Add a scatterplot render() # Render the schema into an interactive figure Interestingly, the points did not show a simple linear trend. Instead, they seemed to cluster in three distinct “leaflets”, each exhibiting a roughly linear trend. This suggests the presence of a pooling effect, such that the overall trend is the result of combining three distinct groups. Closer inspection of the data reveals that the stay_category variable has three levels: short-term (&lt; 3 months), medium-term (3-6 months), and long-term (6+ months) care. Color-coding the cases indeed confirms that the three levels of stay_category correspond to the leaflets: df |&gt; create_schema() |&gt; add_scatterplot(c(&quot;cases&quot;, &quot;days&quot;)) |&gt; add_barplot(c(&quot;stay_category&quot;, &quot;cases&quot;)) |&gt; # y-axis is weighted by cases assign_cases(which(df$stay_category == &quot;short-term&quot;), 1) |&gt; # Mark short-term green assign_cases(which(df$stay_category == &quot;long-term&quot;), 2) |&gt; # Mark long-term red render() Try clicking on the bars in the barplot to confirm there is a fairly minimal overlap between the data points in the three categories. To remove all selection, double-click the figure. However, the pooling effect does not itself explain the absence of points between the three leaflets. If the distribution of cases and days within each of the three stay_category levels were uniform, we should expect to see more points within the gaps between the leaflets. This additionally suggests a potential selection process, where patients are less likely to be discharged at durations near the category boundaries. We can confirm this by plotting the average number of days a group of patients spent in care: # Compute the average number of days spent in treatment df$avg_days &lt;- df$days / df$cases df |&gt; create_schema() |&gt; add_scatterplot(c(&quot;cases&quot;, &quot;avg_days&quot;)) |&gt; add_barplot(c(&quot;stay_category&quot;, &quot;cases&quot;)) |&gt; assign_cases(which(df$stay_category == &quot;short-term&quot;), 1) |&gt; assign_cases(which(df$stay_category == &quot;long-term&quot;), 2) |&gt; set_scale(&quot;scatterplot1&quot;, &quot;y&quot;, # Log-transform the scatterplot&#39;s y-axis transformation = &quot;log10&quot;, default = TRUE) |&gt; render() Now we can clearly see the gaps between the three different distributions along the y-axis. Try querying the points near the gaps by pressing the Q key and hovering over them. You should observe that the gaps roughly span the 60-90 day and 150-210 day ranges, corresponding to 2-3 months and 5-7 months, respectively. The trend we see in the scatterplot above strong indication of a selection process is at work. Specifically, it seems that patients who stay in treatment for more than two months are likely to be transferred to medium-term care and kept around for longer, and, likewise, those who stay in treatment for more than five months are likely to be moved to long-term care. There are likely administrative of health-insurance related reasons for this trend, nevertheless, it is still an interesting pattern to take note of. 8.0.2.2 Number of cases over time A key question is how have the numbers of patients in treatment evolved over time. We can investigate this by plotting the same scatterplot as we did in the section above, as well as two barplots showing the total number of cases and the total number days in treatment, within each year. We can also include a histogram of the number of days, for a good measure: schema &lt;- df |&gt; create_schema() |&gt; add_scatterplot(c(&quot;cases&quot;, &quot;days&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;days&quot;)) |&gt; add_histogram(c(&quot;days&quot;, &quot;days&quot;)) |&gt; # Again, make sure to weigh the y-axis set_parameters(&quot;histogram1&quot;, width = 20) # Set histogram binwidth to 20 days schema |&gt; render() From the barplots, we can immediately see an interesting pattern: while the numbers of cases seem to have declined over time, the number of days patients spend in care seem to seems to have stayed fairly constant. This suggest that while fewer patients are being hospitalized, they are spending longer time in care. We can indeed confirm this interactively. Try clicking on the bars corresponding to the year 2010 and 2022, in either of the two barplots (feel free to mark either of the bars by holding down the 1 or 2 keys and clicking them). It is clearly visible that, compared to 2010, in 2022 there were more patients in long term care, and the relationship between the number of cases and the number of days in care was steeper. While, on its own, the declining number of cases over time might appear as a positive development, the constant number days in treatment suggests a more worrying trend. Specifically, treatment facility placements are limited resource (Organization 2022), and the fact that days in treatment have stayed constant while cases have declined may indicate that the healthcare system is becoming burdened by long-term care patients, reducing its capacity to serve new patients. We can also scrutinize the trend more closely by zooming into the histogram: schema |&gt; assign_cases(which(df$year == 2010), 1) |&gt; assign_cases(which(df$year == 2022), 2) |&gt; zoom(&quot;histogram1&quot;, c(-100, 0, 3e03, 1e05), units = &quot;data&quot;) |&gt; render() You can also zoom into a plot interactively by clicking and dragging to select a rectangular region in the plot and pressing the Z key. You can chain multiple zooms to magnify small areas. If you want to undo zooming, press either the X key to undo the revert one level of zoom, or R to reset the figure to its default state (including zoom level). By clicking on the two bars, you should be able to see that, compared with 2010, the distribution of days spent in treatment in 2022 had a fatter tail, suggesting that patients spent longer periods of time in care. 8.0.2.3 Age and child and adolescent mental health Child and adolescent mental health is a particularly important aspect of the global mental health decline. Childhood mental health disorders are particularly concerning since they can happen during critical developmental periods, leading to life-long consequences (see e.g. Keeley 2021). Furthermore, compared to adults, children have less agency in addressing mental health challenges, relying heavily on primary caregivers and schools. Fortunately, the overall proportion of children and adolescents in the data set was fairly low, amounting to &lt;9% of all cases and &lt;6% of the total number of days spent in treatment: aggregate(cbind(cases, days) ~ care_category, sum, data = df) |&gt; lapply(function(x) { if (is.numeric(x)) return(x / sum(x)) else x }) |&gt; data.frame() ## care_category cases days ## 1 adult 0.91028915 0.94285172 ## 2 child 0.08971085 0.05714828 However, we may be interested in investigating how these patient counts have evolved over time. To do this, we can make use of the following figure: # Create a figure layout with two small plots in the left # column, and one tall plot in the right column layout &lt;- matrix(c( 1, 3, 2, 3 ), nrow = 2, byrow = TRUE) df |&gt; create_schema() |&gt; add_barplot(c(&quot;year&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;days&quot;)) |&gt; add_barplot(c(&quot;care_category&quot;, &quot;cases&quot;)) |&gt; set_layout(layout) |&gt; # Set the layout render() To explore how the proportion of child and adolescent patients has evolved over time, we will need to use a slightly more complex interactive workflow than we have used so far. Try taking the following steps: Mark the cases corresponding to children and adolescents by clicking on the corresponding bar in the right barplot, while holding down the 1 key Normalize the two leftmost barplots, corresponding to the number of cases and the total number of days in treatment by year, by clicking on the plots and pressing the N key (you can reverse back to absolute counts by pressing the N key again) Zoom into the regions of the two barplots containing the green cases by clicking-and-dragging to select a rectangular region and pressing the Z key. By following these steps, you should end up with a figure similar to the one below: df |&gt; create_schema() |&gt; add_barplot(c(&quot;year&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;days&quot;)) |&gt; add_barplot(c(&quot;care_category&quot;, &quot;cases&quot;)) |&gt; assign_cases(which(df$care_category == &quot;child&quot;)) |&gt; plotscaper::normalize(&quot;barplot1&quot;) |&gt; plotscaper::normalize(&quot;barplot2&quot;) |&gt; zoom(&quot;barplot1&quot;, c(0, 0, 1, 0.15)) |&gt; zoom(&quot;barplot2&quot;, c(0, 0, 1, 0.15)) |&gt; set_layout(layout) |&gt; render() Interestingly, the two barplots show the opposite trend. While the proportion of the treatment days used by children and adolescents has declined over time, the proportion of total cases they make up has increased. The relative increase in cases appears to be driven by an overall decline in patient numbers: in absolute counts, the number of child and adolescent patients has remained fairly constant between 2010 to 2022, while the total patient count has decreased. We can also get a more granular breakdown by plotting the age category variable: df |&gt; create_schema() |&gt; add_barplot(c(&quot;age_category&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;age_category&quot;, &quot;days&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;days&quot;)) |&gt; render() Again, if we interrogate the figure by employing interactive actions such as selection, zooming, and normalization, we can discover that one age category in which there has been steady growth in both the proportion of cases and days spend in treatment are 70-79 year olds. This aligns with the limited placement availability hypothesis: while these patients account for a relatively small fraction of the total cases, they represent a disproportionately large and increasing proportion of days in treatment. Later, we will also see evidence that many of these patients suffer from neurodegenerative diseases, which require intensive long-term care. It may be the case that, with increasing life-expectancy, the healthcare system is not able to handle the influx of older patients, limiting the availability of placements. 8.0.2.4 Prevalence of diagnoses Another important information we can glean from the data set is the prevalence of different diagnoses and their demographic characteristics. The data set identifies mental disorders according to ICD-10, an internationally recognized disease classification system published by the World Health organization which organizes various diseases into categories based on aetiology (World Health Organization 2024a). It is first necessary to discuss the coding scheme of the diagnoses. The codes were directly translated from the Czech version of the data set (Soukupová et al. 2023). The vast majority diagnoses come from the F category, which represents mental and behavioral disorders, although there are also few references to the G category, which classifies diseases of the nervous system. Further, note that while some levels of the diagnosis variable represent a singular ICD-10 diagnosis (e.g. f10), others represent a range of diagnoses (e.g. f11-f19), a union (e.g. f0 and g30), or an exclusive difference (e.g. f4 without f42). Importantly, some of the codes also represent a range of diagnoses implicitly. For instance, whereas f10 code refers to the F10 diagnosis (alcohol-use disorders), the part f4 in f4 without f42 does not refer to the F04 diagnosis (organic amnesic syndrome, not induced by alcohol and other psychoactive substances) but instead to the F40-F48 range of diagnoses (neurotic, stress-related and somatoform disorders, World Health Organization 2024a). Likewise, f2 represents F20-F29 (schizophrenia, schizotypal and delusional disorders), f7 represents F70-F79 (mental retardation), and f5 represents F50-F59 (behavioural syndromes associated with physiological disturbances and physical factors). I have confirmed this via personal communication with the data set’s authors (Melicharová 2025). Table 8.2 lists codes used in the data, in order of their prevalence (the number of all cases across all time), along with a short description based on the ICD-10 (World Health Organization 2024a), and some clarifying notes in parentheses that I myself have added: Table 8.2: The data diagnosis code and ICD-10 description Code Description f10 Mental and behavioural disorders due to use of alcohol f2 Schizophrenia, schizotypal and delusional disorders (f20-f29) f0 and g30 Dementia in Alzheimer’s disease (f0), Alzheimer’s disease (g30) f4 without f42 Neurotic, stress-related and somatoform disorders (f40-f48; includes e.g. specific phobias, generalized anxiety disorder, and post-traumatic stress disorder), without obsessive-compulsive disorder (f42) f11-f19 Mental and behavioural disorders due to psychoactive substance use (excluding alcohol use, f10) f8–f9 Disorders of psychological development (f80-f89), behavioural and emotional disorders with onset usually occurring in childhood and adolescence (f90-f98) and unspecified mental disorder (f99) f32–f33 Depressive episode (f32), recurrent depressive disorder (f33) f60–f61 Specific personality disorders (f60; includes e.g. paranoid, schizoid, histrionic, or anxious/avoidant personality disorders), mixed and other personality disorders (f61) f7 Mental retardation (f70-f79) f3 without f32 &amp; f33 Mood [affective] disorders (f30-f39) without depressive episode (f32) and recurrent depressive disorder (f33) f62–f69 Personality and behavioral disorders (includes things such as PTSD, habit and impulse disorders, sexual preference disorders, etc…) f5 Behavioural syndromes associated with physiological disturbances and physical factors (f50-f59; includes eating disorders, sleep disorders, sexual dysfunction disorders, and others) other f42 Obsessive-compulsive disorder To explore the prevalence of the various diagnoses as well as their demographic characteristics, we create another interactive figure. For this figure, I decided to plot the following variables: diagnosis, age_category, sex, and reason_for_termination. These seemed like the most interesting demographic variables. The region variable could also be an interesting choice, however, initial exploration did not reveal any interesting trends so I decided to omit it. From now on, I will describe interesting features of the data in text rather than through individual figures. You are encouraged to verify these findings by interacting with the figure, using the various techniques that have been discussed so far. # Create ordering for barplots based on frequency order_df &lt;- aggregate(cases ~ diagnosis, sum, data = df) order_df &lt;- order_df[order(order_df$cases), ] order_df2 &lt;- aggregate(cases ~ reason_for_termination, sum, data = df) order_df2 &lt;- order_df2[order(order_df2$cases), ] df |&gt; create_schema() |&gt; add_barplot(c(&quot;diagnosis&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;age_category&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;sex&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;reason_for_termination&quot;, &quot;cases&quot;)) |&gt; # Sort the bars by prevalence (can also do interactively by pressing `O` key) set_scale(&quot;barplot1&quot;, &quot;x&quot;, breaks = order_df$diagnosis) |&gt; set_scale(&quot;barplot4&quot;, &quot;x&quot;, breaks = order_df2$reason_for_termination) |&gt; render() From the barplot in the top left panel of the Figure ??, we can immediately see that the majority patient load was taken up by the top five most common disorders. There were over 40,000 cases with each of these disorders, and together they made up over 75% of all cases (319,557 out of 414,242). Press the Q key and hover over the bars in the top left panel of Figure ?? to see what disorder each represents. In order of prevalence, the top five disorders were, were: alcohol-use disorders, schizophrenia, Alzheimer’s disease, neurotic and stress-related disorders, and disorders caused by psychoactive substances (excluding alcohol). Overall, the high prevalence of these disorders is fairly, given that their high socio-economic impact is well-known to psychiatrists. Nevertheless, it may be illustrative to take a closer look at this data and examine demographic trends. First, alcohol use disorders were the most common diagnosis. This is not surprising, since, globally, alcohol use disorders rank among the most common disorders and are associated with high mortality due to chronic health conditions and injury (Carvalho et al. 2019). In the data set, this diagnosis was about twice as common in men and showed a fairly symmetric, normal-shaped age distribution, occurring the most frequently in 40-49 and 50-59 year-olds (this can be seen by selecting the corresponding bar in the top-left panel of figure Figure ?? and normalizing the age-category barplot). The second most prevalent category of diagnoses were schizophrenia, schizotypal, and delusional disorders. While the individual lifetime prevalence of schizophrenia is not as high as some other disorders on this list, the reason for its high representation in the data set is likely its chronic and serious nature. Among those with mental illness, people with schizophrenia have one of the lowest life expectancies (see e.g. Chang et al. 2011), and often require multi-year or even life-long hospitalization (Messias, Chen, and Eaton 2007). This debilitating nature of schizophrenia has prompted some experts to describe it as “arguably one of the most severe health conditions affecting mankind” (see e.g. Messias, Chen, and Eaton 2007; Tandon et al. 2024). In the data set at hand, schizophrenic disorders had a fairly balanced sex ratio and a fairly flat age distribution. Third most prevalent disorder categories was Alzheimer’s disease. The high prevalence of this disorder is unfortunately also to be expected, as, in developed countries, Alzheimer’s disease tends the leading cause of long-term psychiatric care in old age (see e.g. Cao et al. 2020; Langa et al. 2017). It also tends to be more prevalent in women. These patterns could be seen fairly well in the data set: the age distribution of Alzheimer’s disease was strongly skewed, occurring much more frequently in older patients (and, in fact, making up the majority of &gt;70 year-old patients), and the diagnosis was about ~40% more prevalent in women than in men. We can also see that Alzheimer’s patient made up the vast majority of patients who had died in care, further reinforcing its status as a disease of old age. The fourth most prevalent category of disorders were neurotic, stress-related, and somatoform disorders (excluding the obsessive-compulsive disorder, F42) which was classified as its own category in the data set. This category includes disorders such as specific phobias, generalized anxiety disorder, and the post-traumatic stress disorder (World Health Organization 2024a). These disorders are known to be relatively common, occur roughly twice as often in women as in men, and have a generally even age distribution, with decline in prevalence in older age (Bandelow and Michaelis 2015). This pattern could be seen well in the data set, with women making up the majority of the cases and the age distribution being fairly uniform, until a drop-off starting at about 60-69 years of age. In fact, these disorders were the most common diagnosis for women under 40: df$age_category_n &lt;- as.numeric(factor(df$age_category, ordered = TRUE)) under_40 &lt;- unique(df$age_category_n[df$age_category == &quot;30–39&quot;]) subset(df, sex == &quot;female&quot; &amp; age_category_n &lt;= under_40) |&gt; (\\(x) aggregate(cases ~ diagnosis, sum, data = x))() |&gt; (\\(x) x[order(-x$cases), ])() |&gt; head(5) |&gt; knitr::kable(align = &quot;ll&quot;, row.names = FALSE) diagnosis cases f4 without f42 12599 f2 11783 f11–f19 10722 f8–f9 6882 f10 6880 The fifth and final of the top five diagnoses were disorders due to use of psychoactive substances. This finding is also not particularly surprising, since, among European countries, Czechia ranks moderately high in consumption psychoactive substances, particularly ecstasy and cannabis (Mounteney et al. 2016). By contrast to some of the earlier categories, this diagnosis was significantly more common in males and in young people, showing a skewed age distribution with peak in the 20-29 category. Interestingly, the patients in this category also made up a fairly high proportion of those who had their care terminated early. It is hard to say what this means exactly (a more detailed coding schema for this variable is not available), however, other disorders with high proportion of early terminations included personality disorders (F60-F61 and F62-F69), suggesting that perhaps some patients may be released from care early because of serious behavioral problems. Overall, the high prevalence of the top five diagnoses seemed to stem from their broad scope which encompassed a wide range of disorders. For instance, alcohol and other psychoactive substance use disorders can manifest in diverse symptoms, including dependence, psychosis, and amnesic syndrome (World Health Organization 2024a). Similarly, as was mentioned above, the stress-related diagnosis covers a broad spectrum of conditions. Alzheimer’s disease was one notable exception, representing a fairly specific diagnosis with well-established physiological markers such as the presence of amyloid plaques and neurofibrillary tangles (see e.g. DeTure and Dickson 2019). It could be the case that, under a different classification scheme, Alzheimer’s disease would be the most prevalent disorder. Regardless, the diagnoses which followed the top five tended to be more specific, generally encompassing only one or two ICD-10 codes. Such was the case, for example, for depressive episode and recurrent depressive disorder (F32-F33), specific and mixed personality disorders (F60-F61), and so on. While it could be the case that these disorders would rank higher if some of the top five diagnoses were more granular as well, it is also possible that these disorders require less long-term care due to being more amenable to outpatient treatment methods (see e.g. Roiser, Elliott, and Sahakian 2012). 8.0.2.5 Prevalence of diagnoses over time We can also scrutinize the prevalence of different mental disorders over time. Again, we need to distinguish between the number of cases versus the number of days patients spent in care. We can use the following figure: df |&gt; create_schema() |&gt; add_barplot(c(&quot;diagnosis&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;days&quot;)) |&gt; set_layout(matrix(c(1, 1, 2, 3), nrow = 2, byrow = TRUE)) |&gt; set_scale(&quot;barplot1&quot;, &quot;x&quot;, breaks = order_df$diagnosis) |&gt; render() Overall, over time, the proportion of both cases and days in treatment the various diagnoses made up seemed to remain fairly constant, with perhaps a slight general decreasing trend in the number of cases. Of the top five diagnoses, the one which seemed to buck this trend was schizophrenia (F20-F29), which had a fairly marked increasing trend in the proportion of days. Furthermore, the number of cases related to psychoactive substance use disorders (excluding alcohol) seemed to also be rising slightly. Of the rarer disorders, the one in which there seemed to be a significant relative rise in both the proportion of cases and days in treatment were mental and behavioral disorders associated with physiological disturbances and physical factors (F50-F59). This category includes disorders such as anorexia, bulimia, sleep disorders, and sexual dysfunction disorders. Given that this category was more prevalent in women and young people (as can be seen by interrogating Figure ??), the likely explanation for this trend is rise in the number of cases of anorexia and bulimia. There also seemed to be slight of a decrease in the number of days spent in treatment by patients with stress-related disorders (F40-F49 without F42) and depression disorders (F32 and F33). We can quickly verify these findings by fitting simple linear regressions for each diagnosis. First, we can model the number of cases by year: Table 8.3: Simple linear regressions of the number of cases by year for each diagnosis diagnosis beta lower 95% CI upper 95% CI p-value f10 -0.09 -0.16 -0.02 0.01 f2 -0.26 -0.34 -0.19 &lt; 0.001 f0 and g30 -0.12 -0.19 -0.05 &lt; 0.001 f4 without f42 -0.26 -0.35 -0.17 &lt; 0.001 f11–f19 -0.08 -0.14 -0.02 0.014 f8–f9 0.14 -0.22 0.49 0.449 f32–f33 -0.11 -0.15 -0.07 &lt; 0.001 f60–f61 -0.13 -0.18 -0.09 &lt; 0.001 f7 -0.10 -0.15 -0.05 &lt; 0.001 f3 without f32&amp;f33 -0.07 -0.10 -0.04 &lt; 0.001 f62–f69 -0.09 -0.12 -0.06 &lt; 0.001 f5 0.11 0.04 0.17 0.001 other -0.02 -0.04 -0.01 &lt; 0.001 f42 0.01 0.00 0.03 0.127 As we can see in Table ??, for most diagnoses, there seemed to be a decreasing trend in the number of cases over time. The only diagnosis for which the number of cases was significantly increasing over time was F50-F59, confirming the observations made in the interactive figure. We can do the same for the number of days by year: Table 8.4: Simple linear regressions of the number of days by year for each diagnosis diagnosis beta lower 95% CI upper 95% CI p-value f10 5.02 1.16 8.88 0.011 f2 41.70 32.02 51.39 &lt; 0.001 f0 and g30 27.48 19.94 35.02 &lt; 0.001 f4 without f42 -3.79 -6.44 -1.14 0.005 f11–f19 3.89 1.07 6.71 0.007 f8–f9 0.72 -17.25 18.69 0.937 f32–f33 -4.32 -6.41 -2.23 &lt; 0.001 f60–f61 1.00 -1.64 3.64 0.456 f7 21.70 15.50 27.89 &lt; 0.001 f3 without f32&amp;f33 -1.84 -4.08 0.40 0.107 f62–f69 26.18 19.37 32.99 &lt; 0.001 f5 6.40 3.32 9.47 &lt; 0.001 other 16.54 9.69 23.40 &lt; 0.001 f42 3.23 0.19 6.26 0.037 Here, the situation was a bit more varied. For most diagnoses, the number of days patients spent in care seemed to increase, with particularly large increases being observed for schizophrenia (F20-F29), Alzheimer’s disease (F02 and G30), mental retardation (F70-F79), and personality disorders (F62-F69). The two diagnosis for which the number of days in treatment actually decreased were, interestingly, stress-related disorders (F40-F49 without F42) and depression disorders (F32 and F33). 8.0.2.6 Characteristics of patient cohorts over time One final things we are going to investigate are characteristics of patient cohorts. Specifically, given that each row of data represents one patient cohort within a given year, of a given sex, diagnosis, and so on, we can investigate whether there were any interesting patterns within the patient cohorts over time. One way we can do this is via the following figure: df |&gt; create_schema() |&gt; add_barplot(c(&quot;diagnosis&quot;, &quot;cases&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;cases&quot;), list(reducer = &quot;max&quot;)) |&gt; add_barplot(c(&quot;year&quot;, &quot;days&quot;), list(reducer = &quot;max&quot;)) |&gt; set_scale(&quot;barplot1&quot;, &quot;x&quot;, breaks = order_df$diagnosis) |&gt; set_layout(matrix(c(1, 1, 2, 3), nrow = 2)) |&gt; render() In Figure ??, I show plots of diagnoses, as well as days and cases. However, note that, whereas all barplots shown before had sum (of cases and days) as the y-axis summary statistic, the two barplots in the lower half of figure Figure ?? show maximum, not sum. These plots effectively tell us the size and the number of days in treatment for the largest/longest hospitalized patient cohort within a given year. Based on theory in Section 4, we know that these plots will behave well under linked selection (with one selection group). By investigating the diagnoses, we can discover some interesting trends in the patient cohorts. Specifically, by comparing the schizophrenia (F20-F29) and the Alzheimer’s disease diagnoses (F0 and G30), we can see that they show a complementary trend in the maximum number of days hospitalized. Specifically, whereas Alzheimer’s disease generally accounted for the longest-hospitalized patient cohorts up until 2016, schizophrenia accounted for the longest-hospitalized patient cohorts for five of the six years following 2016 (excluding 2020, where Alzheimer’s disease narrowly beat it out). This occured despite schizophrenia patient cohorts shrinking in size over time and the fact that Alzheimer’s disease was more restricted in terms of age-range, so we would naturally expect larger cohorts (due to “lumping”). On that note, developmental disorders (F80-F99), despite the making up only a small proportion of the total number cases, made up many of the largest patients cohorts year over year. This is understandable given that these patients came almost exclusively from the youngest age group and were otherwise relatively homogeneous. 8.1 Summary I have used the Long-term Care data set (Soukupová et al. 2023) to demonstrate the typical data analytic workflow using plotscaper. By creating interactive figures and leveraging a suite of interactive features such as linked selection, representation switching, querying, and zooming and panning, we were able to quickly discover many interesting features about the data set, highlighting the usefulness of the package and interactive data visualization in general. Some key take-away points were: Since 2010, the number of cases has generally decreased, while the number of treatment days has remained constant, suggesting that fewer individuals are receiving long-term psychiatric care, but for longer durations. This suggests a limited placement availability hypothesis, where the healthcare system may be struggling to accommodate new patients due to existing patient load. The trend of decreasing number of cases and increasing number of days was reversed for children, who represented a growing proportion of patients but a smaller proportion of treatment days over time. The proportion of treatment days represented by older patients (60-69 and 70-79 year olds) has increased over time, further supporting the limited placement hypothesis, since these patients often require longer care. There were few patients staying in care for periods of between 2-3 months and 5-7 months, suggesting that there may be potential selection mechanisms influencing hospitalization duration (e.g. administrative reasons). The five most common diagnoses were, in order: alcohol use disorders, schizophrenia, Alzheimer’s disease, stress-related disorders, and psychoactive substance use disorders. Patient demographics for these disorders showed some very strong trends which largely aligned with the existing literature. One diagnostic category which actually shown a significant increase in the number of cases over time were behavioural syndromes associated with physiological disturbances and physical factors. Given that this category includes disorders like anorexia and bulimia, and that the majority of cases were young women, this suggests that, while rare, eating disorders may be on the rise, and should be given attention. While initially, the longest hospitalized patient cohorts tended to be Alzheimer’s patients, over time, schizophrenia patients became the longest hospitalized patient cohorts References Bandelow, Borwin, and Sophie Michaelis. 2015. “Epidemiology of Anxiety Disorders in the 21st Century.” Dialogues in Clinical Neuroscience 17 (3): 327–35. Cao, Qing, Chen-Chen Tan, Wei Xu, Hao Hu, Xi-Peng Cao, Qiang Dong, Lan Tan, and Jin-Tai Yu. 2020. “The Prevalence of Dementia: A Systematic Review and Meta-Analysis.” Journal of Alzheimer’s Disease 73 (3): 1157–66. Carvalho, Andre F, Markus Heilig, Augusto Perez, Charlotte Probst, and Jürgen Rehm. 2019. “Alcohol Use Disorders.” The Lancet 394 (10200): 781–92. Chang, Chin-Kuo, Richard D Hayes, Gayan Perera, Mathew TM Broadbent, Andrea C Fernandes, William E Lee, Mathew Hotopf, and Robert Stewart. 2011. “Life Expectancy at Birth for People with Serious Mental Illness and Other Major Disorders from a Secondary Mental Health Care Case Register in London.” PloS One 6 (5): e19590. DeTure, Michael A, and Dennis W Dickson. 2019. “The Neuropathological Diagnosis of Alzheimer’s Disease.” Molecular Neurodegeneration 14 (1): 32. Keeley, Brian. 2021. “The State of the World’s Children 2021: On My Mind–Promoting, Protecting and Caring for Children’s Mental Health.” UNICEF. Langa, Kenneth M, Eric B Larson, Eileen M Crimmins, Jessica D Faul, Deborah A Levine, Mohammed U Kabeto, and David R Weir. 2017. “A Comparison of the Prevalence of Dementia in the United States in 2000 and 2012.” JAMA Internal Medicine 177 (1): 51–58. Melicharová, Hana. 2025. Personal email communication. Messias, Erick L, Chuan-Yu Chen, and William W Eaton. 2007. “Epidemiology of Schizophrenia: Review of Findings and Myths.” Psychiatric Clinics of North America 30 (3): 323–38. Mounteney, Jane, Paul Griffiths, Roumen Sedefov, Andre Noor, Julián Vicente, and Roland Simon. 2016. “The Drug Situation in Europe: An Overview of Data Available on Illicit Drugs and New Psychoactive Substances from European Monitoring in 2015.” Addiction 111 (1): 34–48. Organization, World Health. 2022. World Mental Health Report: Transforming Mental Health for All. World Health Organization. Patel, Vikram, Shekhar Saxena, Crick Lund, Graham Thornicroft, Florence Baingana, Paul Bolton, Dan Chisholm, et al. 2018. “The Lancet Commission on Global Mental Health and Sustainable Development.” The Lancet 392 (10157): 1553–98. Pina, Eduardo, José Ramos, Henrique Jorge, Paulo Váz, José Silva, Cristina Wanzeller, Maryam Abbasi, and Pedro Martins. 2024. “Data Privacy and Ethical Considerations in Database Management.” Journal of Cybersecurity and Privacy 4 (3): 494–517. Roiser, Jonathan P, Rebecca Elliott, and Barbara J Sahakian. 2012. “Cognitive Mechanisms of Treatment in Depression.” Neuropsychopharmacology 37 (1): 117–36. Soukupová, J, H Melicharová, O Šanca, V Bartůněk, J Jarkovský, and M Komenda. 2023. “Dlouhodobá psychiatrická péče.” NZIP. https://www.nzip.cz/data/2060-dlouhodoba-psychiatricka-pece. Tandon, Rajiv, Henry Nasrallah, Schahram Akbarian, William T Carpenter Jr, Lynn E DeLisi, Wolfgang Gaebel, Michael F Green, et al. 2024. “The Schizophrenia Syndrome, Circa 2024: What We Know and How That Informs Its Nature.” Schizophrenia Research 264: 1–28. Unwin, Antony, Martin Theus, and Wolfgang Härdle. 2008. “Exploratory Graphics of a Financial Dataset.” In Handbook of Data Visualization, 832–52. Springer Science &amp; Business Media. ÚZIS. 2024. “About us - ÚZIS ČR.” https://www.uzis.cz/index-en.php?pg=about-us. World Health Organization. 2024a. “ICD-10 Version:2019.” https://icd.who.int/browse10/2019/en. ———. 2024b. “International Classification of Diseases (ICD).” https://www.who.int/standards/classifications/classification-of-diseases. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
